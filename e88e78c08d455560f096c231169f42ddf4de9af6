{
  "comments": [
    {
      "key": {
        "uuid": "7003d80f_5875400b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 15075
      },
      "writtenOn": "2020-07-14T14:00:52Z",
      "side": 1,
      "message": "Debargha,\nThis patch fixes an issue in the calculation of total_time_encoded inside av1_update_level_info. Earlier, total_time_encoded was updated as the time elapsed from the first frame, however every other stat like total_compressed_size is reset after each key frame. This causes the average bit-rate (calculated as (total_compressed_size * 8) / total_time_encoded) to drop after each key frame and not accurately represent the current average bit-rate. This patch corrects this by resetting total_time_encoded after each key frame.\n\nAs the level monitoring tests depend upon the calculation of the average bit-rate, TestLevelMonitoringHighBitrate starts failing for two pass after this correction as the monitoring unit now calculates the correct bit-rate, which comes out to be 4000 as configured, while the expectation was 1000(for level 0 or 2.0). To correct this, we have changed the level expectation from 0 to 4(which requires a bit-rate of less than 6000).\n\nAfter this fix, both single pass and two pass test cases are passing, hence we have enabled single pass for this test as well.\n\nPlease review.",
      "revId": "e88e78c08d455560f096c231169f42ddf4de9af6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}