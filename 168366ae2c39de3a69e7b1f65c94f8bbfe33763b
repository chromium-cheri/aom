{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ffd8735e_2dbff56b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 25857
      },
      "writtenOn": "2023-10-24T15:23:27Z",
      "side": 1,
      "message": "In the parent version, the `rt_pc_root` pointer in `ThreadData` structure is used to preallocate `PC_TREE` node for realtime encoding to reduce the cost of memory allocation. In other encoding modes, `PC_TREE` node is allocated using local pointers as required. Due to local allocations, they will show up as leaks in case of an early termination.\n\nTo resolve this issue, this CL renames the existing pointer `rt_pc_root` in `ThreadData` structure to `pc_root` and uses the same to allocate the `PC_TREE` node for all encoding modes. Also, `av1_free_pc_tree_recursive()` is invoked during `encoder_destroy()` in order to prevent potential memory leaks in the event of an early termination.\n\nThis change is bit-exact and has been verified using bitstream-match tests for a combination of various configuration values for --threads, --tile-rows, --tile-columns, --cpu-used, --end-usage, --row-mt, --fp-mt, etc. Validated all unit-tests with sanitizers (address and thread) and valgrind.",
      "revId": "168366ae2c39de3a69e7b1f65c94f8bbfe33763b",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}