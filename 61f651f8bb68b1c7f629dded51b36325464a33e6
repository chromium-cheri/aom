{
  "comments": [
    {
      "key": {
        "uuid": "3fd77a8b_88c869d9",
        "filename": "av1/decoder/decodemv.c",
        "patchSetId": 5
      },
      "lineNbr": 49,
      "author": {
        "id": 6815
      },
      "writtenOn": "2017-09-19T15:29:36Z",
      "side": 1,
      "message": "If EXT_PARTITION is enabled, then BLOCK_LARGEST\u003d128x128.\nBut if the bitstream is using superblock size 64x64, then sb_type will never be equal to 128x128 and as a consequence the strength will always be present, even if the 64x64 is a skip.\n\nIs that intended?",
      "range": {
        "startLine": 49,
        "startChar": 8,
        "endLine": 49,
        "endChar": 38
      },
      "revId": "61f651f8bb68b1c7f629dded51b36325464a33e6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "83d4d170_cef0d06a",
        "filename": "av1/decoder/decodemv.c",
        "patchSetId": 5
      },
      "lineNbr": 49,
      "author": {
        "id": 6585
      },
      "writtenOn": "2017-09-19T22:34:47Z",
      "side": 1,
      "message": "Another possible issue is that, if EXT_PARTITION is enabled and partition size is 64x128, it is supposed to send two strengths for this partition (every 64x64), but this change will only send one.",
      "parentUuid": "3fd77a8b_88c869d9",
      "range": {
        "startLine": 49,
        "startChar": 8,
        "endLine": 49,
        "endChar": 38
      },
      "revId": "61f651f8bb68b1c7f629dded51b36325464a33e6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6c759a28_0bcebd67",
        "filename": "av1/decoder/decodemv.c",
        "patchSetId": 5
      },
      "lineNbr": 49,
      "author": {
        "id": 5111
      },
      "writtenOn": "2017-09-19T23:31:53Z",
      "side": 1,
      "message": "I\u0027m not sure how 128x128 should be handled, and I didn\u0027t intend this patch to resolve that.  Anyway, I see three options:\n\n1) Trivially extension, so that 128x128 becomes the filter block size when the superblock is 128x128.  I think this might be dangerous, as it\u0027s not been tested.  For CLPF which had 128x128, 64x64 and 32x32 selectable filter block size, 64x64 was the most useful one.\n2) Make CDEF behave exactly as if the superblock size is 64x64.  This means that if the 128x128 superblock has partitioning, the decoder can\u0027t know whether the 64x64 blocks inside are skip until the superblock is fully decoded (as the skips are determined bottom-up, I think).  I think that will undo this patch.\n3) Keep 64x64 as the filter block size and change the skip condition so that only if a 128x128 superblock is skip and not partitioned, then there is no CDEF signalling.  This might have a compression impact.  It\u0027s not been tested.  And in this case four strengths can be signalled at once just after the skip flag.",
      "parentUuid": "83d4d170_cef0d06a",
      "range": {
        "startLine": 49,
        "startChar": 8,
        "endLine": 49,
        "endChar": 38
      },
      "revId": "61f651f8bb68b1c7f629dded51b36325464a33e6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9eee5229_3a7df45e",
        "filename": "av1/decoder/decodemv.c",
        "patchSetId": 5
      },
      "lineNbr": 49,
      "author": {
        "id": 6815
      },
      "writtenOn": "2017-09-20T07:10:32Z",
      "side": 1,
      "message": "Perhaps a variant of (2):\n\nKeep behaviour as before, hence the filter block is always 64x64.\n\nStill signal per 64x64 when possible. Up to 4 signals per superblocks.\nThe signalling happens in the top-left partition of the 64x64 (not collected at the end of the superblock as it is today). The signalling only happens if the 64x64 is partitioned OR if it is not skip.\nExamples:\n* 128x128 : signal if not skip\n* 128x64+128x64 : for each partition, signal if not skip\n* 4*64x64 : for each partition, signal if not skip\n* 16*32x32 : for each 32x32 that is top-left in an aligned 64x64, signal the strength (no skip check)\n\nThe key thing is that we want the signalling to happen _before_ the mode_info and residual associated with the filter_block, AND that it only depends on a single skip_flag. Also, I think keeping 64x64 filter_block is good. IIRC, some companies asked for keeping CDEF and LR 64x64 based even in the case of 128x128 superblocks.\n\nDoes this make sense?",
      "parentUuid": "6c759a28_0bcebd67",
      "range": {
        "startLine": 49,
        "startChar": 8,
        "endLine": 49,
        "endChar": 38
      },
      "revId": "61f651f8bb68b1c7f629dded51b36325464a33e6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    }
  ]
}