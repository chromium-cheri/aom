{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "682f9ce1_e6c7bcd4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 31592
      },
      "writtenOn": "2023-03-20T16:14:54Z",
      "side": 1,
      "message": "We have made changes as suggested in https://aomedia-review.googlesource.com/c/aom/+/168566\n- The pointer `dst_buf` is set to NULL when `is_key_frame` is true. \n- Made the function `av1_var_offs()` as static and renamed as `var_offs()`.",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a771ffc_9cb70854",
        "filename": "av1/encoder/encodeframe.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-03-20T17:14:51Z",
      "side": 1,
      "message": "Nit: I suggest adding back the `av1_` prefix, to suggest it returns `AV1_VAR_OFFS` or a similar array. I think it is okay for a static function to use the `av1_` prefix.",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "380bba7c_37507473",
        "filename": "av1/encoder/encodeframe.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-03-20T17:31:17Z",
      "side": 1,
      "message": "do we have documents somewhere on how functions should be named? I have been always thinking it\u0027s a general rule that static functions shouldn\u0027t use av1_ prefix, and I\u0027ve applied that rule when I review CLs.",
      "parentUuid": "0a771ffc_9cb70854",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83a8b319_14a7cfdb",
        "filename": "av1/encoder/encodeframe.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-03-20T19:15:09Z",
      "side": 1,
      "message": "Let\u0027s add `get_` to the function name. `var_offs` looks like a variable name.\n\nNote: An important purpose of the `av1_` prefix is to avoid name conflicts with functions outside libaom. Static functions can still have name conflicts. Here is a contrived example.\n\nIn av1/encoder/nonrd_pickmode.c, if I change the name of the static function `combined_motion_search` to `bsearch`. I get a compilation error:\n\n```\naom/av1/encoder/nonrd_pickmode.c: In function ‘search_new_mv’:\naom/av1/encoder/nonrd_pickmode.c:383:46: warning: passing argument 5 of ‘bsearch’ makes pointer from integer without a cast [-Wint-conversion]\n  383 |   } else if (!bsearch(cpi, x, bsize, mi_row, mi_col,\n      |                                              ^~~~~~\n      |                                              |\n      |                                              int\n\n```\n\nThis is because `bsearch` is a Standard C Library function declared in \u003cstdlib.h\u003e. If I change the name to, say, `av1_bsearch`, then the compilation succeeds.\n\n`var_offs` is unlikely to conflict with the name of a standard library function, so we just need to make its name more meaningful (by adding `get_`).",
      "parentUuid": "380bba7c_37507473",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8697626b_529316c6",
        "filename": "av1/encoder/encodeframe.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 31592
      },
      "writtenOn": "2023-03-21T14:15:39Z",
      "side": 1,
      "message": "Thanks for providing guidance! We have added the prefix of `get_` to the function name.",
      "parentUuid": "83a8b319_14a7cfdb",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a989d165_b89bd230",
        "filename": "av1/encoder/var_based_part.c",
        "patchSetId": 1
      },
      "lineNbr": 1154,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-03-20T17:14:51Z",
      "side": 1,
      "message": "I suggest asserting this condition at the beginning of this function, and add a comment to say that this function ignores `dist_buf` when `is_key_frame` is true, so `dst_buf` should be null in that case.",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4c05b6b2_5b14362b",
        "filename": "av1/encoder/var_based_part.c",
        "patchSetId": 1
      },
      "lineNbr": 1154,
      "author": {
        "id": 31592
      },
      "writtenOn": "2023-03-21T14:15:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a989d165_b89bd230",
      "revId": "7d74679727c5ff7d07d95d485f24520fd83c85aa",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}