{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "32492112_7c06eb47",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2022-04-05T15:49:26Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nWe noticed that TPL module is not making use of chroma plane when use_y_only_rate_distortion speed feature is enabled. The speed feature is currently enabled in speed 5, 6 of good preset. Hence, we submitted this patch to avoid the TPL frame memory allocation conditionally based on the speed feature setting.\n\nIn order to avoid the memory allocation for chroma plane, the functions in aom_scale/generic/yv12config.c are modified to handle this scenario appropriately. Also, av1_setup_tpl_buffers() function call is delayed until the speed feature update.\n\nThis CL is verified to be bit-exact with no impact on encode-time.\n\nMemory is measured using the command\nvalgrind --tool\u003dmassif ./aomenc ...\n\nPlease check the memory reduction results for this patch.\nFor Good preset, speed \u003d 5\n\n             Avg Memory reduction\nResolution     Single thread   \n640x360          6.20%\n854x480          6.72%\n832x480          6.71%\n1280x720         7.49%\n1920x1080        7.98%\nAverage          7.02%\n\nThe memory saving is similar for speed 6 as well.\nPlease review the patch.\n\nThank you.",
      "revId": "44d7f27f183118211d9d7de6bbc61732dc6036df",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}