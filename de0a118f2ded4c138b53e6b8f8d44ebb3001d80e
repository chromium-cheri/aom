{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "178f7f26_849d7d77",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 13265
      },
      "writtenOn": "2021-08-30T10:07:09Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nThis patch adds a speed feature limit_txfm_eval_per_mode to cap the number of inter mode candidates per prediction mode that go through transform search in tx_search_best_inter_candidates() beyond the first 4 or 3 transform searches. Up to 2 candidates for NEARESTMV mode and 1 candidate for other modes are allowed beyond the first 4 or 3 transform searches.\n\nThis is enabled for speed 3 and above, though the speed and quality impact on speed \u003e\u003d 4 are minimal.\n\nPlease find the detailed borg results below.\n\n         |            | Instruction Count |        BD-Rate Loss(%)       |\ncpu-used | Resolution |    Reduction(%)   | avg.psnr  ovr.psnr   ssim    |\n-------- | ---------- | ----------------- | --------  --------  -------- |\n   3     |  LOW RES   |       1.050       |  0.0221    0.0224    0.0244  |\n   3     |  MID RES   |       0.905       |  0.0661    0.0405   -0.0119  |\n   3     |   HD RES   |       1.579       | -0.0207   -0.0304   -0.0544  |\n   3     |  Average   |       1.149       |  0.0219    0.0116   -0.0102  |\n         |            |                   |                              |\n   4     |  LOW RES   |       0.202       | -0.0043   -0.0017    0.0167  |\n   4     |  MID RES   |       0.208       |  0.0336    0.0321    0.1173  |\n   4     |   HD RES   |       0.351       | -0.0091   -0.0030    0.0356  |\n   4     |  Average   |       0.241       |  0.0053    0.0078    0.0519  |\n         |            |                   |                              |\n   5     |  LOW RES   |       0.118       |  0.0393    0.0347   -0.0059  |\n   5     |  MID RES   |       0.303       |  0.0546    0.0874    0.0808  |\n   5     |   HD RES   |       0.235       |  0.0425    0.0381    0.1222  |\n   5     |  Average   |       0.193       |  0.0447    0.0512    0.0585  |\n         |            |                   |                              |\n   6     |  LOW RES   |       0.072       |  0.0115    0.0066    0.0144  |\n   6     |  MID RES   |       0.294       | -0.0174   -0.0136   -0.0074  |\n   6     |   HD RES   |       0.223       |  0.0582    0.0467    0.0268  |\n   6     |  Average   |       0.165       |  0.0173    0.0129    0.0118  |\n\n\nIn the commit message, BD rate impact column:\n[+] sign is for BD-Rate drop\n[-] sign is for BD-Rate improvement\nThe instruction count reduction specified has been measured using command:\n$ perf stat -e instructions:u ./aomenc â€¦\n\nPlease review the patch.\n\nThanks,\nNithya",
      "revId": "de0a118f2ded4c138b53e6b8f8d44ebb3001d80e",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a60cf7a5_57283308",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2021-08-30T18:38:11Z",
      "side": 1,
      "message": "Overall tradeoff is good. Good to achieve further pruning in the inter mode search.",
      "revId": "de0a118f2ded4c138b53e6b8f8d44ebb3001d80e",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9dd5b267_0e99ba0f",
        "filename": "av1/encoder/rdopt.c",
        "patchSetId": 1
      },
      "lineNbr": 4833,
      "author": {
        "id": 5185
      },
      "writtenOn": "2021-08-30T18:38:11Z",
      "side": 1,
      "message": "Looks like the inter mode candidates were ranked based on estimated rd cost? Did that help with this speed feature\u0027s performance?",
      "range": {
        "startLine": 4829,
        "startChar": 0,
        "endLine": 4833,
        "endChar": 17
      },
      "revId": "de0a118f2ded4c138b53e6b8f8d44ebb3001d80e",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a2ec2fb_e34139d0",
        "filename": "av1/encoder/rdopt.c",
        "patchSetId": 1
      },
      "lineNbr": 4833,
      "author": {
        "id": 13265
      },
      "writtenOn": "2021-08-31T03:14:35Z",
      "side": 1,
      "message": "Yes, Yunqing, the ranking based on the estimated rd cost did help in making sure that the top candidates that would be evaluated were better in estimated rd cost. This would ensure that the pruning of the candidates in the bottom of the list would not cause much quality loss.",
      "parentUuid": "9dd5b267_0e99ba0f",
      "range": {
        "startLine": 4829,
        "startChar": 0,
        "endLine": 4833,
        "endChar": 17
      },
      "revId": "de0a118f2ded4c138b53e6b8f8d44ebb3001d80e",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75239a2c_daa18475",
        "filename": "av1/encoder/rdopt.c",
        "patchSetId": 1
      },
      "lineNbr": 4833,
      "author": {
        "id": 5185
      },
      "writtenOn": "2021-08-31T15:42:32Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9a2ec2fb_e34139d0",
      "range": {
        "startLine": 4829,
        "startChar": 0,
        "endLine": 4833,
        "endChar": 17
      },
      "revId": "de0a118f2ded4c138b53e6b8f8d44ebb3001d80e",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}