{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "49577358_c478fa34",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 33002
      },
      "writtenOn": "2023-12-21T14:00:21Z",
      "side": 1,
      "message": "In `row_mt_ mem_alloc()`, if the allocations related to `this_tile-\u003erow_mt_sync` or `this_tile-\u003erow_ctx` fails in one of the tiles, `allocated_tile_cols` and `allocated_tile_rows` in `enc_row_mt` will not be set due to the longjmp and hence the allocated buffers will show up as leak. In order to fix this, this CL initializes the variables  `allocated_tile_cols` and `allocated_tile_rows` before the allocation.\n\nThis CL also sets the above buffers to NULL in `av1_alloc_tile_data()` to fix the SEGV error when `av1_row_mt_mem_dealloc()` is invoked in case of an allocation failure. Similar implementation of setting row mt related buffers to NULL is done for the decoder(please refer `decoder_alloc_tile_data()`).\n\nThis change is bit-exact and has been verified using bitstream-match tests for a combination of various configuration values for --threads, --tile-rows, --tile-columns, --cpu-used, --end-usage, --row-mt, --fp-mt, etc. Validated all unit-tests with sanitizers (address and thread) and valgrind.",
      "revId": "1ca03427c6dca15d8e8952d9130442193750b808",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}