{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "2becfc5b_38bb3f3b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 22433
      },
      "writtenOn": "2022-02-18T17:22:46Z",
      "side": 1,
      "message": "Hi Paul Wilkins, Wan-Teh, Frank,\n\nDuring our study of non-RD encode, we observed that the value of rdmult was turning out to be zero in non-RD path after the following CL: https://aomedia-review.googlesource.com/c/aom/+/153361 (say CL-A). This was happening because the initialization of intra_sb_rdmult_modifier was not being done when encode_nonrd_sb() was invoked. This patch fixes the same by making the initialization of intra_sb_rdmult_modifier common for both encode_rd_sb() and encode_nonrd_sb() by moving the initialization to encode_sb_row().\n\nAs per our understanding, the CL-A was intended for improving visual quality for RD-based encoding, but we were seeing huge quality loss as well as encode time increase for allintra encoding at higher speed presets where non-RD path is invoked. The current CL is on top of CL-A and this CL recovers the quality and speed drop which was unintentional for non-RD encode. The speed drop in CL-A majorly seems to be due to the generation of more coefficients which caused an increase in bitstream preparation time.\n\nWe validated the current patch for ‘ALLINTRA’ video encode and still-image encode. Bit match is verified for RD based encode w.r.t. CL-A and for non-RD encode, bit match is verified w.r.t parent version of CL-A.\n\nThe current CL recovers the AVIF encode time increase and BD-Rate loss caused by CL-A, i.e., reduces encode time by 6.682%/4.276% and improves BD-Rate(PSNR) by 22.8231%/14.9568%, for speed\u003d8,9, when tested for a typical image dataset.\n\nFor libaom AV1 video encode, bit match is verified (w.r.t parent commit) for encoding modes \u0027GOOD\u0027 and \u0027RT\u0027 for few videos with different video encoding configurations.\n\nPlease let us know your opinion on the fix and merge the same in case of no issues.\n\nThanks \u0026 Regards,\nAniket.\n",
      "revId": "4db2339b779dc01958cfa77c92e7936b090dc3e1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}