{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b1dcdba3_258caf4d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 33002
      },
      "writtenOn": "2023-10-16T13:44:25Z",
      "side": 1,
      "message": "In the parent version, `sb_org_stats` is allocated locally in `encode_rd_sb()` and freed at the end of the function. In case of an early termination between this allocation and free calls, this will show up as leaks. In order to fix this issue, the allocation of `SB_FIRST_PASS_STATS` buffer is done using a pointer introduced in the MACROBLOCK structure so that it can be freed in `encoder_destroy()`.\n\nThis change is bit-exact and has been verified using bitstream-match tests for a combination of various configuration values for --threads, --tile-rows, --tile-columns, --cpu-used, --end-usage, --row-mt, --fp-mt, etc. Validated all unit-tests with sanitizers (address and thread) and valgrind.",
      "revId": "fcd197d4cedf7ecf7cb8bb477e795187d0fdb740",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}