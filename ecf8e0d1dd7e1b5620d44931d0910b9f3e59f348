{
  "comments": [
    {
      "key": {
        "uuid": "29c8a02d_6e3c3e8a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2020-08-12T15:25:35Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nWe have modified the patch with suggested changes.\nPlease review.\n\nThanks",
      "revId": "ecf8e0d1dd7e1b5620d44931d0910b9f3e59f348",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "346b3968_ed3f7014",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2020-08-12T21:30:34Z",
      "side": 1,
      "message": "Thanks for this further modification. I tried it and saw some issues. Could you take a look?\n\n1. Without \"--psnr\", still print PSNR as below. Also, Overall PSNR seems wrong.\n$ ./aomenc --test-decode\u003dwarn --cpu-used\u003d0 --threads\u003d0 --profile\u003d0 --lag-in-frames\u003d35 --min-q\u003d0 --max-q\u003d63 --auto-alt-ref\u003d1 --passes\u003d2 --kf-max-dist\u003d160 --kf-min-dist\u003d0 --drop-frame\u003d0 --static-thresh\u003d0 --minsection-pct\u003d0 --maxsection-pct\u003d2000 --arnr-maxframes\u003d7 --arnr-strength\u003d5 --sharpness\u003d0 --undershoot-pct\u003d100 --overshoot-pct\u003d100 --frame-parallel\u003d0 --tile-columns\u003d0 --limit\u003d65 --cpu-used\u003d2 --lag-in-frames\u003d35 --input-bit-depth\u003d8 --bit-depth\u003d10 --end-usage\u003dvbr --target-bitrate\u003d200 ./pamphlet_cif.y4m -o output.webm\n...\nStream 0 PSNR (Overall/Avg/Y/U/V) 35.835 47.909 47.304 48.668 50.443   75223 bps   14701 ms\n\n2. Using \"--psnr\" or \"--psnr\u003d1\" gives the same result(10 bit psnr) that is right. But, when \"--psnr\u003d2\", it should print 8-bit psnr. Somehow it still prints out 10-bit psnr.\n$ ./aomenc --test-decode\u003dwarn --cpu-used\u003d0 --threads\u003d0 --profile\u003d0 --lag-in-frames\u003d35 --min-q\u003d0 --max-q\u003d63 --auto-alt-ref\u003d1 --passes\u003d2 --kf-max-dist\u003d160 --kf-min-dist\u003d0 --drop-frame\u003d0 --static-thresh\u003d0 --minsection-pct\u003d0 --maxsection-pct\u003d2000 --arnr-maxframes\u003d7 --arnr-strength\u003d5 --sharpness\u003d0 --undershoot-pct\u003d100 --overshoot-pct\u003d100 --frame-parallel\u003d0 --tile-columns\u003d0 --limit\u003d65 --cpu-used\u003d2 --lag-in-frames\u003d35 --input-bit-depth\u003d8 --bit-depth\u003d10 --end-usage\u003dvbr --target-bitrate\u003d200 ./pamphlet_cif.y4m -o output.webm --psnr\u003d2\n...\nStream 0 PSNR (Overall/Avg/Y/U/V) 47.902 47.909 47.304 48.668 50.443   14683 ms\n\n3. Within the extra HBD stats added, first 2 stats\u0027 name doesn\u0027t sound right? See below.\nAVPsnrH(AVGPsnrH?) GLPsnrH(GLBPsnrH) AVPsnrPH GLPsnrPH AVPsnrYH APsnrCbH APsnrCrH WstPsnrH\n",
      "revId": "ecf8e0d1dd7e1b5620d44931d0910b9f3e59f348",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e9694b89_d9ac078a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2020-08-13T15:06:54Z",
      "side": 1,
      "message": "1. We have made the fix to not display PSNR status line when “--psnr” option is not given. We also verified the PSNR values displayed match with the parent commit for --psnr\u003d1 option in both 8-bit and 10-bit encodes. \n\n2. Below are the details regarding configuration arguments. \n\n\"--psnr\u003d2\", will display psnr value based on stream bit-depth (when input bit-depth \u003c stream bit-depth). \n\"--psnr\" or \"--psnr\u003d1\", both will display psnr value based on input bit-depth. \n\"--psnr\u003d0\" or without \"--psnr\" option, will not display any status line.\n\nFor “--bit-depth\u003d10 --psnr\u003d2” it will display 10bit PSNR and “--bit-depth\u003d10 --psnr\u003d1” it will display 8bit PSNR. There was an error in 8bit psnr calculation for the above configuration earlier which is fixed now. The error in the psnr values was due to pkt.data.psnr and pkt.data.psnr_hbd pointing to same memory location, since it was declared inside union. Now we have introduced the set of members for HBD inside aom_psnr_pkt structure to avoid this issue. We also verified that the dumps for 12bit are correct for the various --psnr options.\n\n3. We used “AVPsnrH” and “GLPsnrH” instead of “AVGPsnrH” and “GLBPsnrH” so as to maintain uniformity in length of these headings with the existing ones in internal config file for alignment with the PSNR values. We have now modified the headings as per your suggestion to “AVGPsnrH” and “GLBPsnrH”.",
      "parentUuid": "346b3968_ed3f7014",
      "revId": "ecf8e0d1dd7e1b5620d44931d0910b9f3e59f348",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "60cde485_0129455d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2020-08-14T00:13:30Z",
      "side": 1,
      "message": "Thanks for fixing issues.\n\nThe options you mentioned above are not consistent with what is in the code:\n(0: Disable PSNR status line display 1: PSNR calculated using codec \"\n    \"bit-depth (default) 2: PSNR calculated using input bit-depth)\")\nActually, what in the code is what we want to have(i.e show HBD psnr in this case).\n\nAlso, extra 8 headings were added in the stats, but actually 9 stats values were added. Could you check that? Will share my script by email.\n\nThis change is not trivial. We want to test it thoroughly.\n\nIf you want to separate this CL into smaller ones for easy handling, I am fine with it.",
      "parentUuid": "e9694b89_d9ac078a",
      "revId": "ecf8e0d1dd7e1b5620d44931d0910b9f3e59f348",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6e99fb6_a8e76f07",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2020-08-14T13:09:20Z",
      "side": 1,
      "message": "Thank you for the comments.\n\nWe have corrected the description in ARG_DEF to be consistent with the rest of the code.\n\nWe have validated using the script you have shared that the patchset-20 prints 8 extra values for the 8 new headings. There is an alignment issue with the use of space instead of tab, which makes the heading and values in the stt unaligned. We have added additional space in the headings to reduce the alignment mismatch in patchset-21.",
      "parentUuid": "60cde485_0129455d",
      "revId": "ecf8e0d1dd7e1b5620d44931d0910b9f3e59f348",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}