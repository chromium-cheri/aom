{
  "comments": [
    {
      "key": {
        "uuid": "0a5f83dc_209566d8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2020-09-30T16:30:16Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nWe have found a bug in the CL while attempting the suggested refactoring. The top_colors array \nwhich is used internally in palette_rd_y() was using the down-converted pixel value in hbd path. \nSo the latest patch (patchset 5) takes care of using the down converted pixel value only for \ncalculating threshold to gate palette and using the actual hbd pixel values in palette_rd_y().\n\nPlease find the detailed borg results on 10-bit encode below.\n\n cpu-used  Resolution  Instruction count              BD-Rate Impact(%) \n                         Reduction(%)      avg.psnr  ovr.psnr  ssim      avg.psnr  \n                                             8-bit    8-bit     8-bit      10-bit    \n   0        Lowres        -0.006            -0.0010  -0.0011  -0.0018     -0.0010\n   0        Midres        -0.025             0.0288   0.0379   0.0494      0.0288\n   0        Hdres         -0.011             0        0        0           0    \n   0        Overall       -0.012             0.0080   0.0107   0.0137      0.0080\n    \n   1        Lowres         0.004            -0.0019  -0.0012  -0.0122     -0.0019\n   1        Midres        -0.017            -0.0138  -0.015   -0.0201     -0.0148\n   1        Hdres         -0.017             0        0        0           0\n   1        Overall       -0.006            -0.0048  -0.0049  -0.0108     -0.0051\n\n   2        Lowres        -0.013             0.0019   0.0024   0.0083      0.0019\n   2        Midres        -0.080             0.0535   0.0589   0.0910      0.0515\n   2        Hdres         -0.038            -0.0030  -0.0030  -0.0007     -0.0030\n   2        Overall       -0.036             0.0155   0.0172   0.0298      0.0149\n\n   3        Lowres        -0.030             0.0007   0.0006  -0.0041      0.0009\n   3        Midres        -0.012            -0.0408  -0.0460  -0.0563     -0.0410\n   3        Hdres         -0.026            -0.0012  -0.0017  -0.0015     -0.0019\n   3        Overall       -0.024            -0.0120  -0.0137  -0.0186     -0.0122\n\n   4        Lowres        -0.038            -0.0005  -0.0005   0.0034     -0.0006\n   4        Midres         0.052             0.0081   0.0093  -0.0054      0.0078\n   4        Hdres         -3.385            -0.4923  -0.4845  -0.4366     -0.4931\n   4        Overall       -0.866            -0.1479  -0.1452  -0.1333     -0.1483\n\n   5        Lowres        -0.076             0.0026   0.0024  -0.0042      0.0026\n   5        Midres        -0.145             0.0064   0.0053   0.0145      0.0062\n   5        Hdres         -6.526            -1.0938  -1.0801  -0.9629     -1.0961\n   5        Overall       -1.731            -0.3306  -0.3268  -0.2910     -0.3313\n\n   6        Lowres        -0.088             0.0021   0.0019   0.0009      0.0017\n   6        Midres        -0.114            -0.0191  -0.0214  -0.0139     -0.0187\n   6        Hdres         -0.132            -0.0366  -0.0341  -0.0416     -0.0355\n   6        Overall       -0.105            -0.0159  -0.0159  -0.0164     -0.0156\n\nBorg results on 10-bit encode for screen content clips with tune\u003dscreen option enabled are below. The clips\ntested are Dota, Minecraft, chinaspeed, screendata, Wikipedia.\n\n cpu-used Resolution  Instruction count              BD-Rate Impact(%) \n                        Reduction(%)      avg.psnr  ovr.psnr   ssim        avg.psnr  \n                                           8-bit     8-bit     8-bit        10-bit   \n    1       Overall      -27.208          -0.4221   -0.3753   -0.0972      -0.4315\n    2       Overall       -6.214          -0.6854   -0.5745   -0.6954      -0.6832\n    3       Overall       -4.237          -0.6617   -0.4367   -0.4254      -0.6325\n    4       Overall       -8.129          -1.6543   -1.6871   -1.6416      -1.6351\n    5       Overall      -15.956          -2.9062   -2.7219   -2.7473      -2.8908\n    6       Overall       -6.055          -1.5251   -1.3327   -0.7971      -1.5213\n\nIn the commit message, BD rate impact column:\n[+] sign is for BD-Rate drop\n[-] sign is for BD-Rate improvement\nThe instruction count reduction specified has been measured using command:\n$ perf stat -e instructions:u ./aomenc â€¦\n\nWe observed a BD rate drop of 1.1% for snow_mnt_480p in speed 2 and a BD rate gain of 1.0% in speed 3 with patchset 5. We plan to analyse the reason for the erratic behaviour further and shall keep you updated on the progress.\n\nPlease review the patch.\n\nThanks\n",
      "revId": "0dfd78cc5c9096a24d48bf7040b0c0a751262956",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "58ea0dd8_0ac9a230",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2020-09-30T18:20:37Z",
      "side": 1,
      "message": "Thanks! Nice quality improvement for screen contents. While looking at snow_mnt_480p\u0027s quality, can you also look at speed 1 performance - 27% speed loss seems quite high?",
      "parentUuid": "0a5f83dc_209566d8",
      "revId": "0dfd78cc5c9096a24d48bf7040b0c0a751262956",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "518d746b_673677e6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 15298
      },
      "writtenOn": "2020-10-01T06:52:03Z",
      "side": 1,
      "message": "Sure, we will also analyse the speed drop and update you the progress.",
      "parentUuid": "58ea0dd8_0ac9a230",
      "revId": "0dfd78cc5c9096a24d48bf7040b0c0a751262956",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}