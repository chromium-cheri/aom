{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "d424f5bc_9d270e7f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-23T18:18:49Z",
      "side": 1,
      "message": "Cheng: I think it\u0027s important to figure out why the single-threaded version and multithreaded version produce different results. I suggest some simplifications to the pred_buffer allocation code.",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8cda279e_3bc63265",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 267,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-23T18:18:49Z",
      "side": 1,
      "message": "I think we should delete these three lines (265-267) now, because `pred_buffer` is no longer used as the reference.",
      "range": {
        "startLine": 265,
        "startChar": 0,
        "endLine": 267,
        "endChar": 79
      },
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d59558e_05bd413c",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 267,
      "author": {
        "id": 6585
      },
      "writtenOn": "2023-02-24T02:07:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8cda279e_3bc63265",
      "range": {
        "startLine": 265,
        "startChar": 0,
        "endLine": 267,
        "endChar": 79
      },
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c825d8e6_178d9291",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 270,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-23T18:18:49Z",
      "side": 1,
      "message": "Delete `offset`.",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a93ffd14_d77b48c6",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 270,
      "author": {
        "id": 6585
      },
      "writtenOn": "2023-02-24T02:07:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c825d8e6_178d9291",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b3b630c_6494cb32",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 276,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-23T18:18:49Z",
      "side": 1,
      "message": "Nit/optional: I suggest the following (which requires removing the `const`):\n\n```\n  size_t buf_size \u003d buf_width * buf_height * sizeof(*pred_buffer);\n  if (is_high_bitdepth) {\n    buf_size *\u003d 2;\n  }\n```\n\nor\n\n```\n  const size_t buf_size \u003d (buf_width * buf_height * sizeof(*pred_buffer)) \u003c\u003c is_high_bitdepth;\n```",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0f1d1489_a4b68cf4",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 276,
      "author": {
        "id": 6585
      },
      "writtenOn": "2023-02-24T02:07:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0b3b630c_6494cb32",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1cd76b77_e938682d",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 286,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-23T18:18:49Z",
      "side": 1,
      "message": "I believe this if-else statement can be simplified to:\n\n```\n  if (is_high_bitdepth) {\n    uint16_t *pred_buffer_16 \u003d (uint16_t *)pred_buffer;\n    dst_buffer \u003d CONVERT_TO_BYTEPTR(pred_buffer_16);\n  } else {\n    dst_buffer \u003d pred_buffer;\n  }\n```\n\nNote: In the high bitdepth case, the use of `tmp_pred` is not necessary. We can convert `pred_buffer` to `pred_buffer_16` with a type cast directly.",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "24e7d2a2_d1562c21",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 286,
      "author": {
        "id": 6585
      },
      "writtenOn": "2023-02-24T02:07:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1cd76b77_e938682d",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "99dff45e_e433bf2b",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 592,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-24T02:11:31Z",
      "side": 1,
      "message": "Cheng: I compared the code in `av1_calc_mb_wiener_var_mt()` and `calc_mb_wiener_var()`. I only noticed two minor differences:\n\n1. `cpi-\u003eframe_info.mi_rows` vs. `cpi-\u003ecommon.mi_params.mi_rows`: I believe these two should be equal.\n\n2. `av1_calc_mb_wiener_var_mt()` ignores its `sum_rec_distortion` and `sum_est_rate` output parameters: this only matters when `cpi-\u003eoxcf.intra_mode_cfg.auto_intra_tools_off` is true.\n\nSo I still don\u0027t see why `av1_calc_mb_wiener_var_mt()` and `calc_mb_wiener_var()` calculate different results.",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9c8f8fc6_a0932de7",
        "filename": "av1/encoder/allintra_vis.c",
        "patchSetId": 3
      },
      "lineNbr": 592,
      "author": {
        "id": 6585
      },
      "writtenOn": "2023-02-24T02:19:44Z",
      "side": 1,
      "message": "I don\u0027t have a clear answer yet. I suspect something related to internal states are different, leading to subtle difference.",
      "parentUuid": "99dff45e_e433bf2b",
      "revId": "f20a534eb14e7c50cae8ae5ff8d21de2bae4a406",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}