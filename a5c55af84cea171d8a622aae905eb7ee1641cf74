{
  "comments": [
    {
      "key": {
        "uuid": "3db0bdb4_075a7d85",
        "filename": "av1/encoder/ratectrl.c",
        "patchSetId": 2
      },
      "lineNbr": 1717,
      "author": {
        "id": 6585
      },
      "writtenOn": "2019-11-11T19:19:45Z",
      "side": 1,
      "message": "When vbr_bits_off_target \u003c\u003d 0, AOMMIN() here will always return max_delta (\u003c\u003d 0), because the second argument is nonzero.\n\nSubsequently, this_frame_target will always add a nonzero value (-max_delta).\n\nI think that\u0027s not intentional? when vbr_bits_off_target \u003c\u003d 0, this_frame_target shall add a negative value.",
      "range": {
        "startLine": 1717,
        "startChar": 16,
        "endLine": 1717,
        "endChar": 22
      },
      "revId": "a5c55af84cea171d8a622aae905eb7ee1641cf74",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "784a2214_20533c88",
        "filename": "av1/encoder/ratectrl.c",
        "patchSetId": 2
      },
      "lineNbr": 1717,
      "author": {
        "id": 5610
      },
      "writtenOn": "2019-11-12T10:16:46Z",
      "side": 1,
      "message": "I am not sure quite what you are saying here.\n\nI think max_delta will always be \u003e\u003d 0 as if vbr_bits_off_target is -ve then max_target is -vbr_bits_off_target / frame_window. I think it would be clearer to re-write the definition of max_delta as abs(vbr_bits_off_target / frame_window).\n\nWhen vbr_bits_off_target \u003c 0 we want to add a -ve value (or subtract a positive value) from this_frame_target as we have overshoot. Hence we want to reduce the bit target for this frame.\n\nWhen vbr_bits_off_target \u003d 0 then the code as is will add -max_delta but if vbr_bits_off_target is 0 then max_delta will also be 0.",
      "parentUuid": "3db0bdb4_075a7d85",
      "range": {
        "startLine": 1717,
        "startChar": 16,
        "endLine": 1717,
        "endChar": 22
      },
      "revId": "a5c55af84cea171d8a622aae905eb7ee1641cf74",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    }
  ]
}