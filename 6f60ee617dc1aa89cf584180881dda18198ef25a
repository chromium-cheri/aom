{
  "comments": [
    {
      "key": {
        "uuid": "43127d83_c3d4b2c3",
        "filename": "av1/common/x86/cfl_ssse3.c",
        "patchSetId": 7
      },
      "lineNbr": 109,
      "author": {
        "id": 8439
      },
      "writtenOn": "2018-04-03T19:59:51Z",
      "side": 1,
      "message": "One minor point here...\n\nHistory shows us that the switch statement is faster to execute than the if-else-if ladder. This is b/c the compiler can optimize the switch statement cases as peers vs as a hierarchy in the if-else-if ladder. This is important to a compiler\u0027s ability to optimize code. In the if-else-if ladder, the compiler must execute each if statement in the coded order. Whereas, each case within a switch statement does not rely on earlier cases, and the compiler is able to re-order them to acheive the fastest execution, mostly due to branch removal. That said, in this example b/c the cases are limited in number, the performance impact may be insignificant (I\u0027d need to test it to know for sure). \n\nHowever, for this code the switch statement is cleaner and more readable in my opinion.",
      "range": {
        "startLine": 100,
        "startChar": 4,
        "endLine": 109,
        "endChar": 5
      },
      "revId": "6f60ee617dc1aa89cf584180881dda18198ef25a",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8830ac6f_7868e7d7",
        "filename": "av1/common/x86/cfl_ssse3.c",
        "patchSetId": 7
      },
      "lineNbr": 109,
      "author": {
        "id": 7105
      },
      "writtenOn": "2018-04-03T20:54:52Z",
      "side": 1,
      "message": "Thanks for the explanation. I\u0027m happy to switch (no pun intended) this to a switch case. I would just like to point out that the width is constant propagated.\n\nFor example, with clang 5, the 4x4 version is compiled to:\n\nsubsample_lbd_422_4x4_ssse3:\n\t.cfi_startproc\n\tmovsxd\trax, esi\n\tmovd\txmm0, dword ptr [rdi]\n\tmovdqa\txmm1, xmmword ptr [rip + .LCPI15_0]\n\tpmaddubsw\txmm0, xmm1\n\tmovd\tdword ptr [rdx], xmm0\n\tmovd\txmm0, dword ptr [rdi + rax]\n\tadd\trdi, rax\n\tpmaddubsw\txmm0, xmm1\n\tmovd\tdword ptr [rdx + 64], xmm0\n\tmovd\txmm0, dword ptr [rax + rdi]\n\tadd\trdi, rax\n\tpmaddubsw\txmm0, xmm1\n\tmovd\tdword ptr [rdx + 128], xmm0\n\tmovd\txmm0, dword ptr [rax + rdi]\n\tpmaddubsw\txmm0, xmm1\n\tmovd\tdword ptr [rdx + 192], xmm0\n\tret",
      "parentUuid": "43127d83_c3d4b2c3",
      "range": {
        "startLine": 100,
        "startChar": 4,
        "endLine": 109,
        "endChar": 5
      },
      "revId": "6f60ee617dc1aa89cf584180881dda18198ef25a",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    }
  ]
}