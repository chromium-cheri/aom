{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1052a141_815949e1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-10-25T22:46:14Z",
      "side": 1,
      "message": "Most of the changes in this CL are to use the new local variable intra_mode_cfg. There are only two actual changes, which change\n\n    av1_use_angle_delta(bsize)\n\nto:\n\n    av1_use_angle_delta(bsize) \u0026\u0026 intra_mode_cfg-\u003eenable_angle_delta\n\nI believe these two actual changes are correct. My question is whether this CL has made all such changes. For example, the estimate_intra_mode() function in av1/encoder/nonrd_pickmode.c has the following code:\n\n    int mode_cost \u003d 0;\n    if (av1_is_directional_mode(this_mode) \u0026\u0026 av1_use_angle_delta(bsize)) {\n      mode_cost +\u003d\n          ...\n    }\n    \nShould we also add \u0026\u0026 intra_mode_cfg-\u003eenable_angle_delta to the conditional expression?",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4acd081c_c4129d57",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-10-25T23:04:38Z",
      "side": 1,
      "message": "There are two more examples in av1/encoder/intra_mode_search_utils.h. Search for \"av1_use_angle_delta\" in av1/encoder/intra_mode_search_utils.h, you will see code like the following:\n\n  if (av1_is_directional_mode(mbmi-\u003emode)) {\n    if (av1_use_angle_delta(bsize)) {\n      total_rate +\u003d\n          ...\n    }\n  }\n\nShould we add \u0026\u0026 intra_mode_cfg-\u003eenable_angle_delta to the conditional expression of the inner if statement?",
      "parentUuid": "1052a141_815949e1",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5bf43f86_7bbe6b91",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 14993
      },
      "writtenOn": "2021-10-26T15:11:07Z",
      "side": 1,
      "message": "This CL tries to reinstate the conditions based on ‘enable_angle_delta’ parameter which was introduced in the following CL: \nhttps://aomedia-review.googlesource.com/c/aom/+/77061\n\nWhen enable_angle_delta \u003d 0, the evaluation of delta angles for directional intra modes are prevented at the mode evaluation loop level. Hence, there is no need to keep additional checks based on ‘enable_angle_delta’ parameter as it is already ensured that the evaluation of delta angles are skipped by the time control comes to other places where av1_use_angle_delta() is used (for e.g. in intra_mode_info_cost_y() etc.)\n\nIn case of estimate_intra_mode(), which is present in nonrd_pickmode.c, only four intra modes are evaluated, namely DC_PRED, V_PRED, H_PRED and SMOOTH_PRED. Also, mi-\u003eangle_delta is not being set to a non-zero value anywhere during the mode evaluation. Hence, adding an additional check based on enable_angle_delta will not have any effect as non-zero angle deltas are not being evaluated currently. However, we see that similar checks seem to be absent for other tools (enable_smooth_intra, enable_directional_intra etc.) in estimate_intra_mode() and av1_nonrd_pick_intra_mode().",
      "parentUuid": "4acd081c_c4129d57",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7c65a1ab_0093ad78",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 14993
      },
      "writtenOn": "2021-10-25T15:04:06Z",
      "side": 1,
      "message": "Hi Wan-Teh,\n\nDuring our code study, we observed that delta angles of directional intra modes were getting evaluated in av1_rd_pick_intra_sby_mode() and av1_handle_intra_y_mode() even when enable_angle_delta was set to 0.\n\nThe enable_angle_delta check in these functions got removed (or not taken care of entirely) in the following CL: \nIntra mode search improvement | https://aomedia-review.googlesource.com/c/aom/+/137725\n\nThis patch disallows the evaluation of delta angles in these functions when enable_angle_delta is configured to 0.\n\nWe have done some sanity verification to ensure that this CL produces bit-exact output for good, rt and allintra encoding modes with the default settings.\n\nPlease review.\n\nRegards,\nJayasanker.",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3a5a2c79_07cffcce",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-10-25T22:46:14Z",
      "side": 1,
      "message": "Cheng, Fyodor: Please review. Thanks.\n\nJayasanker: I have a question for you in the commit message.",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf700381_8d65e197",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 14993
      },
      "writtenOn": "2021-10-26T15:11:07Z",
      "side": 1,
      "message": "Please review.",
      "revId": "202bf6e8605e7065e62a5223b1d16f8374e10aba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}