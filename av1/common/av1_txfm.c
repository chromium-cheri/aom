/*
 * Copyright (c) 2017, Alliance for Open Media. All rights reserved
 *
 * This source code is subject to the terms of the BSD 2 Clause License and
 * the Alliance for Open Media Patent License 1.0. If the BSD 2 Clause License
 * was not distributed with this source code in the LICENSE file, you can
 * obtain it at www.aomedia.org/license/software. If the Alliance for Open
 * Media Patent License 1.0 was not distributed with this source code in the
 * PATENTS file, you can obtain it at www.aomedia.org/license/patent.
 */

#include "config/aom_dsp_rtcd.h"
#include "config/av1_rtcd.h"

#include "av1/common/av1_txfm.h"

// av1_cospi_arr[i][j] = (int)round(cos(PI*j/128) * (1<<(cos_bit_min+i)));
const int32_t av1_cospi_arr_data[7][64] = {
  { 1024, 1024, 1023, 1021, 1019, 1016, 1013, 1009, 1004, 999, 993, 987, 980,
    972,  964,  955,  946,  936,  926,  915,  903,  891,  878, 865, 851, 837,
    822,  807,  792,  775,  759,  742,  724,  706,  688,  669, 650, 630, 610,
    590,  569,  548,  526,  505,  483,  460,  438,  415,  392, 369, 345, 321,
    297,  273,  249,  224,  200,  175,  150,  125,  100,  75,  50,  25 },
  { 2048, 2047, 2046, 2042, 2038, 2033, 2026, 2018, 2009, 1998, 1987,
    1974, 1960, 1945, 1928, 1911, 1892, 1872, 1851, 1829, 1806, 1782,
    1757, 1730, 1703, 1674, 1645, 1615, 1583, 1551, 1517, 1483, 1448,
    1412, 1375, 1338, 1299, 1260, 1220, 1179, 1138, 1096, 1053, 1009,
    965,  921,  876,  830,  784,  737,  690,  642,  595,  546,  498,
    449,  400,  350,  301,  251,  201,  151,  100,  50 },
  { 4096, 4095, 4091, 4085, 4076, 4065, 4052, 4036, 4017, 3996, 3973,
    3948, 3920, 3889, 3857, 3822, 3784, 3745, 3703, 3659, 3612, 3564,
    3513, 3461, 3406, 3349, 3290, 3229, 3166, 3102, 3035, 2967, 2896,
    2824, 2751, 2675, 2598, 2520, 2440, 2359, 2276, 2191, 2106, 2019,
    1931, 1842, 1751, 1660, 1567, 1474, 1380, 1285, 1189, 1092, 995,
    897,  799,  700,  601,  501,  401,  301,  201,  101 },
  { 8192, 8190, 8182, 8170, 8153, 8130, 8103, 8071, 8035, 7993, 7946,
    7895, 7839, 7779, 7713, 7643, 7568, 7489, 7405, 7317, 7225, 7128,
    7027, 6921, 6811, 6698, 6580, 6458, 6333, 6203, 6070, 5933, 5793,
    5649, 5501, 5351, 5197, 5040, 4880, 4717, 4551, 4383, 4212, 4038,
    3862, 3683, 3503, 3320, 3135, 2948, 2760, 2570, 2378, 2185, 1990,
    1795, 1598, 1401, 1202, 1003, 803,  603,  402,  201 },
  { 16384, 16379, 16364, 16340, 16305, 16261, 16207, 16143, 16069, 15986, 15893,
    15791, 15679, 15557, 15426, 15286, 15137, 14978, 14811, 14635, 14449, 14256,
    14053, 13842, 13623, 13395, 13160, 12916, 12665, 12406, 12140, 11866, 11585,
    11297, 11003, 10702, 10394, 10080, 9760,  9434,  9102,  8765,  8423,  8076,
    7723,  7366,  7005,  6639,  6270,  5897,  5520,  5139,  4756,  4370,  3981,
    3590,  3196,  2801,  2404,  2006,  1606,  1205,  804,   402 },
  { 32768, 32758, 32729, 32679, 32610, 32522, 32413, 32286, 32138, 31972, 31786,
    31581, 31357, 31114, 30853, 30572, 30274, 29957, 29622, 29269, 28899, 28511,
    28106, 27684, 27246, 26791, 26320, 25833, 25330, 24812, 24279, 23732, 23170,
    22595, 22006, 21403, 20788, 20160, 19520, 18868, 18205, 17531, 16846, 16151,
    15447, 14733, 14010, 13279, 12540, 11793, 11039, 10279, 9512,  8740,  7962,
    7180,  6393,  5602,  4808,  4011,  3212,  2411,  1608,  804 },
  { 65536, 65516, 65457, 65358, 65220, 65043, 64827, 64571, 64277, 63944, 63572,
    63162, 62714, 62228, 61705, 61145, 60547, 59914, 59244, 58538, 57798, 57022,
    56212, 55368, 54491, 53581, 52639, 51665, 50660, 49624, 48559, 47464, 46341,
    45190, 44011, 42806, 41576, 40320, 39040, 37736, 36410, 35062, 33692, 32303,
    30893, 29466, 28020, 26558, 25080, 23586, 22078, 20557, 19024, 17479, 15924,
    14359, 12785, 11204, 9616,  8022,  6424,  4821,  3216,  1608 }
};

#if CONFIG_LGT
// self-loop weight 1.0 (DST7)
const int32_t lgt_intra_16x16[16 * 16] = {
  96,    191,   284,  375,  462,  545,   623,   696,   762,  821,  873,  917,
  953,   980,   998,  1007, 284,  545,   762,   917,   998,  998,  917,  762,
  545,   284,   0,    -284, -545, -762,  -917,  -998,  462,  821,  998,  953,
  696,   284,   -191, -623, -917, -1007, -873,  -545,  -96,  375,  762,  980,
  623,   980,   917,  462,  -191, -762,  -1007, -821,  -284, 375,  873,  998,
  696,   96,    -545, -953, 762,  998,   545,   -284,  -917, -917, -284, 545,
  998,   762,   0,    -762, -998, -545,  284,   917,   873,  873,  0,    -873,
  -873,  0,     873,  873,  0,    -873,  -873,  0,     873,  873,  0,    -873,
  953,   623,   -545, -980, -96,  917,   696,   -462,  -998, -191, 873,  762,
  -375,  -1007, -284, 821,  998,  284,   -917,  -545,  762,  762,  -545, -917,
  284,   998,   0,    -998, -284, 917,   545,   -762,  1007, -96,  -998, 191,
  980,   -284,  -953, 375,  917,  -462,  -873,  545,   821,  -623, -762, 696,
  980,   -462,  -762, 821,  375,  -998,  96,    953,   -545, -696, 873,  284,
  -1007, 191,   917,  -623, 917,  -762,  -284,  998,   -545, -545, 998,  -284,
  -762,  917,   0,    -917, 762,  284,   -998,  545,   821,  -953, 284,  623,
  -1007, 545,   375,  -980, 762,  96,    -873,  917,   -191, -696, 998,  -462,
  696,   -1007, 762,  -96,  -623, 998,   -821,  191,   545,  -980, 873,  -284,
  -462,  953,   -917, 375,  545,  -917,  998,   -762,  284,  284,  -762, 998,
  -917,  545,   0,    -545, 917,  -998,  762,   -284,  375,  -696, 917,  -1007,
  953,   -762,  462,  -96,  -284, 623,   -873,  998,   -980, 821,  -545, 191,
  191,   -375,  545,  -696, 821,  -917,  980,   -1007, 998,  -953, 873,  -762,
  623,   -462,  284,  -96,
};

// self-loop weight 1.5
const int32_t lgt_intra_8x8[8 * 8] = {
  130,  319,  497,  657,  792,  899,  972,  1009, 382,   832,  1012, 865,  438,
  -130, -657, -971, 614,  1010, 545,  -386, -987, -746,  131,  897,  808,  770,
  -459, -978, 15,   985,  432,  -790, 945,  190,  -1002, 110,  969,  -400, -850,
  654,  993,  -497, -497, 993,  -497, -497, 993,  -497,  895,  -941, 564,  66,
  -666, 968,  -835, 327,  566,  -786, 920,  -951, 878,   -707, 458,  -159,
};

// self-loop weight 2.0 (DST4)
const int32_t lgt_intra_4x4[4 * 4] = {
  200, 569, 851,   1004, 569,  1004, 200, -851,
  851, 200, -1004, 569,  1004, -851, 569, -200,
};

// self-loop weight 1.0 (DST7)
const int32_t lgt_inter_16x16[16 * 16] = {
  /* 1.1 */
  /*
  88,   184,   278,   370,   458,   542,   621,   694,   762,   822,   874,   919,   955,   982,  1001,  1010,
  261,   527,   750,   911,   998,  1003,   926,   773,   557,   295,     9,  -278,  -542,  -762,  -919, -1001,
  427,   801,   995,   965,   719,   311,  -167,  -607,  -911, -1010,  -883,  -556,  -105,   370,   761,   982,
  581,   969,   938,   502,  -151,  -739, -1007,  -840,  -310,   354,   865,  1003,   706,   105,  -542,  -955,
  718,  1007,   595,  -232,  -897,  -937,  -324,   515,   995,   782,    24,  -751, -1002,  -555,   278,   918,
  833,   909,    68,  -841,  -902,   -53,   850,   895,    38,  -858,  -888,   -23,   866,   881,     8,  -873,
  922,   686,  -481,  -995,  -160,   892,   734,  -420, -1004,  -227,   859,   779,  -357, -1009,  -292,   821,
  981,   366,  -882,  -607,   716,   802,  -497,  -938,   241,  1004,    33,  -995,  -304,   912,   553,  -761,
  1007,    -7, -1007,   115,   994,  -222,  -970,   326,   935,  -426,  -890,   522,   834,  -611,  -768,   694,
  997,  -382,  -813,   775,   438,  -987,    38,   968,  -506,  -723,   856,   310, -1006,   176,   921,  -621,
  950,  -704,  -358,  1005,  -488,  -594,   988,  -236,  -789,   900,    32,  -927,   748,   298,  -998,   542,
  864,  -924,   215,   672, -1001,   497,   420,  -988,   734,   130,  -886,   906,  -172,  -704,   995,  -459,
  743, -1006,   719,   -39,  -662,  1002,  -794,   153,   572,  -984,   859,  -264,  -475,   954,  -912,   372,
  589,  -935,   987,  -730,   244,   319,  -782,   999,  -903,   524,    20,  -557,   920,  -994,   757,  -282,
  409,  -719,   928, -1005,   940,  -742,   440,   -75,  -301,   634,  -877,   997,  -975,   815,  -540,   189,
  209,  -391,   558,  -705,   827,  -920,   980, -1004,   993,  -947,   867,  -756,   618,  -458,   281,   -95,
  */
  /* 0.75 */
  124,   216,   305,   393,   477,   556,   631,   700,   764,   820,   870,   912,   946,   971,   989,   997,
  362,   605,   802,   935,   996,   979,   886,   724,   505,   247,   -30,  -305,  -556,  -764,  -912,  -989,
  574,   882,  1000,   904,   614,   193,  -270,  -675,  -935,  -995,  -841,  -507,   -65,   392,   765,   973,
  748,  1000,   837,   328,  -316,  -830, -1000,  -756,  -199,   440,   898,   983,   662,    67,  -556,  -949,
  878,   948,   383,  -439,  -966,  -846,  -159,   635,  1003,   699,   -74,  -797,  -986,  -514,   302,   916,
  962,   746,  -197,  -948,  -775,   154,   932,   802,  -110,  -915,  -828,    66,   896,   852,   -22,  -875,
  1003,   434,  -706,  -916,    81,   972,   583,  -574,  -974,   -92,   912,   714,  -424, -1004,  -262,   825,
  1005,    65,  -984,  -375,   866,   648,  -662,  -856,   393,   980,   -85, -1006,  -232,   933,   526,  -768,
  972,  -307,  -952,   370,   928,  -431,  -899,   490,   867,  -547,  -831,   601,   792,  -653,  -749,   703,
  910,  -632,  -629,   912,   223, -1011,   227,   911,  -632,  -630,   912,   224, -1011,   225,   911,  -631,
  823,  -871,  -119,   968,  -663,  -432,  1012,  -386,  -700,   952,   -69,  -896,   793,   255,  -999,   553,
  716,  -997,   423,   514, -1010,   640,   279,  -959,   817,    26,  -846,   941,  -229,  -679,  1005,  -469,
  592,  -998,   840,  -208,  -542,   985,  -872,   266,   490,  -970,   902,  -324,  -436,   950,  -928,   381,
  455,  -876,  1013,  -820,   361,   215,  -722,   994,  -943,   585,   -38,  -522,   912, -1006,   773,  -289,
  309,  -649,   895, -1009,   975,  -798,   504,  -136,  -252,   603,  -865,  1001,  -989,   833,  -554,   194,
  156,  -345,   521,  -678,   810,  -912,   980, -1012,  1007,  -964,   885,  -774,   634,  -470,   289,   -98,
 /* 0.7 */
 /*
  131,   222,   311,   398,   480,   559,   633,   702,   764,   820,   869,   910,   944,   969,   986,   995,
  383,   621,   811,   939,   995,   974,   877,   713,   494,   237,   -38,  -311,  -559,  -765,  -911,  -987,
  602,   895,   999,   890,   592,   169,  -290,  -688,  -940,  -992,  -833,  -498,   -57,   397,   765,   972,
  776,  1001,   814,   294,  -347,  -846,  -997,  -739,  -178,   456,   903,   980,   654,    60,  -559,  -948,
  900,   931,   343,  -474,  -975,  -827,  -129,   655,  1003,   684,   -91,  -805,  -983,  -507,   306,   916,
  975,   713,  -241,  -961,  -750,   188,   944,   785,  -135,  -924,  -817,    81,   901,   848,   -27,  -876,
  1007,   392,  -737,  -899,   118,   980,   558,  -596,  -968,   -71,   919,   704,  -434, -1003,  -257,   826,
  1000,    21,  -993,  -339,   884,   623,  -684,  -842,   414,   975,  -101, -1008,  -222,   937,   522,  -769,
  960,  -346,  -939,   402,   915,  -457,  -888,   511,   857,  -562,  -823,   612,   786,  -659,  -746,   704,
  893,  -661,  -603,   926,   195, -1012,   250,   902,  -647,  -617,   918,   214, -1012,   232,   910,  -632,
  804,  -888,   -90,   960,  -682,  -412,  1013,  -403,  -689,   957,   -81,  -892,   799,   250, -1000,   554,
  696, -1002,   446,   494, -1009,   656,   262,  -954,   825,    14,  -841,   945,  -236,  -676,  1006,  -470,
  574,  -995,   852,  -226,  -528,   983,  -880,   279,   481,  -968,   906,  -331,  -432,   950,  -929,   382,
  440,  -869,  1014,  -829,   373,   204,  -715,   993,  -947,   592,   -44,  -518,   911, -1007,   775,  -290,
  298,  -642,   891, -1009,   978,  -803,   510,  -142,  -247,   599,  -864,  1001,  -991,   835,  -556,   195,
  150,  -340,   518,  -676,   809,  -911,   980, -1013,  1008,  -965,   887,  -775,   635,  -471,   290,   -98,
  */
  /* 0.8 */
  /*
  117,   210,   300,   388,   473,   554,   629,   699,   763,   821,   871,   913,   947,   973,   991,  1000,
  343,   591,   792,   931,   997,   984,   894,   733,   515,   256,   -23,  -300,  -554,  -764,  -913,  -991,
  548,   869,  1001,   917,   634,   215,  -251,  -663,  -931,  -998,  -849,  -516,   -72,   388,   764,   975,
  721,   997,   857,   360,  -288,  -815, -1003,  -772,  -219,   425,   892,   987,   670,    74,  -554,  -950,
  855,   962,   420,  -405,  -957,  -863,  -187,   615,  1003,   713,   -57,  -789,  -989,  -521,   298,   916,
  947,   776,  -155,  -934,  -798,   121,   921,   818,   -86,  -906,  -838,    52,   891,   857,   -17,  -874,
  997,   475,  -675,  -932,    44,   962,   607,  -551,  -980,  -113,   904,   724,  -414, -1004,  -266,   824,
  1008,   110,  -974,  -410,   847,   672,  -640,  -869,   371,   984,   -68, -1005,  -243,   930,   530,  -766,
  983,  -267,  -964,   336,   940,  -403,  -911,   468,   878,  -531,  -840,   590,   797,  -647,  -751,   701,
  926,  -602,  -656,   897,   252, -1010,   202,   919,  -616,  -643,   905,   236, -1011,   219,   912,  -629,
  843,  -853,  -150,   975,  -642,  -453,  1010,  -368,  -712,   946,   -56,  -900,   787,   260,  -999,   551,
  736,  -991,   399,   534, -1011,   624,   296,  -963,   807,    38,  -851,   937,  -222,  -682,  1004,  -468,
  611, -1001,   827,  -188,  -557,   988,  -864,   253,   500,  -972,   897,  -317,  -441,   951,  -926,   380,
  471,  -884,  1011,  -810,   348,   227,  -729,   995,  -938,   579,   -31,  -526,   913, -1005,   771,  -288,
  320,  -657,   899, -1009,   971,  -792,   497,  -129,  -257,   606,  -867,  1000,  -988,   831,  -553,   194,
  162,  -350,   525,  -681,   812,  -913,   980, -1011,  1005,  -962,   883,  -772,   632,  -469,   288,   -97,
  */
 /* 0.9 */
 /*
  105,   199,   291,   381,   467,   549,   626,   697,   763,   821,   872,   915,   950,   977,   995,  1004,
  311,   566,   776,   924,   998,   992,   907,   749,   531,   271,   -10,  -291,  -549,  -763,  -916,  -995,
  502,   844,  1000,   937,   668,   252,  -219,  -642,  -924, -1003,  -862,  -532,   -85,   381,   763,   977,
  670,   990,   891,   415,  -236,  -787, -1006,  -799,  -254,   398,   882,   993,   684,    85,  -549,  -951,
  808,   984,   487,  -342,  -937,  -893,  -239,   579,  1001,   739,   -27,  -775,  -994,  -534,   291,   916,
  912,   829,   -75,  -905,  -839,    58,   897,   848,   -41,  -890,  -856,    25,   882,   865,    -8,  -873,
  978,   553,  -610,  -959,   -28,   941,   653,  -506,  -990,  -153,   888,   744,  -394, -1006,  -275,   822,
  1007,   198,  -948,  -479,   806,   718,  -593,  -894,   328,   992,   -34, -1001,  -263,   923,   537,  -764,
  999,  -183,  -984,   265,   962,  -345,  -933,   422,   898,  -497,  -856,   568,   809,  -635,  -756,   698,
  956,  -536,  -709,   862,   312, -1006,   151,   937,  -582,  -669,   890,   259, -1009,   205,   914,  -626,
  881,  -812,  -215,   988,  -597,  -498,  1005,  -328,  -736,   932,   -29,  -908,   775,   272,  -998,   548,
  778,  -975,   345,   577, -1010,   587,   333,  -971,   786,    65,  -862,   928,  -207,  -689,  1001,  -465,
  652, -1005,   798,  -145,  -588,   994,  -844,   224,   521,  -976,   886,  -302,  -451,   952,  -922,   377,
  506,  -900,  1006,  -788,   318,   254,  -745,   996,  -929,   563,   -17,  -535,   915, -1002,   767,  -286,
  345,  -675,   908, -1008,   963,  -778,   481,  -114,  -270,   614,  -870,   999,  -984,   827,  -549,   192,
  175,  -361,   535,  -688,   816,  -915,   980, -1010,  1002,  -958,   879,  -767,   628,  -466,   286,   -97,
  */
  /*
  96,    191,   284,  375,  462,  545,   623,   696,   762,  821,  873,  917,
  953,   980,   998,  1007, 284,  545,   762,   917,   998,  998,  917,  762,
  545,   284,   0,    -284, -545, -762,  -917,  -998,  462,  821,  998,  953,
  696,   284,   -191, -623, -917, -1007, -873,  -545,  -96,  375,  762,  980,
  623,   980,   917,  462,  -191, -762,  -1007, -821,  -284, 375,  873,  998,
  696,   96,    -545, -953, 762,  998,   545,   -284,  -917, -917, -284, 545,
  998,   762,   0,    -762, -998, -545,  284,   917,   873,  873,  0,    -873,
  -873,  0,     873,  873,  0,    -873,  -873,  0,     873,  873,  0,    -873,
  953,   623,   -545, -980, -96,  917,   696,   -462,  -998, -191, 873,  762,
  -375,  -1007, -284, 821,  998,  284,   -917,  -545,  762,  762,  -545, -917,
  284,   998,   0,    -998, -284, 917,   545,   -762,  1007, -96,  -998, 191,
  980,   -284,  -953, 375,  917,  -462,  -873,  545,   821,  -623, -762, 696,
  980,   -462,  -762, 821,  375,  -998,  96,    953,   -545, -696, 873,  284,
  -1007, 191,   917,  -623, 917,  -762,  -284,  998,   -545, -545, 998,  -284,
  -762,  917,   0,    -917, 762,  284,   -998,  545,   821,  -953, 284,  623,
  -1007, 545,   375,  -980, 762,  96,    -873,  917,   -191, -696, 998,  -462,
  696,   -1007, 762,  -96,  -623, 998,   -821,  191,   545,  -980, 873,  -284,
  -462,  953,   -917, 375,  545,  -917,  998,   -762,  284,  284,  -762, 998,
  -917,  545,   0,    -545, 917,  -998,  762,   -284,  375,  -696, 917,  -1007,
  953,   -762,  462,  -96,  -284, 623,   -873,  998,   -980, 821,  -545, 191,
  191,   -375,  545,  -696, 821,  -917,  980,   -1007, 998,  -953, 873,  -762,
  623,   -462,  284,  -96,
  */
};

// self-loop weight 1.5
const int32_t lgt_inter_8x8[8 * 8] = {
  /* 1.6 */
  /*
  123,   314,   494,   655,   792,   900,   974,  1011,
  362,   822,  1014,   875,   449,  -123,  -655,  -973,
  583,  1014,   571,  -365,  -986,  -757,   124,   898,
  775,   805,  -422,  -990,   -12,   984,   444,  -790,
  920,   258, -1002,    63,   982,  -377,  -861,   653,
  992,  -420,  -562,   996,  -457,  -528,   997,  -493,
  937,  -910,   493,   136,  -706,   974,  -824,   320,
  632,  -820,   925,  -935,   849,  -677,   436,  -151,
  */
  /* 1.4 */
  /*
  138,  325,  501,  659,  792,  897,  969, 1006,
  405,  842, 1010,  855,  426, -138, -659, -968,
  646, 1005,  516, -408, -988, -734,  140,  895,
  841,  731, -498, -965,   44,  986,  419, -789,
  966,  119, -999,  159,  955, -423, -838,  656,
  986, -568, -431,  989, -535, -466,  991, -501,
  850, -963,  626,    3, -630,  964, -847,  334,
  510, -756,  914, -964,  900, -731,  476, -165,
  */
  /* 1.25 */
  152,  336,  508,  662,  793,  895,  965, 1001,
  443,  858, 1004,  836,  405, -152, -662, -964,
  698,  992,  465, -447, -989, -713,  154,  893,
  889,  664, -560, -941,   92,  987,  398, -790,
  987,    7, -989,  234,  932, -460, -820,  660,
  960, -665, -333,  979, -590, -423,  988, -509,
  779, -981,  702,  -78, -584,  959, -864,  344,
  442, -718,  904, -976,  926, -760,  498, -173,
  /*
   130,  319,  497,  657,  792,  899,  972,  1009, 382,   832,  1012, 865,  438,
   -130, -657, -971, 614,  1010, 545,  -386, -987, -746,  131,  897,  808,  770,
   -459, -978, 15,   985,  432,  -790, 945,  190,  -1002, 110,  969,  -400, -850,
   654,  993,  -497, -497, 993,  -497, -497, 993,  -497,  895,  -941, 564,  66,
   -666, 968,  -835, 327,  566,  -786, 920,  -951, 878,   -707, 458,  -159,
   */
};

// self-loop weight 2.0 (DST4)
const int32_t lgt_inter_4x4[4 * 4] = {
  /* 1.75 */
  222,  578,  849,  996,
  628,  979,  163, -847,
  914,   71, -962,  575,
  904, -894,  651, -238,
  /* 2.1 */
  /*
  192,   566,   852,  1007,
  547,  1013,   213,  -853,
  822,   248, -1019,   567,
  1042,  -831,   535,  -185,
  */
  /*
  200, 569, 851,   1004, 569,  1004, 200, -851,
  851, 200, -1004, 569,  1004, -851, 569, -200,
  */
};
#endif  // CONFIG_LGT

#if CONFIG_DST7_16X16
const int32_t dst7_16x16[16][16] = {
  { 12, 24, 36, 47, 57, 69, 78, 87, 94, 103, 109, 115, 118, 123, 125, 126 },
  { 36, 69, 94, 115, 125, 125, 115, 94, 69, 36, 0, -36, -69, -94, -115, -125 },
  { 57, 103, 125, 118, 87, 36, -24, -78, -115, -126, -109, -69, -12, 47, 94,
    123 },
  { 78, 123, 115, 57, -24, -94, -126, -103, -36, 47, 109, 125, 87, 12, -69,
    -118 },
  { 94, 125, 69, -36, -115, -115, -36, 69, 125, 94, 0, -94, -125, -69, 36,
    115 },
  { 109, 109, 0, -109, -109, 0, 109, 109, 0, -109, -109, 0, 109, 109, 0, -109 },
  { 118, 78, -69, -123, -12, 115, 87, -57, -125, -24, 109, 94, -47, -126, -36,
    103 },
  { 125, 36, -115, -69, 94, 94, -69, -115, 36, 125, 0, -125, -36, 115, 69,
    -94 },
  { 126, -12, -125, 24, 123, -36, -118, 47, 115, -57, -109, 69, 103, -78, -94,
    87 },
  { 123, -57, -94, 103, 47, -125, 12, 118, -69, -87, 109, 36, -126, 24, 115,
    -78 },
  { 115, -94, -36, 125, -69, -69, 125, -36, -94, 115, 0, -115, 94, 36, -125,
    69 },
  { 103, -118, 36, 78, -126, 69, 47, -123, 94, 12, -109, 115, -24, -87, 125,
    -57 },
  { 87, -126, 94, -12, -78, 125, -103, 24, 69, -123, 109, -36, -57, 118, -115,
    47 },
  { 69, -115, 125, -94, 36, 36, -94, 125, -115, 69, 0, -69, 115, -125, 94,
    -36 },
  { 47, -87, 115, -126, 118, -94, 57, -12, -36, 78, -109, 125, -123, 103, -69,
    24 },
  { 24, -47, 69, -87, 103, -115, 123, -126, 125, -118, 109, -94, 78, -57, 36,
    -12 },
};
#endif

// av1_sinpi_arr_data[i][j] = (int)round((sqrt(2) * sin(j*Pi/9) * 2 / 3) * (1
// << (cos_bit_min + i))) modified so that elements j=1,2 sum to element j=4.
const int32_t av1_sinpi_arr_data[7][5] = {
  { 0, 330, 621, 836, 951 },        { 0, 660, 1241, 1672, 1901 },
  { 0, 1321, 2482, 3344, 3803 },    { 0, 2642, 4964, 6689, 7606 },
  { 0, 5283, 9929, 13377, 15212 },  { 0, 10566, 19858, 26755, 30424 },
  { 0, 21133, 39716, 53510, 60849 }
};

void av1_round_shift_array_c(int32_t *arr, int size, int bit) {
  int i;
  if (bit == 0) {
    return;
  } else {
    if (bit > 0) {
      for (i = 0; i < size; i++) {
        arr[i] = round_shift(arr[i], bit);
      }
    } else {
      for (i = 0; i < size; i++) {
        arr[i] = (int32_t)clamp64(((int64_t)1 << (-bit)) * arr[i], INT32_MIN,
                                  INT32_MAX);
      }
    }
  }
}

#if CONFIG_MODE_DEP_TX
const TXFM_TYPE av1_txfm_type_ls[5][TX_TYPES_1D] = {
  { TXFM_TYPE_DCT4, TXFM_TYPE_ADST4, TXFM_TYPE_ADST4, TXFM_TYPE_IDENTITY4,
    TXFM_TYPE_MDTX4, TXFM_TYPE_MDTX4 },
  { TXFM_TYPE_DCT8, TXFM_TYPE_ADST8, TXFM_TYPE_ADST8, TXFM_TYPE_IDENTITY8,
    TXFM_TYPE_MDTX8, TXFM_TYPE_MDTX8 },
  { TXFM_TYPE_DCT16, TXFM_TYPE_ADST16, TXFM_TYPE_ADST16, TXFM_TYPE_IDENTITY16,
    TXFM_TYPE_MDTX16, TXFM_TYPE_ADST16 },
  { TXFM_TYPE_DCT32, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID, TXFM_TYPE_IDENTITY32,
    TXFM_TYPE_INVALID, TXFM_TYPE_INVALID },
  { TXFM_TYPE_DCT64, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID,
    TXFM_TYPE_INVALID, TXFM_TYPE_INVALID }
};
#else
const TXFM_TYPE av1_txfm_type_ls[5][TX_TYPES_1D] = {
  { TXFM_TYPE_DCT4, TXFM_TYPE_ADST4, TXFM_TYPE_ADST4, TXFM_TYPE_IDENTITY4 },
  { TXFM_TYPE_DCT8, TXFM_TYPE_ADST8, TXFM_TYPE_ADST8, TXFM_TYPE_IDENTITY8 },
  { TXFM_TYPE_DCT16, TXFM_TYPE_ADST16, TXFM_TYPE_ADST16, TXFM_TYPE_IDENTITY16 },
  { TXFM_TYPE_DCT32, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID,
    TXFM_TYPE_IDENTITY32 },
  { TXFM_TYPE_DCT64, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID, TXFM_TYPE_INVALID }
};
#endif

const int8_t av1_txfm_stage_num_list[TXFM_TYPES] = {
  4,   // TXFM_TYPE_DCT4
  6,   // TXFM_TYPE_DCT8
  8,   // TXFM_TYPE_DCT16
  10,  // TXFM_TYPE_DCT32
  12,  // TXFM_TYPE_DCT64
  7,   // TXFM_TYPE_ADST4
  8,   // TXFM_TYPE_ADST8
  10,  // TXFM_TYPE_ADST16
  1,   // TXFM_TYPE_IDENTITY4
  1,   // TXFM_TYPE_IDENTITY8
  1,   // TXFM_TYPE_IDENTITY16
  1,   // TXFM_TYPE_IDENTITY32
#if CONFIG_MODE_DEP_TX
  1,  // TXFM_TYPE_MDTX4 (not used)
  1,  // TXFM_TYPE_MDTX8 (not used)
  1,  // TXFM_TYPE_MDTX16 (not used)
#endif
};

void av1_range_check_buf(int32_t stage, const int32_t *input,
                         const int32_t *buf, int32_t size, int8_t bit) {
#if CONFIG_COEFFICIENT_RANGE_CHECKING
  const int64_t max_value = (1LL << (bit - 1)) - 1;
  const int64_t min_value = -(1LL << (bit - 1));

  int in_range = 1;

  for (int i = 0; i < size; ++i) {
    if (buf[i] < min_value || buf[i] > max_value) {
      in_range = 0;
    }
  }

  if (!in_range) {
    fprintf(stderr, "Error: coeffs contain out-of-range values\n");
    fprintf(stderr, "size: %d\n", size);
    fprintf(stderr, "stage: %d\n", stage);
    fprintf(stderr, "allowed range: [%" PRId64 ";%" PRId64 "]\n", min_value,
            max_value);

    fprintf(stderr, "coeffs: ");

    fprintf(stderr, "[");
    for (int j = 0; j < size; j++) {
      if (j > 0) fprintf(stderr, ", ");
      fprintf(stderr, "%d", input[j]);
    }
    fprintf(stderr, "]\n");

    fprintf(stderr, "   buf: ");

    fprintf(stderr, "[");
    for (int j = 0; j < size; j++) {
      if (j > 0) fprintf(stderr, ", ");
      fprintf(stderr, "%d", buf[j]);
    }
    fprintf(stderr, "]\n\n");
  }

  assert(in_range);
#else
  (void)stage;
  (void)input;
  (void)buf;
  (void)size;
  (void)bit;
#endif
}
