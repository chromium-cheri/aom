/*
 * Copyright (c) 2016, Alliance for Open Media. All rights reserved
 *
 * This source code is subject to the terms of the BSD 2 Clause License and
 * the Alliance for Open Media Patent License 1.0. If the BSD 2 Clause License
 * was not distributed with this source code in the LICENSE file, you can
 * obtain it at www.aomedia.org/license/software. If the Alliance for Open
 * Media Patent License 1.0 was not distributed with this source code in the
 * PATENTS file, you can obtain it at www.aomedia.org/license/patent.
 */

#include "aom_mem/aom_mem.h"

#include "av1/common/reconinter.h"
#include "av1/common/scan.h"
#include "av1/common/onyxc_int.h"
#include "av1/common/seg_common.h"
#include "av1/common/txb_common.h"

const aom_cdf_prob
    default_kf_y_mode_cdf[KF_MODE_CONTEXTS][KF_MODE_CONTEXTS][CDF_SIZE(
        INTRA_MODES)] = {
      { { AOM_CDF13(15461, 16814, 18967, 19878, 20328, 20763, 21457, 22844,
                    23733, 27449, 28366, 29691) },
        { AOM_CDF13(12670, 18729, 20078, 20883, 21252, 21969, 22369, 23507,
                    24867, 28735, 30211, 31372) },
        { AOM_CDF13(10433, 11096, 22697, 23192, 23429, 23593, 24480, 25950,
                    26459, 29414, 29973, 31563) },
        { AOM_CDF13(14720, 15945, 16900, 19423, 19729, 20124, 20543, 22621,
                    25215, 29782, 31079, 32478) },
        { AOM_CDF13(12692, 13813, 16096, 17035, 19096, 20527, 22863, 26085,
                    26907, 30426, 31195, 32488) } },
      { { AOM_CDF13(10666, 20162, 21368, 21979, 22345, 23289, 23582, 24496,
                    25850, 29179, 30597, 31473) },
        { AOM_CDF13(6460, 24712, 25101, 25431, 25586, 26311, 26403, 26895,
                    28049, 30123, 31438, 31894) },
        { AOM_CDF13(8421, 13650, 21301, 21854, 22153, 22671, 23164, 24361,
                    25357, 28272, 29349, 30597) },
        { AOM_CDF13(9302, 15441, 16095, 17772, 18037, 18751, 18943, 20352,
                    25243, 29506, 31334, 32336) },
        { AOM_CDF13(8543, 15306, 16468, 17169, 18837, 21751, 22925, 25441,
                    26911, 30033, 31254, 32116) } },
      { { AOM_CDF13(13146, 14089, 22055, 22718, 22997, 23249, 24032, 25646,
                    26283, 29726, 30474, 32169) },
        { AOM_CDF13(10652, 14277, 19811, 20532, 20832, 21337, 21793, 23101,
                    24210, 28247, 29624, 31161) },
        { AOM_CDF13(6448, 6739, 26498, 26726, 26825, 26884, 27501, 28724, 28901,
                    30608, 30913, 32105) },
        { AOM_CDF13(11605, 12505, 15817, 18288, 18550, 18886, 19444, 22326,
                    24667, 29352, 30551, 32396) },
        { AOM_CDF13(9902, 10494, 17322, 18105, 19188, 19902, 22229, 26730,
                    27304, 30346, 30931, 32521) } },
      { { AOM_CDF13(13154, 14867, 15898, 18940, 19321, 19842, 20219, 21889,
                    25507, 29871, 31053, 32447) },
        { AOM_CDF13(9010, 14538, 15143, 17788, 18094, 18779, 19003, 20077,
                    25849, 29774, 31301, 32432) },
        { AOM_CDF13(9391, 10570, 15972, 18695, 19017, 19375, 19961, 22427,
                    25454, 29513, 30350, 32137) },
        { AOM_CDF13(8110, 9366, 9776, 17265, 17414, 17582, 17737, 19312, 27126,
                    30583, 31622, 32552) },
        { AOM_CDF13(9542, 10859, 11976, 16086, 17460, 18714, 19833, 23474,
                    26476, 30257, 31174, 32539) } },
      { { AOM_CDF13(13233, 14288, 16541, 17425, 19634, 21512, 23550, 25993,
                    26742, 30388, 31286, 32499) },
        { AOM_CDF13(10688, 14805, 16145, 16987, 18780, 22056, 23271, 25283,
                    26374, 30126, 31470, 32428) },
        { AOM_CDF13(9135, 9607, 18481, 19155, 20183, 20883, 23350, 26807, 27287,
                    30247, 30766, 32349) },
        { AOM_CDF13(11778, 12686, 13935, 16978, 17928, 18919, 19774, 23684,
                    25505, 29860, 31133, 32568) },
        { AOM_CDF13(7984, 8655, 10164, 10854, 15739, 19074, 23283, 29235, 29616,
                    31532, 31912, 32619) } }
    };

static const aom_cdf_prob default_angle_delta_cdf[DIRECTIONAL_MODES][CDF_SIZE(
    2 * MAX_ANGLE_DELTA + 1)] = {
  { AOM_CDF7(2097, 4875, 7361, 23058, 27183, 30246) },
  { AOM_CDF7(2143, 5078, 7971, 24713, 27757, 30667) },
  { AOM_CDF7(3813, 11375, 13955, 20408, 24015, 31413) },
  { AOM_CDF7(4529, 11262, 15209, 17220, 22211, 28257) },
  { AOM_CDF7(1704, 10338, 14031, 19386, 22039, 29299) },
  { AOM_CDF7(2633, 10163, 12606, 18027, 22069, 30626) },
  { AOM_CDF7(1905, 10452, 14873, 19968, 22170, 28588) },
  { AOM_CDF7(3711, 10516, 12551, 18088, 21711, 30806) }
};

static const aom_cdf_prob default_if_y_mode_cdf[BLOCK_SIZE_GROUPS][CDF_SIZE(
    INTRA_MODES)] = { { AOM_CDF13(24975, 25352, 25654, 26033, 26771, 27386,
                                  27801, 28309, 28921, 29694, 30117, 30490) },
                      { AOM_CDF13(20453, 21881, 23149, 23878, 24884, 26167,
                                  27021, 27805, 28959, 29864, 30223, 30609) },
                      { AOM_CDF13(22761, 23722, 24738, 25172, 25575, 26266,
                                  26705, 27243, 27938, 28787, 29203, 29632) },
                      { AOM_CDF13(21237, 22210, 23020, 23199, 23335, 23897,
                                  24154, 24508, 24926, 25972, 26483, 27019) } };

static const aom_cdf_prob
    default_uv_mode_cdf[CFL_ALLOWED_TYPES][INTRA_MODES][CDF_SIZE(
        UV_INTRA_MODES)] = {
      { { AOM_CDF13(24164, 25872, 26878, 27131, 27437, 27923, 28353, 29087,
                    29338, 30594, 31384, 32209) },
        { AOM_CDF13(8062, 27553, 27601, 27659, 27735, 28226, 28289, 28345,
                    28865, 29726, 30028, 32080) },
        { AOM_CDF13(8043, 8094, 29429, 29453, 29498, 29508, 29867, 30340, 30361,
                    31044, 32095, 32292) },
        { AOM_CDF13(14230, 14497, 14658, 26532, 26844, 26916, 27148, 28040,
                    29191, 30591, 31180, 32447) },
        { AOM_CDF13(8880, 8947, 9080, 9102, 25841, 27551, 28350, 28461, 28550,
                    30881, 31458, 32080) },
        { AOM_CDF13(11238, 13029, 13060, 13115, 14265, 29655, 29702, 29835,
                    30070, 31392, 31611, 32659) },
        { AOM_CDF13(14237, 14329, 16309, 16529, 17362, 17408, 28856, 30592,
                    30615, 31958, 32525, 32676) },
        { AOM_CDF13(13085, 13179, 15170, 15774, 15803, 15835, 16216, 29995,
                    30095, 30893, 32219, 32603) },
        { AOM_CDF13(12019, 13598, 13688, 15002, 15182, 15512, 15727, 15887,
                    28810, 30389, 30794, 32608) },
        { AOM_CDF13(18961, 19661, 20279, 20585, 20805, 21098, 21488, 22119,
                    22529, 28535, 30299, 32102) },
        { AOM_CDF13(19188, 19833, 21290, 21516, 21722, 21947, 22302, 23082,
                    23390, 25996, 31660, 32207) },
        { AOM_CDF13(16518, 19310, 19831, 20083, 20324, 20860, 21020, 21398,
                    21889, 24319, 24801, 31917) },
        { AOM_CDF13(4812, 5894, 6531, 6565, 6577, 6607, 6615, 6661, 6722, 6948,
                    7151, 7522) } },
      { { AOM_CDF14(10236, 11130, 12839, 13134, 13817, 14216, 14981, 15790,
                    16154, 20069, 20964, 22377, 23991) },
        { AOM_CDF14(3779, 20668, 20928, 21066, 21266, 21848, 21959, 22201,
                    22786, 24860, 25228, 27828, 29645) },
        { AOM_CDF14(3234, 3351, 21463, 21547, 21646, 21694, 22167, 22859, 22932,
                    24090, 25223, 25593, 26576) },
        { AOM_CDF14(6681, 7085, 7578, 13966, 14332, 14568, 14800, 16472, 18143,
                    21491, 22061, 23150, 23757) },
        { AOM_CDF14(6205, 6510, 6971, 7060, 19753, 20910, 22379, 22740, 22853,
                    25407, 25768, 26369, 26630) },
        { AOM_CDF14(6776, 8212, 8517, 8607, 10555, 21731, 21942, 22266, 22434,
                    25457, 25896, 26981, 27480) },
        { AOM_CDF14(4937, 5063, 7267, 7360, 8780, 8905, 20417, 20918, 21022,
                    23229, 23710, 24307, 24636) },
        { AOM_CDF14(6029, 6168, 7891, 8416, 8625, 8720, 9119, 18873, 19117,
                    22148, 22973, 23592, 24197) },
        { AOM_CDF14(6185, 7585, 7962, 9091, 9393, 9659, 9833, 10472, 19051,
                    22823, 23337, 25018, 26078) },
        { AOM_CDF14(9933, 10611, 11914, 12336, 12689, 13002, 13379, 14313,
                    14883, 20462, 21460, 23105, 24292) },
        { AOM_CDF14(10811, 11833, 12774, 13152, 13510, 13875, 14263, 15189,
                    15853, 20217, 22662, 23704, 25649) },
        { AOM_CDF14(9731, 10325, 12419, 12818, 13118, 13378, 13797, 14810,
                    15309, 19261, 19975, 23160, 24641) },
        { AOM_CDF14(2463, 4225, 6316, 6397, 6451, 6505, 6569, 6722, 6828, 7420,
                    7902, 8331, 29646) } }
    };

static const aom_cdf_prob default_partition_cdf[PARTITION_CONTEXTS][CDF_SIZE(
    EXT_PARTITION_TYPES)] = {
  { AOM_CDF4(17475, 24216, 30016) },
  { AOM_CDF4(13195, 19544, 28547) },
  { AOM_CDF4(11451, 22888, 28580) },
  { AOM_CDF4(9185, 18236, 25969) },
  { AOM_CDF10(16053, 20042, 23498, 25949, 26708, 27766, 28493, 29424, 31414) },
  { AOM_CDF10(8143, 10536, 15788, 21623, 22972, 23878, 25289, 27158, 28739) },
  { AOM_CDF10(4976, 10429, 12028, 18178, 19606, 21459, 22398, 23085, 31747) },
  { AOM_CDF10(2347, 4900, 6813, 19636, 21531, 22964, 24490, 25732, 30442) },
  { AOM_CDF10(19581, 21594, 23634, 27945, 28403, 29118, 29541, 30160, 31385) },
  { AOM_CDF10(8902, 10019, 12703, 25323, 25958, 26421, 27055, 28056, 28942) },
  { AOM_CDF10(6660, 9114, 10039, 25078, 25743, 26730, 27279, 27676, 31983) },
  { AOM_CDF10(1384, 1991, 2499, 29087, 29466, 29794, 30134, 30423, 31900) },
  { AOM_CDF10(21063, 22329, 23822, 29726, 29921, 30324, 30561, 30929, 31669) },
  { AOM_CDF10(7942, 8646, 10776, 27888, 28238, 28477, 28870, 29506, 29967) },
  { AOM_CDF10(6648, 8347, 8975, 28626, 28966, 29569, 29906, 30124, 32235) },
  { AOM_CDF10(1036, 1376, 1658, 31157, 31342, 31507, 31687, 31826, 32312) },
  { AOM_CDF8(28523, 28797, 29075, 32556, 32587, 32641, 32664) },
  { AOM_CDF8(8048, 8446, 9951, 32216, 32360, 32443, 32497) },
  { AOM_CDF8(6726, 7981, 8457, 32220, 32351, 32558, 32653) },
  { AOM_CDF8(984, 1320, 1610, 32436, 32517, 32588, 32663) },
};

static const aom_cdf_prob default_intra_ext_tx_cdf
    [EXT_TX_SETS_INTRA][EXT_TX_SIZES][INTRA_MODES][CDF_SIZE(TX_TYPES)] = {
      {
          {
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
          },
          {
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
          },
          {
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
          },
          {
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
              { 0 },
          },
      },
      {
          {
              { AOM_CDF7(1737, 6112, 7750, 11475, 22145, 27143) },
              { AOM_CDF7(564, 3181, 10404, 11470, 20447, 28592) },
              { AOM_CDF7(671, 3297, 3625, 12780, 21226, 24533) },
              { AOM_CDF7(5292, 10917, 12730, 15745, 22106, 30389) },
              { AOM_CDF7(4442, 6280, 8120, 10567, 23631, 28276) },
              { AOM_CDF7(1441, 3789, 9917, 10974, 19175, 28245) },
              { AOM_CDF7(397, 2821, 3364, 6753, 19870, 25300) },
              { AOM_CDF7(1185, 4500, 4998, 12544, 20908, 23828) },
              { AOM_CDF7(1001, 4626, 9577, 11014, 19471, 29838) },
              { AOM_CDF7(134, 3829, 4684, 7217, 18970, 25636) },
              { AOM_CDF7(340, 4149, 6788, 8795, 18415, 26466) },
              { AOM_CDF7(170, 4344, 5028, 9050, 18824, 24230) },
              { AOM_CDF7(4243, 5703, 12321, 18200, 23337, 27069) },
          },
          {
              { AOM_CDF7(1935, 13842, 14830, 17158, 23372, 27499) },
              { AOM_CDF7(271, 9878, 16537, 16882, 21571, 27902) },
              { AOM_CDF7(525, 9089, 9188, 17045, 21749, 24605) },
              { AOM_CDF7(1138, 12525, 13115, 14474, 18949, 30263) },
              { AOM_CDF7(562, 5779, 6006, 6469, 19293, 25647) },
              { AOM_CDF7(1203, 6644, 9127, 9401, 16951, 25573) },
              { AOM_CDF7(304, 5865, 6038, 7409, 17782, 24122) },
              { AOM_CDF7(1011, 9265, 9407, 12877, 18425, 21780) },
              { AOM_CDF7(693, 9097, 10802, 11719, 17532, 29474) },
              { AOM_CDF7(62, 8181, 8541, 9711, 17845, 24774) },
              { AOM_CDF7(298, 9085, 10358, 11491, 17870, 27089) },
              { AOM_CDF7(98, 8749, 9040, 10911, 17356, 21386) },
              { AOM_CDF7(4431, 6444, 13314, 18377, 23188, 26791) },
          },
          {
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
          },
          {
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
              { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
          },
      },
      {
          {
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
          },
          {
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
          },
          {
              { AOM_CDF5(1425, 12047, 21147, 26856) },
              { AOM_CDF5(76, 7656, 13978, 26945) },
              { AOM_CDF5(349, 6777, 13290, 18212) },
              { AOM_CDF5(405, 11589, 15236, 30956) },
              { AOM_CDF5(7, 3501, 20437, 26334) },
              { AOM_CDF5(32, 4256, 14524, 24139) },
              { AOM_CDF5(18, 3379, 16953, 23605) },
              { AOM_CDF5(139, 7454, 13572, 16932) },
              { AOM_CDF5(69, 8043, 13456, 30109) },
              { AOM_CDF5(21, 5910, 15101, 23860) },
              { AOM_CDF5(207, 6557, 13411, 26590) },
              { AOM_CDF5(46, 6199, 14493, 18953) },
              { AOM_CDF5(2481, 5832, 14955, 21409) },
          },
          {
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
              { AOM_CDF5(6554, 13107, 19661, 26214) },
          },
      },
    };

static const aom_cdf_prob
    default_inter_ext_tx_cdf[EXT_TX_SETS_INTER][EXT_TX_SIZES][CDF_SIZE(
        TX_TYPES)] = {
      {
          { 0 },
          { 0 },
          { 0 },
          { 0 },
      },
      {
          { AOM_CDF16(6248, 8009, 10084, 12729, 15961, 17760, 20178, 22297,
                      23104, 24028, 24739, 25852, 28087, 29133, 30777) },
          { AOM_CDF16(2445, 3945, 6232, 7560, 9701, 10827, 12739, 16945, 19059,
                      21328, 23220, 25247, 27306, 28962, 30818) },
          { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                      20480, 22528, 24576, 26624, 28672, 30720) },
          { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                      20480, 22528, 24576, 26624, 28672, 30720) },
      },
      {
          { AOM_CDF12(2731, 5461, 8192, 10923, 13653, 16384, 19115, 21845,
                      24576, 27307, 30037) },
          { AOM_CDF12(2731, 5461, 8192, 10923, 13653, 16384, 19115, 21845,
                      24576, 27307, 30037) },
          { AOM_CDF12(1016, 3323, 7392, 15469, 18159, 20860, 23175, 25427,
                      27564, 29114, 30874) },
          { AOM_CDF12(2731, 5461, 8192, 10923, 13653, 16384, 19115, 21845,
                      24576, 27307, 30037) },
      },
      {
          { AOM_CDF2(16384) },
          { AOM_CDF2(5099) },
          { AOM_CDF2(1372) },
          { AOM_CDF2(392) },
      },
    };

static const aom_cdf_prob default_cfl_sign_cdf[CDF_SIZE(CFL_JOINT_SIGNS)] = {
  AOM_CDF8(1349, 2069, 13574, 18808, 27037, 28390, 32280)
};

static const aom_cdf_prob
    default_cfl_alpha_cdf[CFL_ALPHA_CONTEXTS][CDF_SIZE(CFL_ALPHABET_SIZE)] = {
      { AOM_CDF16(7029, 18764, 31695, 32527, 32679, 32688, 32692, 32696, 32700,
                  32704, 32708, 32712, 32716, 32720, 32724) },
      { AOM_CDF16(14044, 23806, 27936, 31184, 32281, 32481, 32553, 32615, 32654,
                  32671, 32675, 32679, 32683, 32687, 32691) },
      { AOM_CDF16(11595, 22138, 28230, 31272, 32368, 32550, 32608, 32680, 32684,
                  32688, 32692, 32696, 32700, 32704, 32708) },
      { AOM_CDF16(27495, 31600, 32363, 32609, 32692, 32696, 32700, 32704, 32708,
                  32712, 32716, 32720, 32724, 32728, 32732) },
      { AOM_CDF16(16832, 26229, 29023, 30684, 31357, 31918, 32176, 32330, 32398,
                  32445, 32479, 32512, 32524, 32536, 32559) },
      { AOM_CDF16(14660, 21151, 25650, 27722, 28652, 30259, 30908, 31838, 32088,
                  32456, 32523, 32586, 32634, 32656, 32660) }
    };

static const aom_cdf_prob
    default_switchable_interp_cdf[SWITCHABLE_FILTER_CONTEXTS][CDF_SIZE(
        SWITCHABLE_FILTERS)] = {
      { AOM_CDF3(32321, 32744) }, { AOM_CDF3(5197, 32728) },
      { AOM_CDF3(363, 1815) },    { AOM_CDF3(30395, 32675) },
      { AOM_CDF3(32008, 32253) }, { AOM_CDF3(3474, 32081) },
      { AOM_CDF3(565, 831) },     { AOM_CDF3(21795, 25285) },
      { AOM_CDF3(32275, 32740) }, { AOM_CDF3(4597, 32729) },
      { AOM_CDF3(243, 1568) },    { AOM_CDF3(29977, 32681) },
      { AOM_CDF3(31791, 32141) }, { AOM_CDF3(3762, 32050) },
      { AOM_CDF3(459, 634) },     { AOM_CDF3(16682, 19485) }
    };

static const aom_cdf_prob default_newmv_cdf[NEWMV_MODE_CONTEXTS][CDF_SIZE(2)] =
    { { AOM_CDF2(21936) }, { AOM_CDF2(18249) }, { AOM_CDF2(15530) },
      { AOM_CDF2(7407) },  { AOM_CDF2(11950) }, { AOM_CDF2(4204) } };

static const aom_cdf_prob default_zeromv_cdf[GLOBALMV_MODE_CONTEXTS][CDF_SIZE(
    2)] = { { AOM_CDF2(958) }, { AOM_CDF2(892) } };

static const aom_cdf_prob default_refmv_cdf[REFMV_MODE_CONTEXTS][CDF_SIZE(2)] =
    { { AOM_CDF2(26152) }, { AOM_CDF2(24886) }, { AOM_CDF2(20085) },
      { AOM_CDF2(30251) }, { AOM_CDF2(27217) }, { AOM_CDF2(25601) } };

static const aom_cdf_prob default_drl_cdf[DRL_MODE_CONTEXTS][CDF_SIZE(2)] = {
  { AOM_CDF2(11684) }, { AOM_CDF2(24832) }, { AOM_CDF2(18343) }
};

static const aom_cdf_prob
    default_inter_compound_mode_cdf[INTER_MODE_CONTEXTS][CDF_SIZE(
        INTER_COMPOUND_MODES)] = {
      { AOM_CDF8(9184, 15169, 17088, 18944, 20466, 21994, 27007) },
      { AOM_CDF8(11443, 19733, 21354, 22886, 24197, 25273, 28113) },
      { AOM_CDF8(12693, 20625, 21995, 23270, 24756, 25744, 27580) },
      { AOM_CDF8(13013, 16877, 20106, 23585, 24443, 25060, 25720) },
      { AOM_CDF8(20491, 24847, 26259, 27890, 28275, 28537, 30850) },
      { AOM_CDF8(10316, 16501, 19098, 21752, 23109, 24033, 24830) },
      { AOM_CDF8(19446, 25282, 26540, 27900, 28494, 28896, 30403) },
      { AOM_CDF8(14717, 23931, 25009, 26200, 27471, 28253, 29088) }
    };

static const aom_cdf_prob default_interintra_cdf[BLOCK_SIZE_GROUPS][CDF_SIZE(
    2)] = { { AOM_CDF2(16384) },
            { AOM_CDF2(27607) },
            { AOM_CDF2(29105) },
            { AOM_CDF2(30255) } };

static const aom_cdf_prob
    default_interintra_mode_cdf[BLOCK_SIZE_GROUPS][CDF_SIZE(INTERINTRA_MODES)] =
        { { AOM_CDF4(8192, 16384, 24576) },
          { AOM_CDF4(1761, 13478, 28128) },
          { AOM_CDF4(2435, 12286, 27968) },
          { AOM_CDF4(2625, 11696, 28503) } };

static const aom_cdf_prob
    default_wedge_interintra_cdf[BLOCK_SIZES_ALL][CDF_SIZE(2)] = {
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(18913) }, { AOM_CDF2(23352) }, { AOM_CDF2(23791) },
      { AOM_CDF2(24876) }, { AOM_CDF2(28287) }, { AOM_CDF2(27321) },
      { AOM_CDF2(25772) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }
    };

static const aom_cdf_prob
    default_compound_type_cdf[BLOCK_SIZES_ALL][CDF_SIZE(COMPOUND_TYPES - 1)] = {
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(25417) }, { AOM_CDF2(15692) }, { AOM_CDF2(13385) },
      { AOM_CDF2(12225) }, { AOM_CDF2(11603) }, { AOM_CDF2(9812) },
      { AOM_CDF2(8010) },  { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
      { AOM_CDF2(14303) }, { AOM_CDF2(9897) },  { AOM_CDF2(16384) },
      { AOM_CDF2(16384) }
    };

static const aom_cdf_prob default_wedge_idx_cdf[BLOCK_SIZES_ALL][CDF_SIZE(16)] =
    { { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(1828, 4041, 6459, 8251, 10370, 11936, 15438, 18186, 20138,
                  21733, 23282, 24576, 26861, 28896, 30977) },
      { AOM_CDF16(696, 3264, 6203, 6969, 7336, 7478, 7795, 14381, 16049, 17027,
                  17980, 18879, 22519, 25960, 29660) },
      { AOM_CDF16(2553, 3823, 4990, 7531, 8172, 8461, 9108, 14794, 18026, 21075,
                  24101, 26838, 29057, 30342, 31602) },
      { AOM_CDF16(1495, 3627, 5853, 7232, 9360, 11472, 14685, 17633, 19324,
                  20866, 22920, 24360, 26572, 28524, 30885) },
      { AOM_CDF16(1174, 3469, 6321, 7449, 8102, 8322, 8811, 13173, 14882, 16050,
                  17528, 18755, 22001, 25581, 29451) },
      { AOM_CDF16(2501, 3992, 5597, 7754, 8576, 8899, 9663, 13793, 16914, 20167,
                  23323, 25904, 27846, 29460, 31358) },
      { AOM_CDF16(1570, 3636, 5830, 7422, 9625, 12444, 15841, 19097, 20525,
                  21747, 24030, 25346, 27055, 28800, 31179) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(132, 897, 1934, 2006, 2038, 2065, 2077, 22579, 23109, 23703,
                  24343, 24925, 26739, 28551, 30790) },
      { AOM_CDF16(945, 1096, 1227, 2079, 2112, 2133, 2150, 22718, 24430, 26300,
                  28125, 29862, 30588, 31295, 32095) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) },
      { AOM_CDF16(2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432,
                  20480, 22528, 24576, 26624, 28672, 30720) } };

static const aom_cdf_prob default_motion_mode_cdf[BLOCK_SIZES_ALL][CDF_SIZE(
    MOTION_MODES)] = { { AOM_CDF3(10923, 21845) }, { AOM_CDF3(10923, 21845) },
                       { AOM_CDF3(10923, 21845) }, { AOM_CDF3(6319, 26687) },
                       { AOM_CDF3(3729, 25726) },  { AOM_CDF3(3273, 26322) },
                       { AOM_CDF3(24819, 29110) }, { AOM_CDF3(1691, 26191) },
                       { AOM_CDF3(5521, 26418) },  { AOM_CDF3(28546, 30416) },
                       { AOM_CDF3(17104, 29170) }, { AOM_CDF3(22463, 28100) },
                       { AOM_CDF3(30199, 31481) }, { AOM_CDF3(25656, 29513) },
                       { AOM_CDF3(30777, 31378) }, { AOM_CDF3(32554, 32578) },
                       { AOM_CDF3(10923, 21845) }, { AOM_CDF3(10923, 21845) },
                       { AOM_CDF3(27745, 30949) }, { AOM_CDF3(28287, 31294) },
                       { AOM_CDF3(28514, 31180) }, { AOM_CDF3(29919, 31408) } };

static const aom_cdf_prob default_obmc_cdf[BLOCK_SIZES_ALL][CDF_SIZE(2)] = {
  { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
  { AOM_CDF2(16763) }, { AOM_CDF2(9986) },  { AOM_CDF2(7171) },
  { AOM_CDF2(24515) }, { AOM_CDF2(9319) },  { AOM_CDF2(10944) },
  { AOM_CDF2(29115) }, { AOM_CDF2(21683) }, { AOM_CDF2(22739) },
  { AOM_CDF2(30959) }, { AOM_CDF2(29509) }, { AOM_CDF2(31401) },
  { AOM_CDF2(32706) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
  { AOM_CDF2(25171) }, { AOM_CDF2(26100) }, { AOM_CDF2(25536) },
  { AOM_CDF2(29364) }
};

static const aom_cdf_prob default_intra_inter_cdf[INTRA_INTER_CONTEXTS]
                                                 [CDF_SIZE(2)] = {
                                                   { AOM_CDF2(732) },
                                                   { AOM_CDF2(15047) },
                                                   { AOM_CDF2(18394) },
                                                   { AOM_CDF2(24957) }
                                                 };

static const aom_cdf_prob default_comp_inter_cdf[COMP_INTER_CONTEXTS][CDF_SIZE(
    2)] = { { AOM_CDF2(28953) },
            { AOM_CDF2(26943) },
            { AOM_CDF2(13477) },
            { AOM_CDF2(11039) },
            { AOM_CDF2(2939) } };

static const aom_cdf_prob default_comp_ref_type_cdf[COMP_REF_TYPE_CONTEXTS]
                                                   [CDF_SIZE(2)] = {
                                                     { AOM_CDF2(975) },
                                                     { AOM_CDF2(1661) },
                                                     { AOM_CDF2(8575) },
                                                     { AOM_CDF2(6659) },
                                                     { AOM_CDF2(22269) }
                                                   };

static const aom_cdf_prob
    default_uni_comp_ref_cdf[UNI_COMP_REF_CONTEXTS][UNIDIR_COMP_REFS -
                                                    1][CDF_SIZE(2)] = {
      { { AOM_CDF2(6003) }, { AOM_CDF2(3301) }, { AOM_CDF2(2977) } },
      { { AOM_CDF2(23164) }, { AOM_CDF2(13113) }, { AOM_CDF2(14444) } },
      { { AOM_CDF2(31826) }, { AOM_CDF2(24288) }, { AOM_CDF2(25968) } }
    };

static const aom_cdf_prob default_single_ref_cdf[REF_CONTEXTS][SINGLE_REFS - 1]
                                                [CDF_SIZE(2)] = {
                                                  { { AOM_CDF2(4702) },
                                                    { AOM_CDF2(1330) },
                                                    { AOM_CDF2(3754) },
                                                    { AOM_CDF2(7486) },
                                                    { AOM_CDF2(690) },
                                                    { AOM_CDF2(955) } },
                                                  { { AOM_CDF2(17463) },
                                                    { AOM_CDF2(16937) },
                                                    { AOM_CDF2(19871) },
                                                    { AOM_CDF2(25127) },
                                                    { AOM_CDF2(10108) },
                                                    { AOM_CDF2(14355) } },
                                                  { { AOM_CDF2(30067) },
                                                    { AOM_CDF2(31092) },
                                                    { AOM_CDF2(31580) },
                                                    { AOM_CDF2(32074) },
                                                    { AOM_CDF2(28118) },
                                                    { AOM_CDF2(30997) } }
                                                };

static const aom_cdf_prob
    default_comp_ref_cdf[REF_CONTEXTS][FWD_REFS - 1][CDF_SIZE(2)] = {
      { { AOM_CDF2(4200) }, { AOM_CDF2(10044) }, { AOM_CDF2(1232) } },
      { { AOM_CDF2(19511) }, { AOM_CDF2(23642) }, { AOM_CDF2(13326) } },
      { { AOM_CDF2(30951) }, { AOM_CDF2(31408) }, { AOM_CDF2(26793) } }
    };

static const aom_cdf_prob
    default_comp_bwdref_cdf[REF_CONTEXTS][BWD_REFS - 1][CDF_SIZE(2)] = {
      { { AOM_CDF2(1806) }, { AOM_CDF2(986) } },
      { { AOM_CDF2(17421) }, { AOM_CDF2(15020) } },
      { { AOM_CDF2(31088) }, { AOM_CDF2(31006) } }
    };

const aom_cdf_prob
    default_palette_y_size_cdf[PALATTE_BSIZE_CTXS][CDF_SIZE(PALETTE_SIZES)] = {
      { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
      { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
      { AOM_CDF7(7886, 12757, 17685, 21566, 25406, 29044) },
      { AOM_CDF7(7412, 11797, 16503, 20354, 24284, 28370) },
      { AOM_CDF7(8051, 13364, 17953, 21554, 25116, 28898) },
      { AOM_CDF7(8959, 14685, 18969, 22452, 25870, 29008) },
      { AOM_CDF7(13550, 19696, 22531, 24840, 27729, 30422) },
      { AOM_CDF7(6881, 12641, 15611, 18420, 23931, 27274) },
      { AOM_CDF7(15217, 20478, 21822, 23321, 26828, 29317) }
    };

const aom_cdf_prob default_palette_uv_size_cdf[PALATTE_BSIZE_CTXS][CDF_SIZE(
    PALETTE_SIZES)] = { { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
                        { AOM_CDF7(4681, 9362, 14043, 18725, 23406, 28087) },
                        { AOM_CDF7(7628, 18918, 26164, 29465, 31233, 32223) },
                        { AOM_CDF7(5784, 15361, 22893, 27262, 29909, 31690) },
                        { AOM_CDF7(4014, 10751, 17267, 21826, 26211, 29478) },
                        { AOM_CDF7(3108, 9787, 14947, 18906, 23481, 27572) },
                        { AOM_CDF7(3460, 8861, 12900, 17623, 22509, 26936) },
                        { AOM_CDF7(2862, 10598, 16541, 22988, 26447, 29246) },
                        { AOM_CDF7(728, 6827, 13608, 21254, 23529, 27489) } };

const aom_cdf_prob default_palette_y_mode_cdf
    [PALATTE_BSIZE_CTXS][PALETTE_Y_MODE_CONTEXTS][CDF_SIZE(2)] = {
      { { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) } },
      { { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) } },
      { { AOM_CDF2(31645) }, { AOM_CDF2(2346) }, { AOM_CDF2(783) } },
      { { AOM_CDF2(31591) }, { AOM_CDF2(1726) }, { AOM_CDF2(502) } },
      { { AOM_CDF2(31621) }, { AOM_CDF2(2521) }, { AOM_CDF2(510) } },
      { { AOM_CDF2(31717) }, { AOM_CDF2(2213) }, { AOM_CDF2(563) } },
      { { AOM_CDF2(32280) }, { AOM_CDF2(5261) }, { AOM_CDF2(781) } },
      { { AOM_CDF2(32290) }, { AOM_CDF2(3343) }, { AOM_CDF2(158) } },
      { { AOM_CDF2(32507) }, { AOM_CDF2(8667) }, { AOM_CDF2(51) } }
    };

const aom_cdf_prob
    default_palette_uv_mode_cdf[PALETTE_UV_MODE_CONTEXTS][CDF_SIZE(2)] = {
      { AOM_CDF2(32425) }, { AOM_CDF2(22216) }
    };

const aom_cdf_prob default_palette_y_color_index_cdf
    [PALETTE_SIZES][PALETTE_COLOR_INDEX_CONTEXTS][CDF_SIZE(PALETTE_COLORS)] = {
      {
          { AOM_CDF2(28804) },
          { AOM_CDF2(16384) },
          { AOM_CDF2(10393) },
          { AOM_CDF2(27175) },
          { AOM_CDF2(31629) },
      },
      {
          { AOM_CDF3(27890, 30447) },
          { AOM_CDF3(11125, 25290) },
          { AOM_CDF3(7163, 29983) },
          { AOM_CDF3(22737, 28070) },
          { AOM_CDF3(31852, 32338) },
      },
      {
          { AOM_CDF4(25708, 28126, 30054) },
          { AOM_CDF4(9374, 21664, 27295) },
          { AOM_CDF4(7047, 26856, 29808) },
          { AOM_CDF4(19208, 24452, 28317) },
          { AOM_CDF4(31410, 31818, 32243) },
      },
      {
          { AOM_CDF5(24515, 26725, 28390, 30161) },
          { AOM_CDF5(8442, 19564, 23442, 27622) },
          { AOM_CDF5(5352, 26371, 28535, 30623) },
          { AOM_CDF5(19310, 23464, 26493, 29357) },
          { AOM_CDF5(31404, 31694, 32001, 32339) },
      },
      {
          { AOM_CDF6(23394, 25577, 27088, 28513, 30128) },
          { AOM_CDF6(7460, 17455, 20826, 24781, 27997) },
          { AOM_CDF6(5879, 25238, 27211, 28957, 30749) },
          { AOM_CDF6(19199, 22976, 25279, 27442, 29694) },
          { AOM_CDF6(31350, 31612, 31860, 32100, 32377) },
      },
      {
          { AOM_CDF7(22759, 24886, 26177, 27438, 28750, 30185) },
          { AOM_CDF7(6813, 15481, 19022, 22691, 25584, 28571) },
          { AOM_CDF7(7339, 23773, 25735, 27388, 29048, 30743) },
          { AOM_CDF7(18336, 22174, 24273, 26060, 28040, 29961) },
          { AOM_CDF7(31218, 31454, 31672, 31879, 32121, 32391) },
      },
      {
          { AOM_CDF8(21359, 23619, 24935, 26149, 27356, 28719, 30124) },
          { AOM_CDF8(6851, 15341, 17801, 21563, 24243, 26732, 29188) },
          { AOM_CDF8(5901, 22911, 24827, 26358, 27854, 29311, 30839) },
          { AOM_CDF8(19232, 22574, 24365, 25926, 27465, 29008, 30428) },
          { AOM_CDF8(30962, 31211, 31455, 31663, 31894, 32132, 32379) },
      },
    };

const aom_cdf_prob default_palette_uv_color_index_cdf
    [PALETTE_SIZES][PALETTE_COLOR_INDEX_CONTEXTS][CDF_SIZE(PALETTE_COLORS)] = {
      {
          { AOM_CDF2(29074) },
          { AOM_CDF2(16384) },
          { AOM_CDF2(9098) },
          { AOM_CDF2(28298) },
          { AOM_CDF2(31514) },
      },
      {
          { AOM_CDF3(25376, 29194) },
          { AOM_CDF3(11856, 27116) },
          { AOM_CDF3(7160, 27863) },
          { AOM_CDF3(19902, 25291) },
          { AOM_CDF3(30615, 31630) },
      },
      {
          { AOM_CDF4(24341, 27243, 29931) },
          { AOM_CDF4(9468, 22620, 27296) },
          { AOM_CDF4(5710, 26072, 29298) },
          { AOM_CDF4(18274, 22086, 28456) },
          { AOM_CDF4(30617, 31233, 31963) },
      },
      {
          { AOM_CDF5(22780, 25263, 27629, 30024) },
          { AOM_CDF5(8576, 20484, 23841, 28373) },
          { AOM_CDF5(3141, 28062, 29671, 31160) },
          { AOM_CDF5(18099, 21005, 25316, 28475) },
          { AOM_CDF5(31314, 31609, 32007, 32391) },
      },
      {
          { AOM_CDF6(21918, 24287, 26458, 28619, 30478) },
          { AOM_CDF6(7047, 16344, 19408, 24642, 28389) },
          { AOM_CDF6(4355, 25210, 26967, 29003, 30931) },
          { AOM_CDF6(17255, 20928, 23603, 27015, 29679) },
          { AOM_CDF6(30672, 30935, 31371, 31713, 32190) },
      },
      {
          { AOM_CDF7(20937, 22868, 24781, 26755, 28557, 30423) },
          { AOM_CDF7(6304, 15319, 18324, 21979, 25502, 28686) },
          { AOM_CDF7(3120, 26787, 27894, 29108, 30407, 31577) },
          { AOM_CDF7(16083, 18264, 21851, 24988, 27266, 29849) },
          { AOM_CDF7(31021, 31227, 31476, 31727, 31962, 32307) },
      },
      {
          { AOM_CDF8(21377, 23089, 24497, 25965, 27433, 28816, 30504) },
          { AOM_CDF8(5417, 14565, 17353, 20496, 23645, 26464, 29381) },
          { AOM_CDF8(3411, 25758, 26803, 27916, 29170, 30363, 31600) },
          { AOM_CDF8(17456, 19452, 21762, 23601, 26164, 28622, 30492) },
          { AOM_CDF8(31157, 31289, 31455, 31607, 31763, 31965, 32269) },
      },
    };

static const aom_cdf_prob
    default_txfm_partition_cdf[TXFM_PARTITION_CONTEXTS][CDF_SIZE(2)] = {
      { AOM_CDF2(30120) }, { AOM_CDF2(26048) }, { AOM_CDF2(22682) },
      { AOM_CDF2(24438) }, { AOM_CDF2(18603) }, { AOM_CDF2(10293) },
      { AOM_CDF2(20377) }, { AOM_CDF2(13583) }, { AOM_CDF2(12541) },
      { AOM_CDF2(27825) }, { AOM_CDF2(21245) }, { AOM_CDF2(12037) },
      { AOM_CDF2(26500) }, { AOM_CDF2(20045) }, { AOM_CDF2(15915) },
      { AOM_CDF2(26840) }, { AOM_CDF2(21225) }, { AOM_CDF2(15519) },
      { AOM_CDF2(28000) }, { AOM_CDF2(22589) }, { AOM_CDF2(17378) }
    };

static const aom_cdf_prob default_skip_cdfs[SKIP_CONTEXTS][CDF_SIZE(2)] = {
  { AOM_CDF2(32050) }, { AOM_CDF2(15139) }, { AOM_CDF2(3513) }
};

static const aom_cdf_prob default_skip_mode_cdfs[SKIP_MODE_CONTEXTS][CDF_SIZE(
    2)] = { { AOM_CDF2(32556) }, { AOM_CDF2(18427) }, { AOM_CDF2(7777) } };

static const aom_cdf_prob
    default_compound_idx_cdfs[COMP_INDEX_CONTEXTS][CDF_SIZE(2)] = {
      { AOM_CDF2(18197) }, { AOM_CDF2(12309) }, { AOM_CDF2(6706) },
      { AOM_CDF2(11420) }, { AOM_CDF2(6653) },  { AOM_CDF2(2536) }
    };

static const aom_cdf_prob
    default_comp_group_idx_cdfs[COMP_GROUP_IDX_CONTEXTS][CDF_SIZE(2)] = {
      { AOM_CDF2(26240) }, { AOM_CDF2(22404) }, { AOM_CDF2(18750) },
      { AOM_CDF2(23384) }, { AOM_CDF2(18858) }, { AOM_CDF2(19620) }
    };

static const aom_cdf_prob default_intrabc_cdf[CDF_SIZE(2)] = { AOM_CDF2(
    30461) };

static const aom_cdf_prob default_filter_intra_mode_cdf[CDF_SIZE(
    FILTER_INTRA_MODES)] = { AOM_CDF5(8349, 12429, 16472, 29510) };

static const aom_cdf_prob default_filter_intra_cdfs[BLOCK_SIZES_ALL][CDF_SIZE(
    2)] = { { AOM_CDF2(3641) },  { AOM_CDF2(6651) },  { AOM_CDF2(6067) },
            { AOM_CDF2(8525) },  { AOM_CDF2(12952) }, { AOM_CDF2(11751) },
            { AOM_CDF2(14349) }, { AOM_CDF2(14609) }, { AOM_CDF2(14573) },
            { AOM_CDF2(22184) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
            { AOM_CDF2(16384) }, { AOM_CDF2(16384) }, { AOM_CDF2(16384) },
            { AOM_CDF2(16384) }, { AOM_CDF2(13619) }, { AOM_CDF2(10567) },
            { AOM_CDF2(21537) }, { AOM_CDF2(18888) }, { AOM_CDF2(16384) },
            { AOM_CDF2(16384) } };

static const aom_cdf_prob default_switchable_restore_cdf[CDF_SIZE(
    RESTORE_SWITCHABLE_TYPES)] = { AOM_CDF3(11488, 22015) };

static const aom_cdf_prob default_wiener_restore_cdf[CDF_SIZE(2)] = { AOM_CDF2(
    12848) };

static const aom_cdf_prob default_sgrproj_restore_cdf[CDF_SIZE(2)] = { AOM_CDF2(
    18936) };

static const aom_cdf_prob default_tx_size_cdf[MAX_TX_CATS][TX_SIZE_CONTEXTS]
                                             [CDF_SIZE(MAX_TX_DEPTH + 1)] = {
                                               {
                                                   { AOM_CDF2(14483) },
                                                   { AOM_CDF2(18883) },
                                                   { AOM_CDF2(21504) },
                                               },
                                               {
                                                   { AOM_CDF3(14129, 25900) },
                                                   { AOM_CDF3(14500, 26792) },
                                                   { AOM_CDF3(19819, 29921) },
                                               },
                                               {
                                                   { AOM_CDF3(13767, 23718) },
                                                   { AOM_CDF3(14058, 25296) },
                                                   { AOM_CDF3(19486, 28411) },
                                               },
                                               {
                                                   { AOM_CDF3(16565, 22636) },
                                                   { AOM_CDF3(18426, 25344) },
                                                   { AOM_CDF3(23408, 28450) },
                                               },
                                             };

static const aom_cdf_prob default_delta_q_cdf[CDF_SIZE(DELTA_Q_PROBS + 1)] = {
  AOM_CDF4(28160, 32120, 32677)
};

static const aom_cdf_prob default_delta_lf_multi_cdf[FRAME_LF_COUNT][CDF_SIZE(
    DELTA_LF_PROBS + 1)] = { { AOM_CDF4(28160, 32120, 32677) },
                             { AOM_CDF4(28160, 32120, 32677) },
                             { AOM_CDF4(28160, 32120, 32677) },
                             { AOM_CDF4(28160, 32120, 32677) } };
static const aom_cdf_prob default_delta_lf_cdf[CDF_SIZE(DELTA_LF_PROBS + 1)] = {
  AOM_CDF4(28160, 32120, 32677)
};

// FIXME(someone) need real defaults here
static const aom_cdf_prob default_seg_tree_cdf[CDF_SIZE(MAX_SEGMENTS)] = {
  AOM_CDF8(4096, 8192, 12288, 16384, 20480, 24576, 28672)
};

static const aom_cdf_prob
    default_segment_pred_cdf[SEG_TEMPORAL_PRED_CTXS][CDF_SIZE(2)] = {
      { AOM_CDF2(128 * 128) }, { AOM_CDF2(128 * 128) }, { AOM_CDF2(128 * 128) }
    };

static const aom_cdf_prob
    default_spatial_pred_seg_tree_cdf[SPATIAL_PREDICTION_PROBS][CDF_SIZE(
        MAX_SEGMENTS)] = {
      {
          AOM_CDF8(5622, 7893, 16093, 18233, 27809, 28373, 32533),
      },
      {
          AOM_CDF8(14274, 18230, 22557, 24935, 29980, 30851, 32344),
      },
      {
          AOM_CDF8(27527, 28487, 28723, 28890, 32397, 32647, 32679),
      },
    };

#define MAX_COLOR_CONTEXT_HASH 8
// Negative values are invalid
static const int palette_color_index_context_lookup[MAX_COLOR_CONTEXT_HASH +
                                                    1] = { -1, -1, 0, -1, -1,
                                                           4,  3,  2, 1 };

#define NUM_PALETTE_NEIGHBORS 3  // left, top-left and top.
int av1_get_palette_color_index_context(const uint8_t *color_map, int stride,
                                        int r, int c, int palette_size,
                                        uint8_t *color_order, int *color_idx) {
  int i;
  // The +10 below should not be needed. But we get a warning "array subscript
  // is above array bounds [-Werror=array-bounds]" without it, possibly due to
  // this (or similar) bug: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59124
  int scores[PALETTE_MAX_SIZE + 10];
  const int weights[NUM_PALETTE_NEIGHBORS] = { 2, 1, 2 };
  const int hash_multipliers[NUM_PALETTE_NEIGHBORS] = { 1, 2, 2 };
  int color_index_ctx_hash;
  int color_index_ctx;
  int color_neighbors[NUM_PALETTE_NEIGHBORS];
  int inverse_color_order[PALETTE_MAX_SIZE];
  assert(palette_size <= PALETTE_MAX_SIZE);
  assert(r > 0 || c > 0);

  // Get color indices of neighbors.
  color_neighbors[0] = (c - 1 >= 0) ? color_map[r * stride + c - 1] : -1;
  color_neighbors[1] =
      (c - 1 >= 0 && r - 1 >= 0) ? color_map[(r - 1) * stride + c - 1] : -1;
  color_neighbors[2] = (r - 1 >= 0) ? color_map[(r - 1) * stride + c] : -1;

  for (i = 0; i < PALETTE_MAX_SIZE; ++i) {
    color_order[i] = i;
    inverse_color_order[i] = i;
  }
  memset(scores, 0, PALETTE_MAX_SIZE * sizeof(scores[0]));
  for (i = 0; i < NUM_PALETTE_NEIGHBORS; ++i) {
    if (color_neighbors[i] >= 0) {
      scores[color_neighbors[i]] += weights[i];
    }
  }

  // Get the top NUM_PALETTE_NEIGHBORS scores (sorted from large to small).
  for (i = 0; i < NUM_PALETTE_NEIGHBORS; ++i) {
    int max = scores[i];
    int max_idx = i;
    int j;
    for (j = i + 1; j < palette_size; ++j) {
      if (scores[j] > max) {
        max = scores[j];
        max_idx = j;
      }
    }
    if (max_idx != i) {
      // Move the score at index 'max_idx' to index 'i', and shift the scores
      // from 'i' to 'max_idx - 1' by 1.
      const int max_score = scores[max_idx];
      const uint8_t max_color_order = color_order[max_idx];
      int k;
      for (k = max_idx; k > i; --k) {
        scores[k] = scores[k - 1];
        color_order[k] = color_order[k - 1];
        inverse_color_order[color_order[k]] = k;
      }
      scores[i] = max_score;
      color_order[i] = max_color_order;
      inverse_color_order[color_order[i]] = i;
    }
  }

  // Get hash value of context.
  color_index_ctx_hash = 0;
  for (i = 0; i < NUM_PALETTE_NEIGHBORS; ++i) {
    color_index_ctx_hash += scores[i] * hash_multipliers[i];
  }
  assert(color_index_ctx_hash > 0);
  assert(color_index_ctx_hash <= MAX_COLOR_CONTEXT_HASH);

  // Lookup context from hash.
  color_index_ctx = palette_color_index_context_lookup[color_index_ctx_hash];
  assert(color_index_ctx >= 0);
  assert(color_index_ctx < PALETTE_COLOR_INDEX_CONTEXTS);

  if (color_idx != NULL) {
    *color_idx = inverse_color_order[color_map[r * stride + c]];
  }
  return color_index_ctx;
}
#undef NUM_PALETTE_NEIGHBORS
#undef MAX_COLOR_CONTEXT_HASH

static void init_mode_probs(FRAME_CONTEXT *fc) {
  av1_copy(fc->palette_y_size_cdf, default_palette_y_size_cdf);
  av1_copy(fc->palette_uv_size_cdf, default_palette_uv_size_cdf);
  av1_copy(fc->palette_y_color_index_cdf, default_palette_y_color_index_cdf);
  av1_copy(fc->palette_uv_color_index_cdf, default_palette_uv_color_index_cdf);
  av1_copy(fc->kf_y_cdf, default_kf_y_mode_cdf);
  av1_copy(fc->angle_delta_cdf, default_angle_delta_cdf);
  av1_copy(fc->comp_inter_cdf, default_comp_inter_cdf);
  av1_copy(fc->comp_ref_type_cdf, default_comp_ref_type_cdf);
  av1_copy(fc->uni_comp_ref_cdf, default_uni_comp_ref_cdf);
  av1_copy(fc->palette_y_mode_cdf, default_palette_y_mode_cdf);
  av1_copy(fc->palette_uv_mode_cdf, default_palette_uv_mode_cdf);
  av1_copy(fc->comp_ref_cdf, default_comp_ref_cdf);
  av1_copy(fc->comp_bwdref_cdf, default_comp_bwdref_cdf);
  av1_copy(fc->single_ref_cdf, default_single_ref_cdf);
  av1_copy(fc->txfm_partition_cdf, default_txfm_partition_cdf);
  av1_copy(fc->compound_index_cdf, default_compound_idx_cdfs);
  av1_copy(fc->comp_group_idx_cdf, default_comp_group_idx_cdfs);
  av1_copy(fc->newmv_cdf, default_newmv_cdf);
  av1_copy(fc->zeromv_cdf, default_zeromv_cdf);
  av1_copy(fc->refmv_cdf, default_refmv_cdf);
  av1_copy(fc->drl_cdf, default_drl_cdf);
  av1_copy(fc->motion_mode_cdf, default_motion_mode_cdf);
  av1_copy(fc->obmc_cdf, default_obmc_cdf);
  av1_copy(fc->inter_compound_mode_cdf, default_inter_compound_mode_cdf);
  av1_copy(fc->compound_type_cdf, default_compound_type_cdf);
  av1_copy(fc->wedge_idx_cdf, default_wedge_idx_cdf);
  av1_copy(fc->interintra_cdf, default_interintra_cdf);
  av1_copy(fc->wedge_interintra_cdf, default_wedge_interintra_cdf);
  av1_copy(fc->interintra_mode_cdf, default_interintra_mode_cdf);
  av1_copy(fc->seg.pred_cdf, default_segment_pred_cdf);
  av1_copy(fc->seg.tree_cdf, default_seg_tree_cdf);
  av1_copy(fc->filter_intra_cdfs, default_filter_intra_cdfs);
  av1_copy(fc->filter_intra_mode_cdf, default_filter_intra_mode_cdf);
  av1_copy(fc->switchable_restore_cdf, default_switchable_restore_cdf);
  av1_copy(fc->wiener_restore_cdf, default_wiener_restore_cdf);
  av1_copy(fc->sgrproj_restore_cdf, default_sgrproj_restore_cdf);
  av1_copy(fc->y_mode_cdf, default_if_y_mode_cdf);
  av1_copy(fc->uv_mode_cdf, default_uv_mode_cdf);
  av1_copy(fc->switchable_interp_cdf, default_switchable_interp_cdf);
  av1_copy(fc->partition_cdf, default_partition_cdf);
  av1_copy(fc->intra_ext_tx_cdf, default_intra_ext_tx_cdf);
  av1_copy(fc->inter_ext_tx_cdf, default_inter_ext_tx_cdf);
  av1_copy(fc->skip_mode_cdfs, default_skip_mode_cdfs);
  av1_copy(fc->skip_cdfs, default_skip_cdfs);
  av1_copy(fc->intra_inter_cdf, default_intra_inter_cdf);
  for (int i = 0; i < SPATIAL_PREDICTION_PROBS; i++)
    av1_copy(fc->seg.spatial_pred_seg_cdf[i],
             default_spatial_pred_seg_tree_cdf[i]);
  av1_copy(fc->tx_size_cdf, default_tx_size_cdf);
  av1_copy(fc->delta_q_cdf, default_delta_q_cdf);
  av1_copy(fc->delta_lf_cdf, default_delta_lf_cdf);
  av1_copy(fc->delta_lf_multi_cdf, default_delta_lf_multi_cdf);
  av1_copy(fc->cfl_sign_cdf, default_cfl_sign_cdf);
  av1_copy(fc->cfl_alpha_cdf, default_cfl_alpha_cdf);
  av1_copy(fc->intrabc_cdf, default_intrabc_cdf);
}

void av1_set_default_ref_deltas(int8_t *ref_deltas) {
  assert(ref_deltas != NULL);

  ref_deltas[INTRA_FRAME] = 1;
  ref_deltas[LAST_FRAME] = 0;
  ref_deltas[LAST2_FRAME] = ref_deltas[LAST_FRAME];
  ref_deltas[LAST3_FRAME] = ref_deltas[LAST_FRAME];
  ref_deltas[BWDREF_FRAME] = ref_deltas[LAST_FRAME];
  ref_deltas[GOLDEN_FRAME] = -1;
  ref_deltas[ALTREF2_FRAME] = -1;
  ref_deltas[ALTREF_FRAME] = -1;
}

void av1_set_default_mode_deltas(int8_t *mode_deltas) {
  assert(mode_deltas != NULL);

  mode_deltas[0] = 0;
  mode_deltas[1] = 0;
}

static void set_default_lf_deltas(struct loopfilter *lf) {
  lf->mode_ref_delta_enabled = 1;
  lf->mode_ref_delta_update = 1;

  av1_set_default_ref_deltas(lf->ref_deltas);
  av1_set_default_mode_deltas(lf->mode_deltas);
}

void av1_setup_frame_contexts(AV1_COMMON *cm) {
  // Store the frame context into a special slot (not associated with any
  // reference buffer), so that we can set up cm->pre_fc correctly later
  // This function must ONLY be called when cm->fc has been initialized with
  // default probs, either by av1_setup_past_independence or after manually
  // initializing them
  cm->frame_contexts[FRAME_CONTEXT_DEFAULTS] = *cm->fc;
  if (cm->large_scale_tile) {
    for (int i = 0; i < FRAME_CONTEXTS; ++i) cm->frame_contexts[i] = *cm->fc;
  }
}

void av1_setup_past_independence(AV1_COMMON *cm) {
  // Reset the segment feature data to the default stats:
  // Features disabled, 0, with delta coding (Default state).
  av1_clearall_segfeatures(&cm->seg);

  cm->current_frame_seg_map = cm->cur_frame->seg_map;

  if (cm->current_frame_seg_map)
    memset(cm->current_frame_seg_map, 0, (cm->mi_rows * cm->mi_cols));

  // reset mode ref deltas
  av1_set_default_ref_deltas(cm->cur_frame->ref_deltas);
  av1_set_default_mode_deltas(cm->cur_frame->mode_deltas);
  set_default_lf_deltas(&cm->lf);

  av1_default_coef_probs(cm);
  init_mode_probs(cm->fc);
  av1_init_mv_probs(cm);
  av1_init_lv_map(cm);
  cm->fc->initialized = 1;
  av1_setup_frame_contexts(cm);

  // prev_mip will only be allocated in encoder.
  if (frame_is_intra_only(cm) && cm->prev_mip)
    memset(cm->prev_mip, 0,
           cm->mi_stride * cm->mi_rows * sizeof(*cm->prev_mip));
}
