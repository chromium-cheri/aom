#ifndef AV1_ENCODER_TX_PRUNE_LAPLACIAN
#define AV1_ENCODER_TX_PRUNE_LAPLACIAN

#ifdef __cplusplus
extern "C" {
#endif

#define PRINT_XLX 0       // print the costs (for debug only)
#define USE_UNIFORM_WI 0
#define TAU_I 0.34        // threshold for i
#define TAU_DAF 0.40      // threshold for d, a, f

// the following Laplacians are the original ones scaled by those numbers
static const int sc[4][4] = {
  { 23, 12, 24, 48 },  // DCT
  { 1, 1, 1, 1 },      // ADST
  { 1, 1, 1, 1 },      // FLIPADST
#if USE_UNIFORM_WI
  { 1, 1, 1, 1 },  // IDTX
#else
  { 13, 26, 46, 41 },  // IDTX
#endif
};

static const int nedges[4][4] = {
  { 9, 21, 45, 93 },   // DCT
  { 4, 8, 16, 32 },    // ADST
  { 4, 8, 16, 32 },    // FLIPADST
  { 4, 8, 16, 32 },    // IDTX
};

// Laf = La - Lf
// It is for faster computation of x'*Lf*x aftering knowing x'*La*x
// (nedges=2, scale=1)
static const int Laf4[2][3] = {
  { 0, 0, 2 }, { 3, 3, -2 },
};

static const int Laf8[2][3] = {
  { 0, 0, 2 }, { 7, 7, -2 },
};

static const int Laf16[2][3] = {
  { 0, 0, 2 }, { 15, 15, -2 },
};

static const int Laf32[2][3] = {
  { 0, 0, 2 }, { 31, 31, -2 },
};

// Ld, La, Lf, and Li
static const int Ld4[9][3] = {
  { 0, 0, 5 }, { 1, 1, 5 }, { 2, 2, 5 }, { 3, 3, 5 },
  { 0, 1, 26 }, { 1, 2, 22 }, { 2, 3, 26 } , { 0, 2, 4 },
  { 1, 3, 4 },
};

static const int Ld8[21][3] = {
  { 0, 0, 1 }, { 1, 1, 1 }, { 2, 2, 1 }, { 3, 3, 1 },
  { 4, 4, 1 }, { 5, 5, 1 }, { 6, 6, 1 }, { 7, 7, 1 },
  { 0, 1, 13 }, { 1, 2, 12 }, { 2, 3, 12 }, { 3, 4, 12 },
  { 4, 5, 12 }, { 5, 6, 12 }, { 6, 7, 12 }, { 0, 2, 1 },
  { 1, 3, 1 }, { 2, 4, 1 }, { 3, 5, 1 }, { 4, 6, 1 },
  { 5, 7, 1 },
};

static const int Ld16[45][3] = {
  { 0, 0, 1 }, { 1, 1, 1 }, { 2, 2, 1 }, { 3, 3, 1 },
  { 4, 4, 1 }, { 5, 5, 1 }, { 6, 6, 1 }, { 7, 7, 1 },
  { 8, 8, 1 }, { 9, 9, 1 }, { 10, 10, 1 }, { 11, 11, 1 },
  { 12, 12, 1 }, { 13, 13, 1 }, { 14, 14, 1 }, { 15, 15, 1 },
  { 0, 1, 25 }, { 1, 2, 24 }, { 2, 3, 24 }, { 3, 4, 24 },
  { 4, 5, 24 }, { 5, 6, 24 }, { 6, 7, 24 }, { 7, 8, 24 },
  { 8, 9, 24 }, { 9, 10, 24 }, { 10, 11, 24 }, { 11, 12, 24 },
  { 12, 13, 24 }, { 13, 14, 24 }, { 14, 15, 25 },	{ 0, 2, 1 },
  { 1, 3, 1 }, { 2, 4, 1 }, { 3, 5, 1 }, { 4, 6, 1 },
  { 5, 7, 1 }, { 6, 8, 1 }, { 7, 9, 1 }, { 8, 10, 1 },
  { 9, 11, 1 }, { 10, 12, 1 }, { 11, 13, 1 }, { 12, 14, 1 },
  { 13, 15, 1 },
};

static const int Ld32[93][3] = {
  { 0, 0, 1 }, { 1, 1, 1 }, { 2, 2, 1 }, { 3, 3, 1 },
  { 4, 4, 1 }, { 5, 5, 1 }, { 6, 6, 1 }, { 7, 7, 1 },
  { 8, 8, 1 }, { 9, 9, 1 }, { 10, 10, 1 }, { 11, 11, 1 },
  { 12, 12, 1 }, { 13, 13, 1 }, { 14, 14, 1 }, { 15, 15, 1 },
  { 16, 16, 1 }, { 17, 17, 1 }, { 18, 18, 1 }, { 19, 19, 1 },
  { 20, 20, 1 }, { 21, 21, 1 }, { 22, 22, 1 }, { 23, 23, 1 },
  { 24, 24, 1 }, { 25, 25, 1 }, { 26, 26, 1 }, { 27, 27, 1 },
  { 28, 28, 1 }, { 29, 29, 1 }, { 30, 30, 1 }, { 31, 31, 1 },
  { 0, 1, 49 }, { 1, 2, 48 }, { 2, 3, 48 }, { 3, 4, 48 },
  { 4, 5, 48 }, { 5, 6, 48 }, { 6, 7, 48 }, { 7, 8, 48 },
  { 8, 9, 48 }, { 9, 10, 48 }, { 10, 11, 48 }, { 11, 12, 48 },
  { 12, 13, 48 }, { 13, 14, 48 }, { 14, 15, 48 },	{ 15, 16, 48 },
  { 16, 17, 48 }, { 17, 18, 48 }, { 18, 19, 48 },	{ 19, 20, 48 },
  { 20, 21, 48 }, { 21, 22, 48 }, { 22, 23, 48 },	{ 23, 24, 48 },
  { 24, 25, 48 }, { 25, 26, 48 }, { 26, 27, 48 },	{ 27, 28, 48 },
  { 28, 29, 48 }, { 29, 30, 48 }, { 30, 31, 49 },	{ 0, 2, 1 },
  { 1, 3, 1 }, { 2, 4, 1 }, { 3, 5, 1 }, { 4, 6, 1 },
  { 5, 7, 1 }, { 6, 8, 1 }, { 7, 9, 1 }, { 8, 10, 1 },
  { 9, 11, 1 }, { 10, 12, 1 }, { 11, 13, 1 }, { 12, 14, 1 },
  { 13, 15, 1 }, { 14, 16, 1 }, { 15, 17, 1 }, { 16, 18, 1 },
  { 17, 19, 1 }, { 18, 20, 1 }, { 19, 21, 1 }, { 20, 22, 1 },
  { 21, 23, 1 }, { 22, 24, 1 }, { 23, 25, 1 }, { 24, 26, 1 },
  { 25, 27, 1 }, { 26, 28, 1 }, { 27, 29, 1 }, { 28, 30, 1 },
  { 29, 31, 1 },
};

static const int La4[4][3] = {
  { 0, 0, 2 }, { 0, 1, 1 }, { 1, 2, 1 }, { 2, 3, 1 },
};

static const int La8[8][3] = {
  { 0, 0, 2 }, { 0, 1, 1 }, { 1, 2, 1 }, { 2, 3, 1 },
  { 3, 4, 1 }, { 4, 5, 1 }, { 5, 6, 1 }, { 6, 7, 1 },
};

static const int La16[16][3] = {
  { 0, 0, 2 }, { 0, 1, 1 }, { 1, 2, 1 }, { 2, 3, 1 },
  { 3, 4, 1 }, { 4, 5, 1 }, { 5, 6, 1 }, { 6, 7, 1 },
  { 7, 8, 1 }, { 8, 9, 1 }, { 9, 10, 1 }, { 10, 11, 1 },
  { 11, 12, 1 }, { 12, 13, 1 }, { 13, 14, 1 }, { 14, 15, 1 },
};

static const int La32[32][3] = {
  { 0, 0, 2 }, { 0, 1, 1 }, { 1, 2, 1 }, { 2, 3, 1 },
  { 3, 4, 1 }, { 4, 5, 1 }, { 5, 6, 1 }, { 6, 7, 1 },
  { 7, 8, 1 }, { 8, 9, 1 }, { 9, 10, 1 }, { 10, 11, 1 },
  { 11, 12, 1 }, { 12, 13, 1 }, { 13, 14, 1 }, { 14, 15, 1 },
  { 15, 16, 1 }, { 16, 17, 1 }, { 17, 18, 1 }, { 18, 19, 1 },
  { 19, 20, 1 }, { 20, 21, 1 }, { 21, 22, 1 }, { 22, 23, 1 },
  { 23, 24, 1 }, { 24, 25, 1 }, { 25, 26, 1 }, { 26, 27, 1 },
  { 27, 28, 1 }, { 28, 29, 1 }, { 29, 30, 1 }, { 30, 31, 1 },
};

#if USE_UNIFORM_WI
static const int Li4[4][3] = {
  { 0, 0, 2 }, { 1, 1, 2 }, { 2, 2, 2 }, { 3, 3, 2 },
};

static const int Li8[8][3] = {
  { 0, 0, 2 }, { 1, 1, 2 }, { 2, 2, 2 }, { 3, 3, 2 },
  { 4, 4, 2 }, { 5, 5, 2 }, { 6, 6, 2 }, { 7, 7, 2 },
};

static const int Li16[16][3] = {
  { 0, 0, 2 }, { 1, 1, 2 }, { 2, 2, 2 }, { 3, 3, 2 },
  { 4, 4, 2 }, { 5, 5, 2 }, { 6, 6, 2 }, { 7, 7, 2 },
  { 8, 8, 2 }, { 9, 9, 2 }, { 10, 10, 2 }, { 11, 11, 2 },
  { 12, 12, 2 }, { 13, 13, 2 }, { 14, 14, 2 }, { 15, 15, 2 },
};

static const int Li32[32][3] = {
  { 0, 0, 2 }, { 1, 1, 2 }, { 2, 2, 2 }, { 3, 3, 2 },
  { 4, 4, 2 }, { 5, 5, 2 }, { 6, 6, 2 }, { 7, 7, 2 },
  { 8, 8, 2 }, { 9, 9, 2 }, { 10, 10, 2 }, { 11, 11, 2 },
  { 12, 12, 2 }, { 13, 13, 2 }, { 14, 14, 2 }, { 15, 15, 2 },
  { 16, 16, 2 }, { 17, 17, 2 }, { 18, 18, 2 }, { 19, 19, 2 },
  { 20, 20, 2 }, { 21, 21, 2 }, { 22, 22, 2 }, { 23, 23, 2 },
  { 24, 24, 2 }, { 25, 25, 2 }, { 26, 26, 2 }, { 27, 27, 2 },
  { 28, 28, 2 }, { 29, 29, 2 }, { 30, 30, 2 }, { 31, 31, 2 },
};
#else
static const int Li4[4][3] = {
  { 0, 0, 2 }, { 1, 1, 16 }, { 2, 2, 36 }, { 3, 3, 50 },
};

static const int Li8[8][3] = {
  { 0, 0, 1 }, { 1, 1, 9 }, { 2, 2, 23 }, { 3, 3, 42 },
  { 4, 4, 62 }, { 5, 5, 81 }, { 6, 6, 95 }, { 7, 7, 103 },
};

static const int Li16[16][3] = {
  { 0, 0, 0 }, { 1, 1, 4 }, { 2, 2, 11 }, { 3, 3, 21 },
  { 4, 4, 34 }, { 5, 5, 49 }, { 6, 6, 65 }, { 7, 7, 83 },
  { 8, 8, 101 }, { 9, 9, 119 }, { 10, 10, 135 }, { 11, 11, 150 },
  { 12, 12, 163 }, { 13, 13, 173 }, { 14, 14, 180 }, { 15, 15, 184 },
};

static const int Li32[32][3] = {
  { 0, 0, 0 }, { 1, 1, 1 }, { 2, 2, 2 }, { 3, 3, 5 },
  { 4, 4, 8 }, { 5, 5, 12 }, { 6, 6, 16 }, { 7, 7, 21 },
  { 8, 8, 27 }, { 9, 9, 33 }, { 10, 10, 40 }, { 11, 11, 47 },
  { 12, 12, 54 }, { 13, 13, 62 }, { 14, 14, 70 }, { 15, 15, 78 },
  { 16, 16, 86 }, { 17, 17, 94 }, { 18, 18, 102 }, { 19, 19, 110 },
  { 20, 20, 117 }, { 21, 21, 124 }, { 22, 22, 131 }, { 23, 23, 137 },
  { 24, 24, 143 }, { 25, 25, 148 }, { 26, 26, 152 }, { 27, 27, 156 },
  { 28, 28, 159 }, { 29, 29, 162 }, { 30, 30, 163 }, { 31, 31, 164 },
};
#endif

#ifdef __cplusplus
}  // extern "C"
#endif

#endif  // AV1_ENCODER_TX_PRUNE_LAPLACIAN
