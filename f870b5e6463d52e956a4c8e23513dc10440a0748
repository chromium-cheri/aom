{
  "comments": [
    {
      "key": {
        "uuid": "cf84d86f_62108d30",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 14993
      },
      "writtenOn": "2020-09-21T16:35:04Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nIn this CL, we have optimized memory usage in CB_COEFF_BUFFER by\ndynamically allocating memory for transform coeff related info based on the\nchroma subsampling format.\n\nThis CL is verified to be bit-exact with no impact on encode-time.\n\nPFB the memory reduction for this patch, measured using the command\n$command time -v ./aomenc ... for cpu-used 1, 60 frames:\n\nResolution    Tile    Avg. Memory reduction\n                      Single   Multi\n                      thread   thread\n640x360       2x1     3.74%    3.58% (2 threads)\n832x480       2x1     4.31%    4.24% (2 threads)\n1280x720      2x2     2.36%    2.26% (4 threads)\n1920x1080     4x2     2.28%    1.90% (8 threads)\n\nWe observed an inconsistency in the data when memory profiling was done\nusing \u0027command time -v\u0027. The numbers mentioned above are averaged across\n10 instances (5 for hd-res).\n\nPFB the memory reduction results for this patch, measured using the command\n$valgrind --tool\u003dmassif ./aomenc ... for cpu-used 1, 60 frames:\n\nResolution    Tile    Memory reduction\n                      Single   Multi\n                      thread   thread\n640x360       2x1     6.24%    6.08% (2 threads)\n832x480       2x1     6.90%    6.54% (2 threads)\n1280x720      2x2     2.58%    2.49% (4 threads)\n1920x1080     4x2     2.55%    2.27% (8 threads)\n\nMemory profiling results generated using the valgrind-massif tool seems\nto be consistent.\n\nAWCY Link (cpu-used 1, 60 frames, bit-exact)\nhttps://beta.arewecompressedyet.com/?job\u003d100920_ref_cpu1_master%402020-09-10T18%3A57%3A48.366Z\u0026job\u003d140920_mem_opt_cpu1_master%402020-09-14T08%3A45%3A13.852Z\n\nPlease review.\n\nRegards,\nJayasanker.\n\n",
      "revId": "f870b5e6463d52e956a4c8e23513dc10440a0748",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c884e03_101a88c2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2020-09-21T17:54:54Z",
      "side": 1,
      "message": "Thanks for the optimization. Good memory reduction.\nRegarding \"an inconsistency in the data when memory profiling was done\nusing \u0027command time -v\u0027\", what do you mean? Memory reduction percentage is different? Did the inconsistency happen for all res?",
      "parentUuid": "cf84d86f_62108d30",
      "revId": "f870b5e6463d52e956a4c8e23513dc10440a0748",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "67e6c78c_0e998fb9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 14993
      },
      "writtenOn": "2020-09-22T09:19:19Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nThere was a run-to-run difference in the memory profiling numbers generated using \u0027command time -v\u0027 across multiple tests. The magnitude of the variation was observed to be high for lower res (360p and 480p) compared to higher res (720p and 1080p). The results mentioned in the commit message were averaged out across multiple instances to produce a reliable output.\n\nRegards,\nJayasanker.",
      "parentUuid": "0c884e03_101a88c2",
      "revId": "f870b5e6463d52e956a4c8e23513dc10440a0748",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}