{
  "comments": [
    {
      "key": {
        "uuid": "10fdb13a_6eec0445",
        "filename": "av1/encoder/cost.c",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 5046
      },
      "writtenOn": "2017-06-21T16:46:37Z",
      "side": 1,
      "message": "This can be replaced with:\n\n    const aom_cdf_prob p15 \u003d OD_ICDF(cdf[i]) - (i \u003e 0 ? OD_ICDF(cdf[i - 1]) : 0);\n\nwhich encapsulates the CONFIG_EC_SMALLMUL #define.",
      "revId": "5b0f5174a38fbd165c2c4ca64bab5c3e8f1c01f1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0de639db_9f8c492c",
        "filename": "av1/encoder/cost.c",
        "patchSetId": 4
      },
      "lineNbr": 73,
      "author": {
        "id": 5046
      },
      "writtenOn": "2017-06-21T16:46:37Z",
      "side": 1,
      "message": "Eventually it would be nice to reorder all of the CDFs so that we do not need the ind/inv mappings, but this is a perfectly fine workaround for now.",
      "revId": "5b0f5174a38fbd165c2c4ca64bab5c3e8f1c01f1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0248e4ba_a4aae6c4",
        "filename": "av1/encoder/cost.c",
        "patchSetId": 4
      },
      "lineNbr": 80,
      "author": {
        "id": 5046
      },
      "writtenOn": "2017-06-21T16:46:37Z",
      "side": 1,
      "message": "This can be replaced with:\n\n    if (cdf[i] \u003d\u003d OD_ICDF(0)) {\n\nwhich encapsulates the CONFIG_EC_SMALLMUL #define.",
      "revId": "5b0f5174a38fbd165c2c4ca64bab5c3e8f1c01f1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6dae3ae6_6d5885c0",
        "filename": "av1/encoder/cost.c",
        "patchSetId": 4
      },
      "lineNbr": 80,
      "author": {
        "id": 5046
      },
      "writtenOn": "2017-06-21T17:16:23Z",
      "side": 1,
      "message": "Apologies, this should use AOM_ICDF() instead of OD_ICDF() and should have also used the CDF_PROB_TOP constant, e.g.,\n\nif (cdf[i] \u003d\u003d AOM_ICDF(CDF_PROB_TOP)) break;\n\nFor clarity, it might be better to compute the p15 value in the same iterative manner done in av1/common/entropy.c:5342 build_tail_cdfs().  Maybe something like:\n\nint i;\naom_cdf_prob prev_cdf;\nprev_cdf \u003d 0;\nfor (i \u003d 0; ; i++) {\n  const aom_cdf_prob p15 \u003d AOM_ICDF(cdf[i]) - prev_cdf;\n  prev_cdf \u003d AOM_ICDF(cdf[i]);\n\n  if (inv_map) {\n    costs[inv_map[i]] \u003d av1_cost_symbol(p15);\n  }\n  else {\n    costs[i] \u003d av1_cost_symbol(p15);\n  }\n\n  if (cdf[i] \u003d\u003d AOM_ICDF(CDF_PROB_TOP)) {\n    break;\n  }\n}",
      "parentUuid": "0248e4ba_a4aae6c4",
      "revId": "5b0f5174a38fbd165c2c4ca64bab5c3e8f1c01f1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34e31207_da23f577",
        "filename": "av1/encoder/cost.h",
        "patchSetId": 4
      },
      "lineNbr": 39,
      "author": {
        "id": 5046
      },
      "writtenOn": "2017-06-21T16:46:37Z",
      "side": 1,
      "message": "Can this happen?  If you are seeing this, it means two adjacent CDF values are the same which would mean that the probability of that symbol is 0 (which seems bad).\n\nMaybe replace this with assert(p15 \u003e 0 \u0026\u0026 p15 \u003c 32768)",
      "revId": "5b0f5174a38fbd165c2c4ca64bab5c3e8f1c01f1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}