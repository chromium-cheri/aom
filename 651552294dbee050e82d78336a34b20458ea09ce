{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "34085229_63c7a747",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 114,
      "author": {
        "id": 31042
      },
      "writtenOn": "2023-07-10T21:06:46Z",
      "side": 1,
      "message": "This is a bit sub-optimal since it produces a pair of false dependency chains. Can we change it to:\n\nconst uint32x4_t _0111 \u003d vextq_u32(vzero, _1111, 3);\nconst uint32x4_t _0011 \u003d vextq_u32(vzero, _1111, 2);\nconst uint32x4_t _0001 \u003d vextq_u32(vzero, _1111, 1);\nconst uint32x4_t _1110 \u003d vextq_u32(_1111, vzero, 1);\nconst uint32x4_t _1100 \u003d vextq_u32(_1111, vzero, 2);\nconst uint32x4_t _1000 \u003d vextq_u32(_1111, vzero, 3);",
      "range": {
        "startLine": 109,
        "startChar": 4,
        "endLine": 114,
        "endChar": 56
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d71c850d_e327800b",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 114,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-11T05:13:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "34085229_63c7a747",
      "range": {
        "startLine": 109,
        "startChar": 4,
        "endLine": 114,
        "endChar": 56
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82444b03_a2124347",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 124,
      "author": {
        "id": 31042
      },
      "writtenOn": "2023-07-10T21:44:48Z",
      "side": 1,
      "message": "I don\u0027t think we can hoist this all the way out here - I\u0027m highly surprised that tests haven\u0027t broken with this change.",
      "range": {
        "startLine": 116,
        "startChar": 4,
        "endLine": 124,
        "endChar": 46
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7d87e76_9ef05e9c",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 124,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-11T05:13:46Z",
      "side": 1,
      "message": "I put it back in the loop and added some prints, and it is indeed the same value. It changes only on every outer loop iteration. I will investigate the original C source to see what the pattern -if any- is there.",
      "parentUuid": "82444b03_a2124347",
      "range": {
        "startLine": 116,
        "startChar": 4,
        "endLine": 124,
        "endChar": 46
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a92ec492_672a1708",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 124,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-11T05:46:38Z",
      "side": 1,
      "message": "I doubled checked, it does produce the exact results as the C/AVX2 version. That is, the elements of the acc_5x5_neon array are the same in all versions (well, C doesn\u0027t use an array, I just printed the results). My worry was that they might be different somehow but because of some shift later the differences might be eliminated. But it\u0027s not, they are the same. So, I think this is actually a correct change, that would perhaps be useful in other ports.",
      "parentUuid": "f7d87e76_9ef05e9c",
      "range": {
        "startLine": 116,
        "startChar": 4,
        "endLine": 124,
        "endChar": 46
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b114f4a_a38b4bea",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 31817
      },
      "writtenOn": "2023-07-11T19:36:01Z",
      "side": 1,
      "message": "assuming that hoisting out the sum is correct, isn\u0027t all of this code redundant now? vsrc isn\u0027t used here...\n\nit feels suspicious that so much code can be eliminated, perhaps it is worth checking the MD5 tests if you haven\u0027t already?",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "839a0c06_29395401",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-11T19:40:04Z",
      "side": 1,
      "message": "I\u0027m running the argon tests on every change, there are thousands of them, and even changing something trivial is usually caught by one of them. This passes the normal tests and the argon tests. I also compared against the C and SSE/AVX2 tests and printed the values of acc_5x5 arrays right after calculations. They were the same.",
      "parentUuid": "0b114f4a_a38b4bea",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ca6e761a_66bfcc82",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-11T20:27:01Z",
      "side": 1,
      "message": "Sorry, I reread what you wrote, you\u0027re right. the tests pass without all this code. Running the argon tests as well to make sure.",
      "parentUuid": "839a0c06_29395401",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "498860e4_53e65f29",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-12T06:57:33Z",
      "side": 1,
      "message": "Argon tests passed as well.",
      "parentUuid": "ca6e761a_66bfcc82",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dedc73a9_ebee7b29",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 5020
      },
      "writtenOn": "2023-07-12T23:27:30Z",
      "side": 1,
      "message": "\u003e Argon tests passed as well.\n\nThe temporal filter is only used on the encode side. Aside from the unit tests you could try comparing encodes with and without the optimization with a non-zero lag-in-frames.",
      "parentUuid": "498860e4_53e65f29",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82445b43_8e880f57",
        "filename": "av1/encoder/arm/neon/highbd_temporal_filter_neon.c",
        "patchSetId": 9
      },
      "lineNbr": 145,
      "author": {
        "id": 32122
      },
      "writtenOn": "2023-07-13T08:02:37Z",
      "side": 1,
      "message": "Sigh, thanks for the pointer. Just tried that, I wish I would have known this earlier, most patchsets fail with different checksums, so will revert to an earlier patchset and fix that to make sure it produces the exact same output.",
      "parentUuid": "dedc73a9_ebee7b29",
      "range": {
        "startLine": 131,
        "startChar": 0,
        "endLine": 145,
        "endChar": 7
      },
      "revId": "651552294dbee050e82d78336a34b20458ea09ce",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}