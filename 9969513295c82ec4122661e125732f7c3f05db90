{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e37b5603_fcf29301",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 716,
      "author": {
        "id": 5960
      },
      "writtenOn": "2021-05-05T01:36:13Z",
      "side": 1,
      "message": "could you add the realtime flag to the existing av1_filter_block_plane_horz function and change the step size for (x) and run aom_lpf_horizontal_ once more in each iteration? It\u0027ll reduce the duplication of code.\n\nSame applies to _vert_ too.",
      "range": {
        "startLine": 716,
        "startChar": 5,
        "endLine": 716,
        "endChar": 35
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "674acf51_561112b2",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 716,
      "author": {
        "id": 10704
      },
      "writtenOn": "2021-05-05T01:40:51Z",
      "side": 1,
      "message": "It will reduce code duplication, yes. The problem is: I tired it and the extra check within the most inner loop basically reduce speed up to almost unnoticeable...\nSo, the plan here is to work on these _rt functions further - I will create new  filtering functions that will work on 8 rows/columns rather than call current sse functions twice.",
      "parentUuid": "e37b5603_fcf29301",
      "range": {
        "startLine": 716,
        "startChar": 5,
        "endLine": 716,
        "endChar": 35
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "16bf16d7_95ac12a8",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 716,
      "author": {
        "id": 10704
      },
      "writtenOn": "2021-05-05T01:49:32Z",
      "side": 1,
      "message": "The other way would be to use function pointers. But I don\u0027t see we are using it too much for such problems... and it will not resolve code duplication, just will make calling less ugly...",
      "parentUuid": "674acf51_561112b2",
      "range": {
        "startLine": 716,
        "startChar": 5,
        "endLine": 716,
        "endChar": 35
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2b1aa904_06bfc555",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 716,
      "author": {
        "id": 10704
      },
      "writtenOn": "2021-05-06T16:39:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "16bf16d7_95ac12a8",
      "range": {
        "startLine": 716,
        "startChar": 5,
        "endLine": 716,
        "endChar": 35
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc4257de_c6b56290",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 761,
      "author": {
        "id": 6585
      },
      "writtenOn": "2021-05-05T03:43:54Z",
      "side": 1,
      "message": "Could you try to replace these two function calls with\naom_lpf_vertical_4_dual?\n\nI have a similar CL: https://aomedia-review.googlesource.com/c/aom/+/136504\nBut I got unit tests failure.\n\nI think the \"aom_xx_dual\" function could be faster.\nAt the same time I\u0027m not sure if they are the cause of test failures.",
      "range": {
        "startLine": 759,
        "startChar": 10,
        "endLine": 761,
        "endChar": 30
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c41067f_325fd25e",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 761,
      "author": {
        "id": 10704
      },
      "writtenOn": "2021-05-05T06:17:33Z",
      "side": 1,
      "message": "Thanks Cheng, I\u0027ll try tomorrow. I noticed that in you CL (looks very similar to this one indeed) you are setting is_realtime on decoder side. I think this is not correct, because on decoder we can not guarantee that there will be no 4x4 transforms.",
      "parentUuid": "cc4257de_c6b56290",
      "range": {
        "startLine": 759,
        "startChar": 10,
        "endLine": 761,
        "endChar": 30
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52e7f08d_24a5b5cb",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 761,
      "author": {
        "id": 10704
      },
      "writtenOn": "2021-05-06T02:09:54Z",
      "side": 1,
      "message": "Cheng, I\u0027ve tried using _dual and it seems it works. Let\u0027s see how the tests pass. I don\u0027t see too much of difference in perf though - it is still 2-3%.",
      "parentUuid": "3c41067f_325fd25e",
      "range": {
        "startLine": 759,
        "startChar": 10,
        "endLine": 761,
        "endChar": 30
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f1f8396e_8bde63b9",
        "filename": "av1/common/av1_loopfilter.c",
        "patchSetId": 4
      },
      "lineNbr": 761,
      "author": {
        "id": 6585
      },
      "writtenOn": "2021-05-06T04:47:48Z",
      "side": 1,
      "message": "Thanks for the test.\nThe cl looks good to me. Thanks for figuring this out.\n\nBeyond this cl, I am not sure why these dual functions do not improve speed. That\u0027s what I mentioned, I am not very certain how the SIMD implementations work in AV1 as compared with VP9.",
      "parentUuid": "52e7f08d_24a5b5cb",
      "range": {
        "startLine": 759,
        "startChar": 10,
        "endLine": 761,
        "endChar": 30
      },
      "revId": "9969513295c82ec4122661e125732f7c3f05db90",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}