{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5ba375db_5b392475",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 31592
      },
      "writtenOn": "2023-07-04T10:36:45Z",
      "side": 1,
      "message": "This CL adds AVX2 intrinsic for the `av1_nn_predict()` function and also improves the unit test for better test coverage.\nAs the intrinsic optimization uses floating point operations, outputs are not expected to be the same as C reference. The mismatch is mainly caused by change in order of floating point operations implemented using SIMD instructions. However, we ensured that the error is within the allowed threshold `epsilon \u003d 1e-3f` as set in the unit test. Same threshold is being used in the parent version to test the SSE3 intrinsic.\n\nThe below shows the module level scaling for some of the possible/frequently occurred test cases of encoder. For this AVX2, average ~36% improvements in the scaling number is seen w.r.t. SSE3.\n```\n               Scaling w.r.t. C(x)\nTest-case        SSE3     AVX2\n37x16x24x1       0.98x    3.26x\n24x12x24         2.86x    3.17x\n10x64x16         1.81x    3.53x\n12x32x1          2.45x    2.58x\n18x24x4          0.86x    2.45x\n4x16x1           1.99x    1.55x\n8x16x4           2.05x    2.71x\n8x32x1           2.36x    3.46x\n9x32x3           1.01x    2.04x\n8x8              1.65x    2.10x\n```\n \nThe Borg test results for good encoding mode are below.\n```\n                 Instruction Count        BD-Rate Loss(%)\ncpu   Resolution   Reduction(%)    avg.psnr   ovr.psnr  ssim   \n 5       LOWRES2     0.489         0.0020     0.0010    0.0046  \n 5       MIDRES2     0.418        -0.0023    -0.0024   -0.0021  \n 5        HDRES2     0.365        -0.0074    -0.0156    0.0025  \n 5       Average     0.424        -0.0026    -0.0057    0.0017  \n\n 6       LOWRES2     0.461        -0.0048    -0.0034    0.0129  \n 6       MIDRES2     0.459         0.0024     0.0030    0.0030  \n 6        HDRES2     0.447         0.0030     0.0013    0.0024  \n 6       Average     0.456         0.0002     0.0003    0.0061 \n```\n\nIn the commit message:\n[-] sign indicates encode time increase\n[+] sign indicates encode time reduction\n\nThe instruction count reduction specified has been measured using command:\n`$ perf stat -e instructions:u ./aomenc`",
      "revId": "7f2048be469861ec056ea4d0f577481727143267",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}