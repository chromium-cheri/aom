{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "82e4160c_e411255e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-09T15:52:07Z",
      "side": 1,
      "message": "In this CL, we introduced a speed feature `prune_rect_part_using_none_pred_mode` to prune horizontal and vertical partitions. As per the analysis, we observed that the prediction mode chosen for NONE partition correlates with the evaluation of rectangular partitions. The accurate logic used to prune rectangular partitions seems to depend on the nature of prediction mode chosen for NONE and neighbor blocks information. If the prediction mode chosen for NONE partitions is\nDC_PRED or SMOOTH_PRED: It indicates that the current block has lesser variation. In this case, HORZ and VERT partitions are pruned if at least one of the left and top neighbor blocks are larger than the current block.\nDirectional Mode: Prunes either of the HORZ and VERT partitions based on the center angle of the prediction mode chosen by NONE partition. For example, the vertical partition is pruned if the center angle of the prediction mode chosen by NONE partition is close to the 180 degrees (i.e. horizontal direction) and vice versa. \n\nThough the sf is enabled for speed presets \u003e\u003d6, it is applicable for only speed\u003d6. For speeds \u003e\u003d7, variance based partition logic is used to decide partition structure and the current logic will not be invoked. \n\nFor AVIF still-image encode with tune\u003dssim,\n```\n               Encode Time             BD-Rate Loss(%)\ncpu-used       Reduction(%)            psnr          ssim\n    6            4.439                 0.1508        0.2304\n```\nFollowing are the instruction count reduction results when libaom allintra frame encoding (50 frames) was tested for a borg setup:\n```\n               Instruction Count       BD-Rate Loss(%)\ncpu-used       Reduction(%)            psnr        ssim\n    6            5.094                 0.2215      0.3247\n```\nFor libaom AV1 video encode, bit-match is verified (w.r.t. parent commit) for \u0027GOOD\u0027 and \u0027RT\u0027 encoding modes for a few contents with different encoding configurations. It is verified that the CL is bit-exact for allintra encode, speed \u003e 6, with no speed impact.\n\nLibavif commit used for testing: `15fa36c4c1b1beb409ec7ef44e41fadf8a38b944`",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf91c2da_d1014afd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T02:09:06Z",
      "side": 1,
      "message": "Hi Apurve,\n\nI will review this CL tomorrow (Wednesday). Sorry about the delay.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9cfd1a03_e7e77d45",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "LGTM. I\u0027m sorry I wrote many comments. Most of them are simple comment fixes.\n\nTwo of the comments, marked as optional, are requests for explanation/rationale for this speed feature.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d260a50b_a8319c2b",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4236,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: are \u003d\u003e is\n\nAlso remove \"that of\". I guess \"that\" is intended to refer to the area, but the word \"area\" is not in this sentence.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff02d978_8ff98c0e",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4236,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d260a50b_a8319c2b",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9db6d16_5414dfd7",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4237,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: `bool` is already used in this file. I suggest replacing `int` with `bool`. Remember to change \"1\" and \"0\" in the comment to \"true\" and \"false\".",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "68ee95d4_2b7ccf71",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4237,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f9db6d16_5414dfd7",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d1a93ff_64b4cfbe",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4238,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: Change `MACROBLOCKD *const xd` to `const MACROBLOCKD *xd`\n\nNote: The use of `const` on a pointer parameter is common in libaom, but it is not useful because functions rarely modify their pointer parameters. Here it is more useful to use `const` on `MACROBLOCKD`.\n\nNo need to say `const MACROBLOCKD *const xd` -- too verbose.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "657c5d20_d0510ed0",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4238,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8d1a93ff_64b4cfbe",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f27de620_585a86ad",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4257,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Optional: It would be helpful to explain why horizontal or vertical partiion is pruned in each case.\n\nYou can adapt the following from your message:\n\n\u003e we observed that the prediction mode chosen for NONE partition correlates with the evaluation of rectangular partitions. The accurate logic used to prune rectangular partitions seems to depend on the nature of prediction mode chosen for NONE and neighbor blocks information.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2ce79916_7485a339",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4257,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "The following comments have been revised with the provided suggestion.",
      "parentUuid": "f27de620_585a86ad",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f164de98_bfa7a06a",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4258,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: Change `MACROBLOCKD *const xd` to `const MACROBLOCKD *xd`",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6109f947_c1aaa5f5",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4258,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f164de98_bfa7a06a",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d58fadc1_625263ba",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4262,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: lesser \u003d\u003e less",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8f52a75_4a9892a9",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4262,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d58fadc1_625263ba",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "48c071bb_78e1c8ae",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4264,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: are \u003d\u003e is",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "79ab48ff_0f46006f",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4264,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "48c071bb_78e1c8ae",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26425ae8_13369b03",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4271,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: remove \"the\"",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c11aec5c_3adba623",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4271,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "26425ae8_13369b03",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7be8acd3_ee39a886",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4275,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: remove \"the\"",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d9643d74_7a12518d",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 2
      },
      "lineNbr": 4275,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "7be8acd3_ee39a886",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "311b2adb_a1e93fc9",
        "filename": "av1/encoder/speed_features.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Set `sf-\u003epart_sf.prune_rect_part_using_none_pred_mode` to true after this line, to match the declaration order of the fields in the struct.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9bd1339f_93d98ca2",
        "filename": "av1/encoder/speed_features.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "311b2adb_a1e93fc9",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39cfbf90_d47cafe8",
        "filename": "av1/encoder/speed_features.c",
        "patchSetId": 2
      },
      "lineNbr": 2002,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Set `part_sf-\u003eprune_rect_part_using_none_pred_mode` after this line, to match the declaration order of these fields in the struct.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4bcf2c27_b73b3f42",
        "filename": "av1/encoder/speed_features.c",
        "patchSetId": 2
      },
      "lineNbr": 2002,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39cfbf90_d47cafe8",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f8e96084_51dcd101",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 724,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Optional: It would be helpful to explain (somewhere, not necessarily here) why the pruning decision is based on the NONE prediction mode.\n\nYou can adapt the following from your message:\n\n\u003e we observed that the prediction mode chosen for NONE partition correlates with the evaluation of rectangular partitions. The accurate logic used to prune rectangular partitions seems to depend on the nature of prediction mode chosen for NONE and neighbor blocks information.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b10730ce_0b86af53",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 724,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "We have provided more detailed comments in the function (prune_rect_part_using_none_pred_mode) (line no:4270).",
      "parentUuid": "f8e96084_51dcd101",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c1b9c034_0af35d17",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 724,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-14T23:09:40Z",
      "side": 1,
      "message": "Thank you.",
      "parentUuid": "b10730ce_0b86af53",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0b40423_5a976cb7",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 734,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "Nit: delete \"the\"",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff964c88_5dec4d2a",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 734,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b0b40423_5a976cb7",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a98487f8_7be8d2a2",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 740,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-13T21:44:29Z",
      "side": 1,
      "message": "I am curious why this speed feature is not applicable to speed \u003e\u003d 7. Is it because `none_partition_search()` is not called for speed \u003e\u003d 7?\n\nYou can adapt the following from your message:\n\n\u003e Though the sf is enabled for speed presets \u003e\u003d6, it is applicable for only speed\u003d6. For speeds \u003e\u003d7, variance based partition logic is used to decide partition structure and the current logic will not be invoked.",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26acdaa7_9bc43945",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 740,
      "author": {
        "id": 31322
      },
      "writtenOn": "2023-12-14T15:53:36Z",
      "side": 1,
      "message": "Yes. For speed \u003e\u003d 7, variance based logic is used to decide partition structure and none_partition_search() is not called. Hence, this speed feature is not applicable.",
      "parentUuid": "a98487f8_7be8d2a2",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "72a80b20_20aaf3d2",
        "filename": "av1/encoder/speed_features.h",
        "patchSetId": 2
      },
      "lineNbr": 740,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-12-14T23:09:40Z",
      "side": 1,
      "message": "Thank you.",
      "parentUuid": "26acdaa7_9bc43945",
      "revId": "eeb6f98e82c7378fe5f654cc89887db542adef71",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}