{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e0a76557_671ef8af",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-06T19:56:18Z",
      "side": 1,
      "message": "I tested this manually, found one issue/unexpected setting noted above. Otherwise seems fine (for one_pass CBR only and single layer). Not sure what unittests we can add for this...",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4ac3dafb_8b7929ea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-06-06T20:02:53Z",
      "side": 1,
      "message": "add a unit test in datarate_test.cc using this API?",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee1e59c5_af518cbd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-06-06T20:04:30Z",
      "side": 1,
      "message": "For example, running encoder at 100k and then change to 200k in the middle, the final bitrate should be around 150k?",
      "parentUuid": "4ac3dafb_8b7929ea",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "208d1c7b_c846b103",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "Marco: I suggest some changes.",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cfa9a8fc_172f01c4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-06T21:00:01Z",
      "side": 1,
      "message": "would prefer to run stronger test: encode two sequences with dynamic bitrate, one sequence with the new control, the other with aom_codec_enc_config_set, and then check if they are bitexact.",
      "parentUuid": "ee1e59c5_af518cbd",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81333659_0a15dd9c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-06-07T14:05:43Z",
      "side": 1,
      "message": "I agree, that\u0027s better and less flaky.",
      "parentUuid": "cfa9a8fc_172f01c4",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5def3487_6e07924b",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 1524,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-06-06T20:02:53Z",
      "side": 1,
      "message": "remove this extra line",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "72e912a3_66c73f4b",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 1524,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5def3487_6e07924b",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de719d54_38307585",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 1525,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "Move this line above line 1521 (note what that comment says).\n\nThis new codec control should be documented. Lines 1484-1489 can be used as an example. The comment should say the bitrate is in kilobits per second.",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dc03fbf3_7641118b",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 1525,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "de719d54_38307585",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5ea93b95_a8866391",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 2165,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "Nit: Use the `unsigned int` type instead? I believe this is to replace the following field in the encoder config:\n\n```\n  /*!\\brief Target data rate\n   *\n   * Target bitrate to use for this stream, in kilobits per second.\n   */\n  unsigned int rc_target_bitrate;\n```",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "256a3ccb_63ad36b0",
        "filename": "aom/aomcx.h",
        "patchSetId": 3
      },
      "lineNbr": 2165,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5ea93b95_a8866391",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d6e3c08_4e206295",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2566,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "Replace this assertion with error checking. We can return AOM_CODEC_INVALID_PARAM if this condition is false.\n\nAlso, as we discussed in person, we need to check cpi-\u003eppi-\u003euse_svc.",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b027ed85_8cbbb6bd",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2566,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T21:34:08Z",
      "side": 1,
      "message": "One more thing: This function assumes there is only one cpi. But with the \"FPMT\" (frame parallel multithreading) feature and the \"cpi_lap\", there may be other cpi\u0027s that we need to update. For example, `encoder_set_config()` has the following code:\n\n```\n    for (int i \u003d 0; i \u003c ctx-\u003eppi-\u003enum_fp_contexts; i++) {\n      av1_change_config(ctx-\u003eppi-\u003eparallel_cpi[i], \u0026ctx-\u003eoxcf,\n                        is_sb_size_changed);\n    }\n    if (ctx-\u003eppi-\u003ecpi_lap !\u003d NULL) {\n      av1_change_config(ctx-\u003eppi-\u003ecpi_lap, \u0026ctx-\u003eoxcf, is_sb_size_changed);\n    }\n```\n\nI think this function needs to check ctx-\u003eppi-\u003enum_fp_contexts \u003d\u003d 1 and ctx-\u003eppi-\u003ecpi_lap \u003d\u003d NULL here.",
      "parentUuid": "6d6e3c08_4e206295",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cacdb997_04ccee37",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2566,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done. Didn\u0027t replace the error checking, how would you like to change it?",
      "parentUuid": "b027ed85_8cbbb6bd",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5ee87385_5a9547e6",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2567,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "We should also set:\n\n```\n  ctx-\u003ecfg.rc_target_bitrate \u003d new_bitrate;\n```\n\nbecause this simpler function should have the same side effects as calling `aom_codec_enc_config_set(\u0026codec, \u0026cfg)` with a new `cfg.rc_target_bitrate` value.",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "22f81801_08a798d7",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2567,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5ee87385_5a9547e6",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c3683b74_4abd2d6d",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2569,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "I think we can use the `ppi` variable (declared at line 2563) instead of `cpi-\u003eppi`.",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a4cdb6bc_c1c20a9a",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2569,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c3683b74_4abd2d6d",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b322a447_60f53dd1",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2570,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-06-06T20:58:53Z",
      "side": 1,
      "message": "The `set_primary_rc_buffer_sizes()` call doesn\u0027t modify `cpi-\u003eframerate`. Do we need to call `av1_new_framerate(cpi, cpi-\u003eframerate)`?",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0c214c48_a878f205",
        "filename": "av1/av1_cx_iface.c",
        "patchSetId": 3
      },
      "lineNbr": 2570,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-06-08T19:22:26Z",
      "side": 1,
      "message": "as we discussed offline, it does.",
      "parentUuid": "b322a447_60f53dd1",
      "revId": "d72340adc0e74097784475130f05ecec190d961c",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}