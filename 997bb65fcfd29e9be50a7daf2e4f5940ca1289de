{
  "comments": [
    {
      "key": {
        "uuid": "a9b71fd2_da251660",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 63,
      "author": {
        "id": 5075
      },
      "writtenOn": "2017-06-21T22:13:21Z",
      "side": 1,
      "message": "As an aside (not related to this patch in particular), I don\u0027t think this code is correct for the case where the current block overlaps the MI grid boundary (same for the height loop below). See the code in build_intra_predictors() that Joe Young pointed to on the mailing list two days ago, and in particular pay attention to the calculation of n_top_px.",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "090237e2_51198e71",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 63,
      "author": {
        "id": 7105
      },
      "writtenOn": "2017-06-30T00:56:18Z",
      "side": 1,
      "message": "Agreed, see https://aomedia-review.googlesource.com/c/14125/",
      "parentUuid": "a9b71fd2_da251660",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df43630b_f3f69291",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 129,
      "author": {
        "id": 5075
      },
      "writtenOn": "2017-06-21T22:13:21Z",
      "side": 1,
      "message": "I think this block needs to be wrapped in a !CONFIG_CHROMA_2X2. I also think you need some tests against subsampling_x and subsampling_y here: e.g., for 4:4:4, this will cause the upper-left luma block of a group of four 4x4 partitions to be used for _all_ of the chroma predictions, since the others will keep getting appended to the current buffer instead of overwriting the upper left.\n\nA comment explaining what is going on here might also be helpful. It took me a while to figure out.",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6fa41b15_e60145a8",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 129,
      "author": {
        "id": 5075
      },
      "writtenOn": "2017-06-21T23:02:43Z",
      "side": 1,
      "message": "If either of the if\u0027s in here are triggered, it might also be a good idea to assert that a) row and/or col are 0 before being incremented, and b) y_width and/or y_height is equal to (col \u003c\u003c tx_off_log2) and/or (row \u003c\u003c tx_off_log2).\n\nThat will catch any changes to the codec that might cause you to append multiple transform blocks along one buffer dimension (which is almost surely an error) or to leave gaps in what is appended (which is certainly an error).",
      "parentUuid": "df43630b_f3f69291",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7de2c3e0_a6172630",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 129,
      "author": {
        "id": 7105
      },
      "writtenOn": "2017-06-30T00:56:18Z",
      "side": 1,
      "message": "Wrapped in CHROMA_SUB8X8\n\nAdded some comments\n\nAdded assert that col and row are 0 \n\nAs for the asserts for y_width and x_width see https://aomedia-review.googlesource.com/c/14281/",
      "parentUuid": "6fa41b15_e60145a8",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09091971_9a013a05",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 212,
      "author": {
        "id": 5075
      },
      "writtenOn": "2017-06-21T22:13:21Z",
      "side": 1,
      "message": "Is it possible to assert that diff_width and diff_height are non-negative? That would have caught the error I described above, where you continue to append luma blocks to the current storage in cfl_store() instead of starting over for sub-8x8 4:4:4 blocks (making the luma area larger than chroma).",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2af51d03_7db9d113",
        "filename": "av1/common/cfl.c",
        "patchSetId": 3
      },
      "lineNbr": 212,
      "author": {
        "id": 7105
      },
      "writtenOn": "2017-06-30T00:56:18Z",
      "side": 1,
      "message": "For asserts that check if luma is greater than chroma see https://aomedia-review.googlesource.com/c/14445/",
      "parentUuid": "09091971_9a013a05",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "82654f74_97d36332",
        "filename": "av1/decoder/decodeframe.c",
        "patchSetId": 3
      },
      "lineNbr": 736,
      "author": {
        "id": 5075
      },
      "writtenOn": "2017-06-21T22:13:21Z",
      "side": 1,
      "message": "Note that since https://aomedia-review.googlesource.com/12308 landed the correct test is now just #if CONFIG_CHROMA_SUB8X8",
      "revId": "997bb65fcfd29e9be50a7daf2e4f5940ca1289de",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}