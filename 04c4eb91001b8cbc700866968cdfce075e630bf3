{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1d9d0940_3c92e35e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9101
      },
      "writtenOn": "2022-09-30T14:03:42Z",
      "side": 1,
      "message": "Hi Yunqing, Marco,\nIn the parent version, reuse of inter predicated samples in encode_b_nonrd() is disallowed for Luma plane if nonrd_check_partition_merge_mode speed feature is enabled. It is due to following scenarios.\n- PARTITION_NONE cannot reuse predicted sample as while evaluating PARTITION_SPLIT the predicted sample is overwritten\n- Predicted samples generated by encode_b_nonrd() call cannot reuse across DRY_RUN_NORMAL and OUTPUT_ENABLED modes as after the function call the buffer holds reconstructed samples\n\nThis patch enables reuse of inter predicated samples in encode_b_nonrd() by appropriately handling the above two scenarios. Once the patch is merged we are planning to study the possibility of reusing the predicted sample across DRY_RUN_NORMAL and OUTPUT_ENABLED modes (scenario 2).\n\nThis patch impacts RT speed 7 as the nonrd_check_partition_merge_mode speed feature is enabled for the speed level.\nPlease check the BORG test results for the RT preset.\n```\n               Instruction Count        BD-Rate Loss(%)\ncpu   Testset   Reduction(%)    avg.psnr   ovr.psnr    ssim\n 7        rtc      0.896         0.0000     0.0000    0.0000\n 7   rtc_derf      1.027         0.0000     0.0000    0.0000\n```\nIn the commit message:\n[-] sign indicates encode time increase\n[+] sign indicates encode time reduction\n\nThe instruction count reduction specified has been measured using command:\n`$ perf stat -e instructions:u ./aomenc`\n\nWe ensured that the change is bit-exact for RT and Good presets.\nPlease review the patch.\n\nThank you.",
      "revId": "04c4eb91001b8cbc700866968cdfce075e630bf3",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c1e87b69_f28705a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2022-09-30T21:22:53Z",
      "side": 1,
      "message": "Nice speedup without any BDrate loss!",
      "revId": "04c4eb91001b8cbc700866968cdfce075e630bf3",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2852e9d2_dafb662f",
        "filename": "av1/encoder/partition_search.c",
        "patchSetId": 1
      },
      "lineNbr": 456,
      "author": {
        "id": 5185
      },
      "writtenOn": "2022-09-30T21:22:53Z",
      "side": 1,
      "message": "cpi-\u003esf.rt_sf.reuse_inter_pred_nonrd is also used in av1_nonrd_pick_inter_mode_sb(). Does anything need to be done there (e.g. using x-\u003ereuse_inter_pred)?",
      "range": {
        "startLine": 456,
        "startChar": 9,
        "endLine": 456,
        "endChar": 28
      },
      "revId": "04c4eb91001b8cbc700866968cdfce075e630bf3",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}