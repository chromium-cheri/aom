{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "908f9cac_398b3180",
        "filename": "av1/encoder/aq_cyclicrefresh.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-01-04T00:29:06Z",
      "side": 1,
      "message": "I don\u0027t quite understand how this flag is set \u0026 used...\n\nIt\u0027s set to number of spatial layers when encoding the top spatial layer.\n\nSo right after the number of spatial layer is changed (for example, from 3 -\u003e 2) this condition is not true for SL0 (number_spatial_layers \u003d 2, but prev_ \u003d 3). It\u0027ll be true at SL1, so cyclic_refresh map is reset and resized.\n\nSo this condition just guarantee that av1_cyclic_refresh_reset_resize() is only called on top spatial layer when # of spatial layers changed?",
      "range": {
        "startLine": 516,
        "startChar": 15,
        "endLine": 516,
        "endChar": 41
      },
      "revId": "084c952b38e6639bd30ee0275609186bd99f4e13",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7fac6679_656780b9",
        "filename": "av1/encoder/aq_cyclicrefresh.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-01-04T17:14:16Z",
      "side": 1,
      "message": "The flag indicates if the number of spatial layers has changed. Its set after encoding the whole superframe (at end of encoding of last spatial layer).\n\nSo right after 3-\u003e2, the condition (#spatial layers has changed) is true for both SLO and SL1 (since its set at end of encoding current superframe).\n\nThere is cyclic refresh running for each spatial layer, so if number of spatial layers has changed we should reset the CRD (to avoid for example having a QVGA SL0 CR continuing into a VGA SLO CR).",
      "parentUuid": "908f9cac_398b3180",
      "range": {
        "startLine": 516,
        "startChar": 15,
        "endLine": 516,
        "endChar": 41
      },
      "revId": "084c952b38e6639bd30ee0275609186bd99f4e13",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb4f3323_3abd7f92",
        "filename": "av1/encoder/aq_cyclicrefresh.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 5960
      },
      "writtenOn": "2023-01-05T15:25:13Z",
      "side": 1,
      "message": "\u003e The flag indicates if the number of spatial layers has changed. Its set after encoding the whole superframe (at end of encoding of last spatial layer).\n\u003e \n\u003e So right after 3-\u003e2, the condition (#spatial layers has changed) is true for both SLO and SL1 (since its set at end of encoding current superframe).\n\u003e \n\nHow is this condition true after the # of spatial layers changed from 3-\u003e2? prev_number_spatial_layers would be 3, but number_spatial_layers would be 2? right?\n\n\u003e There is cyclic refresh running for each spatial layer, so if number of spatial layers has changed we should reset the CRD (to avoid for example having a QVGA SL0 CR continuing into a VGA SLO CR).",
      "parentUuid": "7fac6679_656780b9",
      "range": {
        "startLine": 516,
        "startChar": 15,
        "endLine": 516,
        "endChar": 41
      },
      "revId": "084c952b38e6639bd30ee0275609186bd99f4e13",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9409355b_0d1db84e",
        "filename": "av1/encoder/aq_cyclicrefresh.c",
        "patchSetId": 2
      },
      "lineNbr": 516,
      "author": {
        "id": 5190
      },
      "writtenOn": "2023-01-05T17:50:26Z",
      "side": 1,
      "message": "Which condition are you referring to? I mean the condition \"number of spatial layers has changed\" is true for all spatial layers of superframe after 3-\u003e2. So \"cpi-\u003esvc.prev_number_spatial_layers \u003d\u003d cpi-\u003esvc.number_spatial_layers\" is false.",
      "parentUuid": "cb4f3323_3abd7f92",
      "range": {
        "startLine": 516,
        "startChar": 15,
        "endLine": 516,
        "endChar": 41
      },
      "revId": "084c952b38e6639bd30ee0275609186bd99f4e13",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}