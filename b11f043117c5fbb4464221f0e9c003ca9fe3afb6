{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e71e9431_d0c13a5c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 16,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "Nit: I am wondering if you meant to use a colon (:) at the end of this line. Should that be a period (.)?",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f3f35cf5_f26f3fa5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 16,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T14:12:16Z",
      "side": 1,
      "message": "Good point. I\u0027ve reworded the commit message a bit, to hopefully be a bit clearer.",
      "parentUuid": "e71e9431_d0c13a5c",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1b50e830_6a6b7db1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "LGTM. I suggest some small changes. I also have some questions because I am curious about your solution.",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc633203_075f89c8",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 333,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "I am curious why this technique is called (weak) regularization.",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7672206_b73ad5d3",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 333,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T14:12:16Z",
      "side": 1,
      "message": "\"Regularization\" is a fairly standard term, and means something to the effect of \"making the problem better behaved\" or \"changing the problem from a special case to a more general case\".\n\nIn this case, the special case we want to avoid is det M \u003d 0, and the regular case is det M !\u003d 0. The implementation here, by adding a small value to the diagonal elements of M, is an extremely common way to do this for least squares problems.",
      "parentUuid": "dc633203_075f89c8",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d8c8bc0_6acb7f59",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 333,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-22T17:20:03Z",
      "side": 1,
      "message": "Thank you for the explanation.",
      "parentUuid": "f7672206_b73ad5d3",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ece5f3ec_56397bbc",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 335,
      "author": {
        "id": 7525
      },
      "writtenOn": "2023-02-21T22:57:05Z",
      "side": 1,
      "message": "Q: How was this regularization term determined? Just wondering what are the usual ranges of tmp array, as 1.0 seems pretty big for regularization purposes.",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 335,
        "endChar": 13
      },
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "858e50be_1d865719",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 335,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T14:12:16Z",
      "side": 1,
      "message": "The values in the tmp matrix are actually all integers, and overall have a pretty big scale - the dx and dy arrays hold 8 * the image gradient, but limited to the range [-1020, 1020] due to how we calculate them. So a typical value for M[0] is on the order of 1e5 to 1e6 or so, with a maximum possible value of 64 * 1020 * 1020.\n\nSo adding 1 is actually a very small regularization here.\n\nIn fact, the original broken code had logic to the effect of \"if det M \u003d 0, add 1e-10 to the diagonal elements and try again\", but even in double precision that was underflowing so that it had no effect.",
      "parentUuid": "ece5f3ec_56397bbc",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 335,
        "endChar": 13
      },
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6cf82da2_e9b9afed",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 335,
      "author": {
        "id": 7525
      },
      "writtenOn": "2023-02-22T20:52:46Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "858e50be_1d865719",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 335,
        "endChar": 13
      },
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dfe598cd_10e31971",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 366,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "I am not familiar with least squares systems. Is this a well-known theorem?",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0353e477_b6158a65",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 366,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T14:12:16Z",
      "side": 1,
      "message": "This is an extremely common method of regularization, and it kind of relies on what I\u0027m saying here being true. But I\u0027m not sure how well known the actual proof is. On the other hand, the actual proof is quite long and technical. So I\u0027m not sure it\u0027s useful to add a comment explaining it, especially as it\u0027s a standard method.\n\nHowever, maybe I should add some more comments to just tell readers that we\u0027re using this method of regularization as opposed to any other method?",
      "parentUuid": "dfe598cd_10e31971",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db85e659_2ee8f28b",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 366,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-22T17:20:03Z",
      "side": 1,
      "message": "I was only wondering about the `det M \u003e\u003d 0` part.\n\nI think I would appreciate some more comments, but I understand we shouldn\u0027t get too verbose here. Maybe your comments can target a reader whose knowledge of this is halfway between Bohan and me.",
      "parentUuid": "0353e477_b6158a65",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47056b55_05394a62",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 366,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T17:36:19Z",
      "side": 1,
      "message": "I\u0027ve written new comments at the point where we add the regularization and in invert_2x2(). Please can you let me know what you think now?",
      "parentUuid": "db85e659_2ee8f28b",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "22304a51_c0738adb",
        "filename": "aom_dsp/flow_estimation/disflow.c",
        "patchSetId": 1
      },
      "lineNbr": 368,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "I can prove this follows from the above.",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b082086c_507a9a82",
        "filename": "aom_dsp/flow_estimation/x86/disflow_sse4.c",
        "patchSetId": 1
      },
      "lineNbr": 464,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-02-17T22:15:12Z",
      "side": 1,
      "message": "Nit: Also add the comment:\n```\n  // This helps to avoid situations where det M \u003d 0\n```\n\nIn case we ever remove the `#if CHECK_RESULTS` block of code below, this comment will still be complete.",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "30a43c5c_24dffbea",
        "filename": "aom_dsp/flow_estimation/x86/disflow_sse4.c",
        "patchSetId": 1
      },
      "lineNbr": 464,
      "author": {
        "id": 29052
      },
      "writtenOn": "2023-02-22T14:12:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b082086c_507a9a82",
      "revId": "b11f043117c5fbb4464221f0e9c003ca9fe3afb6",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}