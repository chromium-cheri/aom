{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0fbf63b5_f3a835b9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 14993
      },
      "writtenOn": "2021-04-20T15:23:24Z",
      "side": 1,
      "message": "Hi Wan-Teh,\n\nThis CL optimizes the memory allocation of pixel_gradient_info by not allocating the same for chroma in case of monochrome.\n\nWe had also thought of an alternate approach by declaring pixel_gradient_info[PLANE_TYPES] and doing the memory allocation in a for loop with AOMMIN(num_planes, PLANE_TYPES) iterations. We preferred the current approach as the code change is minimal and cleaner.\n\nThis change is verified to be bit-exact for image and video encoding. We also validated that the memory reduction for monochrome all-intra encoding is as below:\n\n                  Memory reduction (%)\n Resolution     threads\u003d1      threads\u003d2\n    360p          0.3112         0.5939\n    480p          0.1873         0.3267\n\nHEAP memory reduction was measured using the command below.\n$valgrind --tool\u003dmassif ./aomenc ...\n\nPlease review.\n\nRegards,\nJayasanker.",
      "revId": "74ab1e70910eb5cc15a2510a8fc2fb69b92f9178",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7d782323_d2fa950c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-04-20T19:03:56Z",
      "side": 1,
      "message": "Jayasanker: Thank you for the CL! I suggest a small change.",
      "revId": "74ab1e70910eb5cc15a2510a8fc2fb69b92f9178",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ca8855a7_c0bb71fe",
        "filename": "av1/encoder/encoder.c",
        "patchSetId": 1
      },
      "lineNbr": 727,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-04-20T19:03:56Z",
      "side": 1,
      "message": "I suggest declaring a local variable \u0027plane_types\u0027 to make this clearer:\n\n    int plane_types \u003d PLANE_TYPES \u003e\u003e cm-\u003eseq_params.monochrome;\n    CHECK_MEM_ERROR(cm, x-\u003epixel_gradient_info,\n                    aom_malloc(sizeof(*x-\u003epixel_gradient_info) * plane_types *\n                               MAX_SB_SQUARE));",
      "revId": "74ab1e70910eb5cc15a2510a8fc2fb69b92f9178",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f3e9a0ff_36294342",
        "filename": "av1/encoder/encoder.c",
        "patchSetId": 1
      },
      "lineNbr": 727,
      "author": {
        "id": 14993
      },
      "writtenOn": "2021-04-21T14:09:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ca8855a7_c0bb71fe",
      "revId": "74ab1e70910eb5cc15a2510a8fc2fb69b92f9178",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}