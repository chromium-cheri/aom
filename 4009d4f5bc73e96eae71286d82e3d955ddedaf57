{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "05f46374_de584e7e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-10-29T16:15:31Z",
      "side": 1,
      "message": "This should be updated because we also initialize fwd_offset and bck_offset now.",
      "revId": "4009d4f5bc73e96eae71286d82e3d955ddedaf57",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c3cabe0_f72af2d9",
        "filename": "av1/common/convolve.h",
        "patchSetId": 5
      },
      "lineNbr": 106,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-10-29T16:15:31Z",
      "side": 1,
      "message": "Hmm... this is less readable than the previous version (patchset 4) because it is not clear which struct members these initializers correspond to. (This struct has 10 members.) It is also error-prone if we ever reorder the struct members.\n\nI suggest we go back to patchset 4. I didn\u0027t mean to make you spend too much time on this issue.\n\nIf you prefer this version, we need to delete lines 113-115. They are redundant now.",
      "revId": "4009d4f5bc73e96eae71286d82e3d955ddedaf57",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "897901af_7ce94351",
        "filename": "av1/common/convolve.h",
        "patchSetId": 5
      },
      "lineNbr": 106,
      "author": {
        "id": 5022
      },
      "writtenOn": "2023-10-29T16:20:37Z",
      "side": 1,
      "message": "Done.\n\nThis form seems better to me as it is more likely that the compiler will send warnings if ConvolveParams is changed and the initialization isn\u0027t done accrodingly.",
      "parentUuid": "9c3cabe0_f72af2d9",
      "revId": "4009d4f5bc73e96eae71286d82e3d955ddedaf57",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b05254ab_e4374954",
        "filename": "av1/common/convolve.h",
        "patchSetId": 5
      },
      "lineNbr": 106,
      "author": {
        "id": 9545
      },
      "writtenOn": "2023-10-29T16:54:37Z",
      "side": 1,
      "message": "Let me explain why this form is error-prone with an example. Suppose we move `plane` forward to the front of `round_0` and `round_1`:\n\n```\ndiff --git a/av1/common/convolve.h b/av1/common/convolve.h\nindex 36c0c842bc..73c6c1d93a 100644\n--- a/av1/common/convolve.h\n+++ b/av1/common/convolve.h\n@@ -22,9 +22,9 @@ typedef struct ConvolveParams {\n   int do_average;\n   CONV_BUF_TYPE *dst;\n   int dst_stride;\n+  int plane;\n   int round_0;\n   int round_1;\n-  int plane;\n   int is_compound;\n   int use_dist_wtd_comp_avg;\n   int fwd_offset;\n```\n\nNote that `plane`, `round_0`, and `round_1` have the same type (`int`). So this struct initializer will still compile successfully. But now `round_0` and `round_1` will be initialized incorrectly.\n\nNote: To get the benefit you have in mind, we will need to use \"designated initializers\":\n\n```\n  ConvolveParams conv_params \u003d { .do_average \u003d 0,\n                                 .dst \u003d NULL,\n                                 .dst_stride \u003d 0,\n                                 .round_0 \u003d WIENER_ROUND0_BITS,\n                                 .round_1 \u003d\n                                     2 * FILTER_BITS - WIENER_ROUND0_BITS,\n                                 .plane \u003d 0,\n                                 .is_compound \u003d 0,\n                                 .use_dist_wtd_comp_avg \u003d 0,\n                                 .fwd_offset \u003d 0,\n                                 .bck_offset \u003d 0 };\n```\n\nBUT it gets a compiler warning in Visual C++ when this header is included by our C++ code (e.g., aom/av1/ratectrl_rtc.cc):\n\nC:\\src\\aom.1\\aom\\av1/common/convolve.h(104): error C7555: use of designated initializers requires at least \u0027/std:c++20\u0027",
      "parentUuid": "897901af_7ce94351",
      "revId": "4009d4f5bc73e96eae71286d82e3d955ddedaf57",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b246ce50_f212fbf0",
        "filename": "av1/common/convolve.h",
        "patchSetId": 5
      },
      "lineNbr": 106,
      "author": {
        "id": 5022
      },
      "writtenOn": "2023-10-29T22:22:51Z",
      "side": 1,
      "message": "I was thinking of adding or removing items from the struct but without changing the initial conditions accordingly.",
      "parentUuid": "b05254ab_e4374954",
      "revId": "4009d4f5bc73e96eae71286d82e3d955ddedaf57",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}