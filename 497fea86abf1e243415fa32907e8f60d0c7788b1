{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e5812037_583e6c5d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-08T20:15:04Z",
      "side": 1,
      "message": "The not-as-hacky as I had feared fix appears to work: PTAL/Thx",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3b24b59_fe73ecbf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5020
      },
      "writtenOn": "2022-03-08T21:49:16Z",
      "side": 1,
      "message": "Seems ok with the xcode generator, but I need to test BUILD_SHARED_LIBS\u003d1.",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3fdd545f_15a29d56",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5020
      },
      "writtenOn": "2022-03-08T21:53:05Z",
      "side": 1,
      "message": "\u003e Seems ok with the xcode generator, but I need to test BUILD_SHARED_LIBS\u003d1.\n\nSeems to work.",
      "parentUuid": "d3b24b59_fe73ecbf",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "507f22f4_1e33db55",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2022-03-09T01:58:52Z",
      "side": 1,
      "message": "Tom: Thank you for the fix. I suggest some changes.",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b02e57d_f286bc30",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-09T03:28:37Z",
      "side": 1,
      "message": "Thanks for checking Xcode-- I didn\u0027t get around to it.\n\n@wtc @jianj: Any questions/concerns before I land this?",
      "parentUuid": "3fdd545f_15a29d56",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d372299_39614a8f",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 154,
      "author": {
        "id": 9545
      },
      "writtenOn": "2022-03-09T01:58:52Z",
      "side": 1,
      "message": "Nit: If we move this line before line 148, we can use the asm_lib_name variable in line 149:\n\n    set(asm_lib_obj_dir\n        \"${AOM_CONFIG_DIR}/asm_objects/${asm_lib_name}\")",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86174eda_14ee6aae",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 154,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-09T03:28:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6d372299_39614a8f",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dfbfcfb8_f63afdfc",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 9545
      },
      "writtenOn": "2022-03-09T01:58:52Z",
      "side": 1,
      "message": "Optional: I found that this library is created but never used. We can delete it safely.\n\nAlso, this library seems to be created incorrectly. Here is the command:\n\n/usr/bin/ar qc libaom_dsp_encoder_sse2_static.a CMakeFiles/aom_dsp_encoder_sse2_static.dir/gen_src/aom_dsp_encoder_sse2_static_dummy.c.o\n\nNote that it contains only the dummy object file and not any of the asm object files.\n\nWe can delete this library in a separate CL.",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8914d28_15567c3b",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-09T03:28:37Z",
      "side": 1,
      "message": "That library, aom_dsp_encoder_sse2_static, while a dummy in and of itself, exists to give a single sensible home for the ASM files-- its reasons for existence are: \n\n- legacy: this was all built on top of the libvpx build system that was originally carried over to libaom when the project started, and that\u0027s the way the old build system grouped the sources.\n- convenience: AOM_DSP_ENCODER_ASM_SSE2 source list members reside within the IDE folders created for \"libraries\" aom_dsp_encoder_sse2_static and aom_dsp_encoder_sse2_shared when using multi-config generators like MSVC and Xcode.\n\nHere\u0027s some grepping for illustrative purposes:\n\n    $ git grep aom_dsp_encoder_sse2\n    aom_dsp/aom_dsp.cmake:391:      add_asm_library(\"aom_dsp_encoder_sse2\" \"AOM_DSP_ENCODER_ASM_SSE2\")\n    \n    $ git grep -C 5 -n AOM_DSP_ENCODER_ASM_SSE2\n    aom_dsp/aom_dsp.cmake:204:  list(APPEND AOM_DSP_ENCODER_ASM_SSE2\n    aom_dsp/aom_dsp.cmake-205-              \"${AOM_ROOT}/aom_dsp/x86/highbd_sad4d_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-206-              \"${AOM_ROOT}/aom_dsp/x86/highbd_sad_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-207-              \"${AOM_ROOT}/aom_dsp/x86/highbd_subpel_variance_impl_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-208-              \"${AOM_ROOT}/aom_dsp/x86/highbd_variance_impl_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-209-              \"${AOM_ROOT}/aom_dsp/x86/sad4d_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-210-              \"${AOM_ROOT}/aom_dsp/x86/sad_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-211-              \"${AOM_ROOT}/aom_dsp/x86/subpel_variance_sse2.asm\"\n    aom_dsp/aom_dsp.cmake-212-              \"${AOM_ROOT}/aom_dsp/x86/subtract_sse2.asm\")\n    \nApologies for the formatting-- it\u0027s a bit difficult to make the above come out cleanly in the comment box. But, anyway, none of this seems worth the noise in a make build and the above hopefully explains why it\u0027s there for the other types of generated builds.\n\nAll of the files in the list above are actually added to the library, but because CMake doesn\u0027t know what .asm files are without enabling assembly explicitly within the CMake project() command (our call to project() resides in CMakeLists.txt), no build rules are actually generated for the .asm files as part of the library build step eventually generated by CMake for the AOM build.\n\nWith all of that said it has become clear in the intervening time that I may have been able to go a step further-- the dummy sources and empty C libraries may not be necessary at all as the really important part here is the following sequence that occurs for each ASM file and its output object file within the inner loop:\n\n  1) Create custom rule for ASM source.\n  2) Make the assembler output file a source file of the target that actually depends on it.\n    - Note that with these changes it\u0027s always aom in static builds, or aom and aom_static in BUILD_SHARED_LIBS configurations.\n\nI just wouldn\u0027t bet on being able to perform the removal successfully-- I vaguely recall trying to do so in the past, and hitting a wall with one of the \"fun\" generators. Either MSVC or Xcode would not play nice in some fashion.",
      "parentUuid": "dfbfcfb8_f63afdfc",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "77d61bdc_58ace4e7",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 170,
      "author": {
        "id": 9545
      },
      "writtenOn": "2022-03-09T01:58:52Z",
      "side": 1,
      "message": "Instead of\n\n    \"${asm_object}\" MATCHES \"static\"\n    \nit is more direct to test\n\n    \"${asm_config}\" STREQUAL \"static\"\n\nThe current test will malfunction if the asm source file name happens to contain \"static\".",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b236d40b_0dbfb4ae",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 170,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-09T03:28:37Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "77d61bdc_58ace4e7",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6310f9d3_3b112dcf",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 9545
      },
      "writtenOn": "2022-03-09T01:58:52Z",
      "side": 1,
      "message": "Can this be moved outside the for loop?",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cee60514_514da26c",
        "filename": "build/cmake/aom_optimization.cmake",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 5215
      },
      "writtenOn": "2022-03-09T03:28:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6310f9d3_3b112dcf",
      "revId": "497fea86abf1e243415fa32907e8f60d0c7788b1",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}