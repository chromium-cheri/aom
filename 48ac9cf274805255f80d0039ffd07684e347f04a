{
  "comments": [
    {
      "key": {
        "uuid": "0a91118f_8b9d25be",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 8893
      },
      "writtenOn": "2020-07-30T17:14:41Z",
      "side": 1,
      "message": "Hi Yunqing,\n\nIn this patch we have introduced a speed feature which prunes reference frames in tpl mode estimation. In tpl, motion estimation is done w.r.t. all the reference frames. However, reference frames are pruned in RD search, using \"selective_ref_frame\" speed feature. As per our understanding, reference frames which are pruned in RD search should also be pruned during tpl motion estimation. In this patch, we prune those reference frames which are not considered in RD search. However, the reference frame pruning is not enabled for frames beyond the gop length, as the relevant structure differs from RD search.\n\nThis speed feature is enabled for speed 3 and above.\n\nWe plan to extend this speed feature for high quality presets as well once the patch is merged (depending on the trade-off). As per initial tests, the patch can be extended for speed\u003d2. However speed\u003d0/1 seem to have no speed impact with slight BD rate drop.\n\n                       Encode Time          BD-Rate Loss(%)\ncpu-used  Resolution   Reduction(%)   avg.psnr  ovr.psnr   ssim\n   3       LOW RES        0.649        0.0076    0.0199   -0.0813\n   3       MID RES        1.330       -0.1228   -0.1488   -0.1886\n   3        HD RES        1.336       -0.0745   -0.0564   -0.1872\n   3       Average        0.990       -0.0556   -0.0528   -0.1450\n\t\t\t\t\t\n   4       LOW RES        0.489       -0.0244   -0.0013   -0.0291\n   4       MID RES        0.741       -0.1696   -0.1723   -0.2217\n   4        HD RES        0.754        0.0500    0.0265    0.0419\n   4       Average        0.618       -0.0442   -0.0428   -0.0638\n\t\t\t\t\t\n   5       LOW RES        0.838       -0.0873   -0.0716   -0.0989\n   5       MID RES        1.120       -0.0972   -0.0968   -0.1056\n   5        HD RES        1.148        0.0445    0.0356    0.0113\n   5       Average        0.985       -0.0500   -0.0463   -0.0673\n\n   6       LOW RES        0.253       -0.0020   -0.0085   -0.0253\n   6       MID RES        0.354       -0.0822   -0.0977   -0.0532\n   6        HD RES        0.390       -0.0477   -0.0486    0.0311\n   6       Average        0.312       -0.0394   -0.0468   -0.0163\n \nIn the commit message, Quality Loss column:\n[+] sign is for BD-Rate drop\n[-] sign is for BD-Rate improvement\nThe instruction count reduction specified has been measured using command:\n$ perf stat -e instructions:u ./aomenc â€¦\n \nPlease review the patch.\nThank you.\n",
      "revId": "48ac9cf274805255f80d0039ffd07684e347f04a",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0",
      "unresolved": false
    }
  ]
}