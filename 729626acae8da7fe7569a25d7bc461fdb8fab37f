{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "eee0e9b8_86ef16c0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 9823
      },
      "writtenOn": "2022-07-26T23:20:39Z",
      "side": 1,
      "message": "This change makes all the superblocks in the thread share the same pc_tree structure.\nDo you see any significant memory increase from this in the multi-thread case?",
      "revId": "729626acae8da7fe7569a25d7bc461fdb8fab37f",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25e8dd57_80c6d3b5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2022-07-26T23:35:26Z",
      "side": 1,
      "message": "Before this change, 1 SB row within a tile has its own pc_tree. Now, if we use proper number of threads, which is generally much less than number of tiles multiplies number of SB rows. So, the memory should be somewhat reduced. Right?",
      "parentUuid": "eee0e9b8_86ef16c0",
      "revId": "729626acae8da7fe7569a25d7bc461fdb8fab37f",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c9798e97_53065f3a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 9823
      },
      "writtenOn": "2022-07-26T23:41:57Z",
      "side": 1,
      "message": "You are right that with your change, there will be fewer pc_trees. But since each pc_tree is shared across the thread, each pc_tree will on average go deeper into the recursion. The total memory usage grows with both the number of trees and the depth of the trees. So I\u0027m not sure how the memory will change.",
      "parentUuid": "25e8dd57_80c6d3b5",
      "revId": "729626acae8da7fe7569a25d7bc461fdb8fab37f",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e35fd1f5_263bdaa6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 5185
      },
      "writtenOn": "2022-07-27T00:15:44Z",
      "side": 1,
      "message": "I see what you mean. You are thinking about the case when different SB rows have very different partition structures. Right? Let\u0027s think about it differently - anyway, the encoder needs to allocate memory for any partition occurred. This should be true with or without this change. So, we shouldn\u0027t see a memory increase. This change just allows more sharing of allocated pc tree structure.\n\nI also ran a test (vga, 4 threads, 4 tiles) to see how MT encoder memory changes before/after the change. Saw a memory reduction for row-mt\u003d0, and a similar memory usage for row-mt\u003d1.",
      "parentUuid": "c9798e97_53065f3a",
      "revId": "729626acae8da7fe7569a25d7bc461fdb8fab37f",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}