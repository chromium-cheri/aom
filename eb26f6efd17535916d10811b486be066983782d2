{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fcfc2460_e5abf520",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 15075
      },
      "writtenOn": "2021-06-09T04:59:40Z",
      "side": 1,
      "message": "Hi Yunqing,\nThis patch abstracts workers and tile_thr_data to the newly created PrimaryMultiThreadInfo in AV1_PRIMARY. It also moves the initialization and deallocation to the respective primary_* functions. \n\nThese workers will be used by various stages in the encoder, and at different points of time there may be different number of frames in the parallel encode set. Hence, these workers and their tile_thr_data must reside in the primary context to allow their division among different frame contexts depending on the frame parallel encode set in each encode call. This change facilitates this division of workers by moving these workers out of the frame contexts to the primary contexts. The existing MultiThreadInfo also contains workers and tile_thr_data which will hold pointers to offsets in the primary context\u0027s workers and tile_thr_data buffers, depending on the way they are allocated to each frame context. \n\nThis change is bit-exact and has been locally verified with bitstream match tests over a combination of various configuration values for --threads, --tile-rows, --tile-columns, --cpu-used, --end-usage, --row-mt, etc. \n\nPlease review.",
      "revId": "eb26f6efd17535916d10811b486be066983782d2",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}